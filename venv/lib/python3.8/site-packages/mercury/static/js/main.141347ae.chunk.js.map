{"version":3,"sources":["utils.ts","components/authSlice.ts","components/versionSlice.ts","components/LoginButton.tsx","components/UserButton.tsx","components/NavBar.tsx","views/appSlice.ts","components/Widgets/Types.tsx","components/WindowDimensions.tsx","components/Notebooks/notebooksSlice.ts","tasks/tasksSlice.ts","components/Widgets/Checkbox.tsx","components/Widgets/Numeric.tsx","components/Widgets/Range.tsx","components/Widgets/Select.tsx","components/Widgets/Slider.tsx","components/Widgets/File.tsx","components/Widgets/Text.tsx","websocket/wsSlice.tsx","components/Widgets/Markdown.tsx","websocket/Provider.tsx","websocket/StatusBar.tsx","components/Widgets/Button.tsx","components/RunButton.tsx","components/SideBar.tsx","components/MainView.tsx","components/WatchMode.tsx","components/FilesView.tsx","components/MadeWithDiv.tsx","components/RestAPIView.tsx","components/AutoRefresh.tsx","components/WaitPDFExport.tsx","views/AppView.tsx","views/App.tsx","components/Footer.tsx","components/HomeNavBar.tsx","components/ProFeatureAlert.tsx","views/AccountView.tsx","views/HomeView.tsx","views/LoginView.tsx","Routes.tsx","Root.tsx","store.ts","rootReducer.ts","index.tsx"],"names":["getSessionId","sessionId","sessionStorage","getItem","uuidv4","setItem","setAxiosAuthToken","token","axios","defaults","headers","common","handleDownload","url","filename","get","responseType","then","res","fileDownload","data","initToken","localStorage","initialState","username","user","pk","first_name","last_name","email","authSlice","createSlice","name","reducers","setToken","state","action","payload","removeItem","setUsername","setUserInfo","actions","getToken","auth","getUsername","getUserInfo","versionSlice","fetchingIsPro","isPro","welcome","setVersion","setWelcome","getIsPro","version","getFetchingIsPro","getWelcome","LoginButton","style","color","padding","float","href","className","aria-hidden","UserButton","dispatch","useDispatch","history","useHistory","margin","role","id","data-bs-toggle","aria-expanded","aria-labelledby","onClick","a","post","toast","success","push","error","logout","NavBar","alt","src","process","height","paddingLeft","appSlice","view","files","filesState","showSideBar","setView","setFilesState","setFiles","setShowSideBar","toggleShowSideBar","getView","app","getOutputFilesState","getOutputFiles","getShowSideBar","isSelectWidget","widget","input","isCheckboxWidget","isNumericWidget","isSliderWidget","isRangeWidget","isTextWidget","isOutputFilesWidget","output","isMarkdownWidget","isButtonWidget","getWindowDimensions","window","width","innerWidth","innerHeight","notebooks","loadingState","selectedNotebook","selectedNotebookId","undefined","loadingStateSelected","watchModeCounter","slidesHash","widgets","notebooksSlice","setWidgetValue","key","value","clearWidgets","setNotebooks","setLoadingState","setSelectedNotebook","startsWith","file_updated_at","setLoadingStateSelected","setSlidesHash","updateWidgetsParams","widgetKey","updated","noMatch","Object","keys","params","min","max","step","label","rows","choices","toString","hideWidgets","initWidgets","updateTitle","title","updateShowCode","getNotebooks","getLoadingState","getSelectedNotebook","getSelectedNotebookId","isStaticNotebook","st","static_notebook","getLoadingStateSelected","getWatchModeCounter","getSlidesHash","getWidgetsValues","fetchNotebook","silent","clearExecutionHistory","parsedParams","JSON","parse","console","tasksSlice","currentTask","historicTask","showCurrent","previousTask","exportingToPDF","exportToPDFJobId","exportToPDFCounter","executionHistory","setShowCurrent","setCurrentTask","setHistoricTask","setPreviousTask","copyCurrentToPreviousTask","setExportingToPDF","setExportToPDFJobId","resetExportToPDFCounter","increaseExportToPDFCounter","stopPDFExport","setExecutionHistory","getCurrentTask","tasks","getHistoricTask","getPreviousTask","getExportingToPDF","getExportToPDFJobId","getExportToPDFCounter","fetchCurrentTask","notebookId","scrapeSlidesHash","iframeElement","document","getElementById","hash","contentWindow","location","CheckboxWidget","disabled","runNb","useState","userInteraction","useEffect","type","onChange","checked","htmlFor","NumericWidget","continuousUpdate","apply","showApply","minValue","maxValue","stepValue","displayValue","validateValue","e","target","onBlur","onKeyPress","preventDefault","position","top","left","fontSize","border","RangeWidget","vertical","values","length","paddingTop","display","justifyContent","flexWrap","onFinalChange","renderTrack","props","children","onMouseDown","onTouchStart","ref","borderRadius","background","getTrackBackground","colors","alignSelf","renderThumb","index","isDragged","backgroundColor","alignItems","boxShadow","outline","fontWeight","fontFamily","SelectWidget","multi","selectStyles","menu","base","zIndex","selectedValue","selectedValues","options","map","choice","includes","timeOutId","setTimeout","clearTimeout","isDisabled","styles","isMulti","isSingleOption","vs","Array","from","filter","i","SliderWidget","vals","FileWidget","maxFileSize","fileSizeLimit","onprocessfile","file","serverId","server","baseURL","revert","uniqueFileId","load","delete","labelIdle","TextWidget","rowsValue","sanitizeString","input_string","replace","registerPlugin","FilePondPluginImageExifOrientation","FilePondPluginImagePreview","FilePondPluginFileValidateSize","WebSocketState","WorkerState","MarkdownWidget","rehypePlugins","remarkGfm","rehypeHighlight","emoji","rehypeRaw","webSocketState","Unknown","workerState","workerId","notebookSrc","wsSlice","setWebSocketState","setWorkerState","setWorkerId","setNotebookSrc","getWebSocketState","ws","getWorkerState","getWorkerId","getNotebookSrc","WebSocketContext","createContext","wsServer","localServer","WebSocketProvider","log","useSelector","isStatic","connection","sendMessage","readyState","OPEN","send","onOpen","event","stringify","purpose","address","Connected","ping","onMessage","response","reloadNotebook","body","clearPreviousHistory","fetchExecutionHistory","showCode","onError","Disconnected","onClose","connect","WebSocket","onopen","onmessage","onerror","onclose","Provider","StatusBar","wsStatus","wifiColor","workerColor","Running","Busy","Missing","xmlns","fill","viewBox","d","fillRule","ButtonWidget","selectedClass","marginRight","RunButton","waiting","origin","SideBar","notebookTitle","notebookSchedule","taskCreatedAt","widgetsParams","watchMode","notebookPath","displayEmbed","showFiles","isPresentation","notebookParseErrors","staticNotebook","widgetsValues","useContext","execNb","entries","widgetParams","fileKeys","widgetKeys","parts","split","parseFloat","sort","b","additionalStyle","overflowY","blocking","message","data-toggle","data-placement","cursor","session_id","notebook_id","notebook_path","job_id","exportToPDF","Queued","Starting","MainView","appView","errorMsg","columnsWidth","windowDimensions","setWindowDimensions","handleResize","addEventListener","removeEventListener","useWindowDimensions","iframeHeight","nb","indexOf","splitted","injectCode","nbSrc","mainStyle","paddingRight","tag","srcDoc","html","WatchModeComponent","notebook","FilesView","filesLinks","f","fname","pop","paddingBottom","MadeWithDiv","rel","RestAPIView","slug","taskSessionId","msg","setResponse","examplePostData","fetchResponse","postRequest","AutoRefresh","WaitPDFExport","counter","jobId","exportingPDF","ready","getPDF","autoClose","AppView","isSingleApp","task","outputFiles","outputFilesState","pleaseWait","isWatchMode","fetchWorkerOutputFiles","default_view_path","result","showRestApi","toLowerCase","schedule","created_at","areOutputFilesAvailable","errors","continuous_update","App","withRouter","useParams","Number","embed","Footer","bottom","lineHeight","borderTop","textDecoration","ProFeatureAlert","featureName","oldPassword","setOldPassword","newPassword1","setNewPassword1","newPassword2","setNewPassword2","marginTop","old_password","new_password1","new_password2","changePassword","parsedNotebooks","firstLetters","text","count","slice","notebookItems","overflow","scrolling","description","textAlign","password","setPassword","onSubmit","stopPropagation","err","non_field_errors","fetchToken","placeholder","required","Routes","isAxiosError","status","reload","exact","path","component","HomeView","MainApp","LoginView","AccountView","Root","store","createBrowserHistory","rootReducer","combineReducers","notebooksReducer","tasksReducer","versionReducer","appReducer","authReducer","wsReducer","middleware","getDefaultMiddleware","configureStore","reducer","preloadedState","render","hideProgressBar","newestOnTop","closeOnClick","pauseOnHover"],"mappings":"6QAIaA,EAAe,WACxB,IAAIC,EAAYC,eAAeC,QAAQ,aAKvC,OAJiB,MAAbF,IACAA,EAAYG,eACZF,eAAeG,QAAQ,YAAaJ,IAEjCA,GAGEK,EAAoB,SAACC,GACT,qBAAVA,GAAyBA,EAEhCC,IAAMC,SAASC,QAAQC,OAAvB,cAAiD,SAAWJ,SAGrDC,IAAMC,SAASC,QAAQC,OAAvB,eAIFC,EAAiB,SAACC,EAAaC,GACxCN,IACKO,IAAIF,EAAK,CACNG,aAAc,SAEjBC,MAAK,SAACC,GACHC,IAAaD,EAAIE,KAAMN,OChB/BO,EAAY,KACZC,aAAanB,QAAQ,WACvBkB,EAAYC,aAAanB,QAAQ,SACjCG,EAAkBe,IAWpB,IAAME,EAAe,CACnBhB,MAAOc,EACPG,SAAU,GACVC,KAAM,CACJC,GAAI,EACJF,SAAU,GACVG,WAAY,GACZC,UAAW,GACXC,MAAO,KAILC,EAAYC,YAAY,CAC5BC,KAAM,OACNT,eACAU,SAAU,CACRC,SADQ,SACCC,EAAOC,GACdD,EAAM5B,MAAQ6B,EAAOC,QACrB/B,EAAkB6B,EAAM5B,OACpB4B,EAAM5B,MACRe,aAAajB,QAAQ,QAAS8B,EAAM5B,OAEpCe,aAAagB,WAAW,UAG5BC,YAVQ,SAUIJ,EAAOC,GACjBD,EAAMX,SAAWY,EAAOC,QAAUD,EAAOC,QAAU,GAC/CF,EAAMX,UAA+B,KAAnBW,EAAMX,SAC1BF,aAAajB,QAAQ,WAAY8B,EAAMX,UAEvCF,aAAagB,WAAW,aAG5BE,YAlBQ,SAkBIL,EAAOC,GACjBD,EAAMV,KAAOW,EAAOC,YAMXP,IAAf,Q,EAMIA,EAAUW,QAHZP,E,EAAAA,SACAK,E,EAAAA,YACAC,E,EAAAA,YAGWE,EAAW,SAACP,GAAD,OAAsBA,EAAMQ,KAAKpC,OAC5CqC,EAAc,SAACT,GAAD,OAAsBA,EAAMQ,KAAKnB,UAC/CqB,EAAc,SAACV,GAAD,OAAsBA,EAAMQ,KAAKlB,MC1DtDqB,EAAef,YAAY,CAC/BC,KAAM,UACNT,aARmB,CACnBwB,eAAe,EACfC,OAAO,EACPC,QAAS,IAMThB,SAAU,CACRiB,WADQ,SACGf,EAAOC,GAA4C,IACpDY,EAAUZ,EAAOC,QAAjBW,MACRb,EAAMa,MAAQA,EACdb,EAAMY,eAAgB,GAExBI,WANQ,SAMGhB,EAAOC,GAChBD,EAAMc,QAAUb,EAAOC,YAKdS,IAAf,Q,EAKIA,EAAaL,QAFfS,E,EAAAA,WACAC,E,EAAAA,WAGWC,EAAW,SAACjB,GAAD,OAAsBA,EAAMkB,QAAQL,OAC/CM,EAAmB,SAACnB,GAAD,OAAsBA,EAAMkB,QAAQN,eACvDQ,EAAa,SAACpB,GAAD,OAAsBA,EAAMkB,QAAQJ,S,gCCzC/C,SAASO,IACtB,OACE,qBAAKC,MAAO,CAAEC,MAAO,QAASC,QAAS,MAAOC,MAAO,SAArD,SACE,oBAAGC,KAAK,SAASC,UAAU,0BAA3B,UACE,mBAAGA,UAAU,gBAAgBC,cAAY,SAD3C,eCKS,SAASC,EAAT,GAAoD,IAA9BxC,EAA6B,EAA7BA,SAC7ByC,EAAWC,cACXC,EAAUC,cAChB,OACE,8BACE,sBAAKN,UAAU,WAAWL,MAAO,CAAEG,MAAO,SAA1C,UACE,mBACEE,UAAU,2CACVL,MAAO,CAAEY,OAAQ,OACjBR,KAAK,IACLS,KAAK,SACLC,GAAG,mBACHC,iBAAe,WACfC,gBAAc,QAPhB,SASGjD,IAGH,qBACEsC,UAAU,kCACVY,kBAAgB,mBAFlB,UAIE,6BACE,oBAAGZ,UAAU,gBAAgBD,KAAK,WAAlC,UACE,mBAAGC,UAAU,aAAaC,cAAY,SADxC,gBAIF,6BACE,oBAAID,UAAU,uBAEhB,6BACE,oBACEA,UAAU,gBACVa,QAAS,kBAAMV,EH4D3B,SAACE,GAAD,8CACE,WAAOF,GAAP,SAAAW,EAAA,+EAGUpE,IAAMqE,KADA,wBAFhB,OAIIC,IAAMC,QAAQ,uBACdd,EAAS/B,EAAS,KAClB+B,EAAS1B,EAAY,KACrB4B,EAAQa,KAAK,KAPjB,kDASIF,IAAMG,MAAM,0BAThB,0DADF,sDG5DoCC,CAAOf,KAFjC,UAIE,mBAAGL,UAAU,iBAAiBC,cAAY,SAJ5C,wBC/BG,SAASoB,EAAT,GAAmD,IAAjCnC,EAAgC,EAAhCA,MAAOxB,EAAyB,EAAzBA,SACtC,OACE,yBAAQsC,UAAU,2DAAlB,UACE,mBAAGA,UAAU,2CAA2CD,KAAK,IAA7D,SAEE,qBACEuB,IAAI,UACJC,IACEC,2BAIF7B,MAAO,CAAE8B,OAAQ,OAAQC,YAAa,YAIzCxC,GAAsB,KAAbxB,GAAmB,cAACgC,EAAD,IAC5BR,GAAsB,KAAbxB,GAAmB,cAACwC,EAAD,CAAYxC,SAAUA,O,oBCPnDiE,EAAW1D,YAAY,CAC3BC,KAAM,MACNT,aATmB,CACnBmE,KAAM,MACNC,MAAO,GACPC,WAAY,UACZC,aAAa,GAMb5D,SAAU,CACR6D,QADQ,SACA3D,EAAOC,GACbD,EAAMuD,KAAOtD,EAAOC,SAEtB0D,cAJQ,SAIM5D,EAAOC,GACnBD,EAAMyD,WAAaxD,EAAOC,SAE5B2D,SAPQ,SAOC7D,EAAOC,GACdD,EAAMwD,MAAQvD,EAAOC,SAEvB4D,eAVQ,SAUO9D,EAAOC,GACpBD,EAAM0D,YAAczD,EAAOC,SAE7B6D,kBAbQ,SAaU/D,GAChBA,EAAM0D,aAAe1D,EAAM0D,gBAKlBJ,IAAf,Q,EAQIA,EAAShD,QALXqD,E,EAAAA,QACAC,E,EAAAA,cACAC,E,EAAAA,SACAC,E,EAAAA,eAIWE,I,EAHXD,kBAGqB,SAAC/D,GAAD,OAAsBA,EAAMiE,IAAIV,OAC1CW,GAAsB,SAAClE,GAAD,OAAsBA,EAAMiE,IAAIR,YACtDU,GAAiB,SAACnE,GAAD,OAAsBA,EAAMiE,IAAIT,OACjDY,GAAiB,SAACpE,GAAD,OAAsBA,EAAMiE,IAAIP,aCkCvD,SAASW,GAAeC,GAC7B,MAA2C,WAAnCA,EAAyBC,MAG5B,SAASC,GAAiBF,GAC/B,MAA6C,aAArCA,EAA2BC,MAG9B,SAASE,GAAgBH,GAC9B,MAA4C,YAApCA,EAA0BC,MAG7B,SAASG,GAAeJ,GAC7B,MAA2C,WAAnCA,EAAyBC,MAG5B,SAASI,GAAcL,GAC5B,MAA0C,UAAlCA,EAAwBC,MAO3B,SAASK,GAAaN,GAC3B,MAAyC,SAAjCA,EAAuBC,MAG1B,SAASM,GAAoBP,GAClC,MAAiD,QAAzCA,EAA8BQ,OAGjC,SAASC,GAAiBT,GAC/B,MAA8C,aAAtCA,EAA2BQ,OAG9B,SAASE,GAAeV,GAC7B,MAA2C,WAAnCA,EAAyBC,MC3H5B,SAASU,KAAuB,IAAD,EACeC,OACnD,MAAO,CACLC,MAHkC,EAC5BC,WAGNhC,OAJkC,EACTiC,aCqBtB,IA2CDjG,GAAe,CACnBkG,UAAW,GACXC,aAAc,UACdC,iBAAkB,GAClBC,wBAAoBC,EACpBC,qBAAsB,UACtBC,iBAAkB,EAClBC,WAAY,GACZC,QAAS,IAGLC,GAAiBnG,YAAY,CACjCC,KAAM,YACNT,gBACAU,SAAU,CACRkG,eADQ,SAENhG,EACAC,GACC,IAAD,EACuBA,EAAOC,QAAtB+F,EADR,EACQA,IAAKC,EADb,EACaA,MACblG,EAAM8F,QAAQG,GAAOC,GAGvBC,aATQ,SASKnG,GACXA,EAAM8F,QAAU,IAElBM,aAZQ,SAYKpG,EAAOC,GAClBD,EAAMsF,UAAYrF,EAAOC,SAE3BmG,gBAfQ,SAeQrG,EAAOC,GACrBD,EAAMuF,aAAetF,EAAOC,SAE9BoG,oBAlBQ,SAkBYtG,EAAOC,GAEvBA,EAAOC,QAAQF,MAAMuG,WAAW,UAChCvG,EAAMwF,iBAAiBgB,kBACvBvG,EAAOC,QAAQsG,kBAIfxG,EAAMwF,iBAAmBvF,EAAOC,QAChCF,EAAMyF,mBAAqBzF,EAAMwF,iBAAiBpD,IAEhDnC,EAAOC,QAAQF,MAAMuG,WAAW,WAClCvG,EAAM4F,kBAAoB,IAG9Ba,wBAjCQ,SAiCgBzG,EAAOC,GAC7BD,EAAM2F,qBAAuB1F,EAAOC,SAEtCwG,cApCQ,SAoCM1G,EAAOC,GACnBD,EAAM6F,WAAa5F,EAAOC,SAE5ByG,oBAvCQ,SAuCY3G,EAAOC,GAOzB,IAPsD,IAC9C2G,EAAc3G,EAAOC,QAArB0G,UAEJC,GAAU,EAEVC,GAAU,EAEd,MAAgBC,OAAOC,KAAKhH,EAAMwF,iBAAiByB,OAAOA,QAA1D,eAAmE,CAA9D,IAAIhB,EAAG,KACV,GAAIA,IAAQW,EAAW,CACrBE,GAAU,EACV,IAAIxC,EAAM,eAAQtE,EAAMwF,iBAAiByB,OAAOA,OAAOL,IAEnDjC,GAAcL,IACZA,EAAO4C,MAAQjH,EAAOC,QAAQgH,MAChC5C,EAAO4C,IAAMjH,EAAOC,QAAQgH,IAC5BlH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO6C,MAAQlH,EAAOC,QAAQiH,MAChC7C,EAAO6C,IAAMlH,EAAOC,QAAQiH,IAC5BnH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO8C,OAASnH,EAAOC,QAAQkH,OACjC9C,EAAO8C,KAAOnH,EAAOC,QAAQkH,KAC7BpH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,IAEHjC,GAAaN,IAClBA,EAAOgD,OAASrH,EAAOC,QAAQoH,OACjChD,EAAOgD,KAAOrH,EAAOC,QAAQoH,KAC7BT,GAAU,GAERvC,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,IAEHnC,GAAeJ,IACpBA,EAAO4C,MAAQjH,EAAOC,QAAQgH,MAChC5C,EAAO4C,IAAMjH,EAAOC,QAAQgH,IAC5BlH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO6C,MAAQlH,EAAOC,QAAQiH,MAChC7C,EAAO6C,IAAMlH,EAAOC,QAAQiH,IAC5BnH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO8C,OAASnH,EAAOC,QAAQkH,OACjC9C,EAAO8C,KAAOnH,EAAOC,QAAQkH,KAC7BpH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,IAEHxC,GAAeC,IAEtBA,EAAOiD,QAAQC,aAAevH,EAAOC,QAAQqH,QAAQC,aAErDlD,EAAOiD,QAAUtH,EAAOC,QAAQqH,QAChCvH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,IAEHrC,GAAiBF,GACtBA,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,GAEHpC,GAAgBH,IACrBA,EAAO4C,MAAQjH,EAAOC,QAAQgH,MAChC5C,EAAO4C,IAAMjH,EAAOC,QAAQgH,IAC5BlH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO6C,MAAQlH,EAAOC,QAAQiH,MAChC7C,EAAO6C,IAAMlH,EAAOC,QAAQiH,IAC5BnH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO8C,OAASnH,EAAOC,QAAQkH,OACjC9C,EAAO8C,KAAOnH,EAAOC,QAAQkH,KAC7BpH,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MACpCW,GAAU,GAERvC,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,IAEH9B,GAAiBT,GACtBA,EAAO4B,QAAUjG,EAAOC,QAAQgG,QAClC5B,EAAO4B,MAAQjG,EAAOC,QAAQgG,MAC9BW,GAAU,GAEH7B,GAAeV,KACxBtE,EAAM8F,QAAQG,GAAOhG,EAAOC,QAAQgG,MAEhC5B,EAAO+C,QAAUpH,EAAOC,QAAQmH,QAClC/C,EAAO+C,MAAQpH,EAAOC,QAAQmH,MAC9BR,GAAU,GAERvC,EAAOhD,QAAUrB,EAAOC,QAAQoB,QAClCgD,EAAOhD,MAAQrB,EAAOC,QAAQoB,MAC9BuF,GAAU,IAIVA,IACF7G,EAAMwF,iBAAiByB,OAAOA,OAAOL,GAAatC,IAIpDwC,IACF9G,EAAMwF,iBAAiByB,OAAOA,OAAOL,GAAa3G,EAAOC,UAG7DuH,YApKQ,SAoKIzH,EAAOC,GAA6B,IAAD,EACrC+G,EAAS/G,EAAOC,QAAhB8G,KADqC,cAE7BA,GAF6B,IAE7C,2BAAsB,CAAC,IAAdf,EAAa,QAChBA,KAAOjG,EAAMwF,iBAAiByB,OAAOA,eAChCjH,EAAMwF,iBAAiByB,OAAOA,OAAOhB,IAJH,gCAQ/CyB,YA5KQ,SA4KI1H,EAAOC,GAA6B,IACtC6F,EAAY7F,EAAOC,QAAnB4F,QACR9F,EAAMwF,iBAAiByB,OAAOA,OAAS,GACvCjH,EAAM8F,QAAU,GAH6B,oBAI1BA,GAJ0B,IAI7C,2BAA4B,CAAC,IAApBxB,EAAmB,QAE1BtE,EAAMwF,iBAAiByB,OAAOA,OAAO3C,EAAOsC,WAAatC,EACzDtE,EAAM8F,QAAQxB,EAAOsC,WAAatC,EAAO4B,OAPE,gCAW/CyB,YAvLQ,SAuLI3H,EAAOC,GACjBD,EAAMwF,iBAAiBoC,MAAQ3H,EAAOC,SAExC2H,eA1LQ,SA0LO7H,EAAOC,GACpBD,EAAMwF,iBAAiByB,OAAO,aAAehH,EAAOC,YAK3C6F,MAAf,Q,GAeIA,GAAezF,QAZjB8F,G,GAAAA,aACAC,G,GAAAA,gBACAC,G,GAAAA,oBACAG,G,GAAAA,wBACAC,G,GAAAA,cACAC,G,GAAAA,oBACAc,G,GAAAA,YACAzB,G,GAAAA,eAEA0B,I,GADAvB,a,GACAuB,aACAC,G,GAAAA,YACAE,G,GAAAA,eAGWC,GAAe,SAAC9H,GAAD,OAAsBA,EAAMsF,UAAUA,WACrDyC,GAAkB,SAAC/H,GAAD,OAC7BA,EAAMsF,UAAUC,cACLyC,GAAsB,SAAChI,GAAD,OACjCA,EAAMsF,UAAUE,kBACLyC,GAAwB,SAACjI,GAAD,OACnCA,EAAMsF,UAAUG,oBACLyC,GAAmB,SAAClI,GAAsB,IAAD,IAChDmI,EAAE,UAAGnI,EAAMsF,UAAUE,wBAAnB,iBAAG,EAAkCyB,cAArC,aAAG,EAA0CmB,gBACnD,YAAW1C,IAAPyC,GAGGA,GAEIE,GAA0B,SAACrI,GAAD,OACrCA,EAAMsF,UAAUK,sBACL2C,GAAsB,SAACtI,GAAD,OACjCA,EAAMsF,UAAUM,kBACL2C,GAAgB,SAACvI,GAAD,OAAsBA,EAAMsF,UAAUO,YAEtD2C,GAAmB,SAACxI,GAAD,OAAsBA,EAAMsF,UAAUQ,SAyBzD2C,GACX,SAACrG,GAAD,IAAasG,EAAb,sGACE,WAAO5G,GAAP,yBAAAW,EAAA,sEAESiG,IACH5G,EAAS4E,GAAc,KACvB5E,EAAS6G,OAJf,EAOsB1D,KAAVE,EAPZ,EAOYA,MACRrD,EAASgC,EAAeqB,EAAQ,MAE3BuD,GACH5G,EAAS2E,GAAwB,YAE7B/H,EAbV,4BAaqC0D,EAbrC,cAc2B/D,IAAMO,IAAIF,GAdrC,gBAcYO,EAdZ,EAcYA,KACF2J,EAAeC,KAAKC,MAAM7J,EAAKgI,QACrCnF,EACEwE,GAAoB,2BACfrH,GADc,IAEjBgI,OAAQ2B,MAGPF,GACH5G,EAAS2E,GAAwB,WAvBvC,kDA0BSiC,GACH5G,EAAS2E,GAAwB,UAEnCsC,QAAQjG,MAAR,oDAC+CV,EAD/C,qBA7BJ,0DADF,uDC/SI4G,GAAapJ,YAAY,CAC3BC,KAAM,QACNT,aAbiB,CACjB6J,YAAa,GACbC,aAAc,GACdC,aAAa,EACbC,aAAc,GACdC,gBAAgB,EAChBC,iBAAkB,GAClBC,mBAAoB,EACpBC,iBAAkB,IAMlB1J,SAAU,CACN2J,eADM,SACSzJ,EAAOC,GAClBD,EAAMmJ,YAAclJ,EAAOC,SAE/BwJ,eAJM,SAIS1J,EAAOC,GAClBD,EAAMiJ,YAAchJ,EAAOC,SAE/ByJ,gBAPM,SAOU3J,EAAOC,GACnBD,EAAMkJ,aAAejJ,EAAOC,SAEhC0J,gBAVM,SAUU5J,EAAOC,GACnBD,EAAMoJ,aAAenJ,EAAOC,SAEhC2J,0BAbM,SAaoB7J,GACtBA,EAAMoJ,aAAepJ,EAAMiJ,aAE/Ba,kBAhBM,SAgBY9J,EAAOC,GACrBD,EAAMqJ,eAAiBpJ,EAAOC,SAElC6J,oBAnBM,SAmBc/J,EAAOC,GACvBD,EAAMsJ,iBAAmBrJ,EAAOC,SAEpC8J,wBAtBM,SAsBkBhK,GACpBA,EAAMuJ,mBAAqB,GAE/BU,2BAzBM,SAyBqBjK,GACvBA,EAAMuJ,oBAAsB,GAEhCW,cA5BM,SA4BQlK,GACVA,EAAMqJ,gBAAiB,EACvBrJ,EAAMsJ,iBAAmB,GACzBtJ,EAAMuJ,mBAAqB,GAE/BY,oBAjCM,SAiCcnK,EAAOC,GACvBD,EAAMwJ,iBAAmBvJ,EAAOC,SAEpCyI,sBApCM,SAoCgB3I,GAClBA,EAAMwJ,iBAAmB,OAKtBR,MAAf,Q,GAeIA,GAAW1I,QAXXoJ,I,GADAD,e,GACAC,gBACAC,G,GAAAA,gBAGAG,I,GAFAF,gB,GACAC,0B,GACAC,mBACAC,G,GAAAA,oBACAC,G,GAAAA,wBACAC,G,GAAAA,2BACAC,G,GAAAA,cACAC,G,GAAAA,oBACAxB,G,GAAAA,sBAISyB,GAAiB,SAACpK,GAAD,OAAsBA,EAAMqK,MAAMpB,aACnDqB,GAAkB,SAACtK,GAAD,OAAsBA,EAAMqK,MAAMnB,cACpDqB,GAAkB,SAACvK,GAAD,OAAsBA,EAAMqK,MAAMjB,cACpDoB,GAAoB,SAACxK,GAAD,OAAsBA,EAAMqK,MAAMhB,gBACtDoB,GAAsB,SAACzK,GAAD,OAAsBA,EAAMqK,MAAMf,kBACxDoB,GAAwB,SAAC1K,GAAD,OAAsBA,EAAMqK,MAAMd,oBAG1DoB,GACT,SAACC,GAAD,8CACI,WAAO9I,GAAP,qBAAAW,EAAA,6DAEU3E,EAAYD,IAFtB,SAKca,EALd,8BAK2CkM,EAL3C,YAKyD9M,GALzD,SAM+BO,IAAMO,IAAIF,GANzC,gBAMgBO,EANhB,EAMgBA,KACR6C,EAAS4H,GAAezK,IAPhC,kDAWQ6C,EAAS4H,GAAe,KAXhC,0DADJ,uDAiBSmB,GAAmB,WAC5B,IAAK,IAAD,IACMC,EAAiBC,SAASC,eAAe,eACzCC,EAAI,OAAGH,QAAH,IAAGA,GAAH,UAAGA,EAAeI,qBAAlB,iBAAG,EAA8BC,gBAAjC,aAAG,EAAwCF,KACrD,GAAIA,EACA,OAAOA,EAEb,MAAOnI,IACT,MAAO,ICrHI,SAASsI,GAAT,GAMI,IALjBxE,EAKgB,EALhBA,UACAS,EAIgB,EAJhBA,MACAnB,EAGgB,EAHhBA,MACAmF,EAEgB,EAFhBA,SACAC,EACgB,EADhBA,MAEMxJ,EAAWC,cADD,EAEmBwJ,oBAAS,GAF5B,mBAET1E,EAFS,KAEA2E,EAFA,KAYhB,OARAC,qBAAU,WACJ5E,GAEFyE,MAGD,CAACpF,IAGF,sBAAKvE,UAAU,yCAAf,UACE,uBACEA,UAAU,mBACV+J,KAAK,WACLtJ,GAAE,mBAAciF,GAChBgE,SAAUA,EACVM,SAAU,WACRH,GAAgB,GAChB1J,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,OAAQA,MAEpD0F,QAAkB,MAAT1F,GAAgBA,IAE3B,uBACEvE,UAAU,mBACVkK,QAAO,mBAAcxE,GACrB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAHtC,SAKGhE,OClCM,SAASyE,GAAT,GAUG,IAThBlF,EASe,EATfA,UACAS,EAQe,EARfA,MACAnB,EAOe,EAPfA,MACAgB,EAMe,EANfA,IACAC,EAKe,EALfA,IACAC,EAIe,EAJfA,KACAiE,EAGe,EAHfA,SACAC,EAEe,EAFfA,MACAS,EACe,EADfA,iBAEMjK,EAAWC,cADF,EAEYwJ,oBAAS,GAFrB,mBAERS,EAFQ,KAEDC,EAFC,KAIXC,OAAWxG,EACXyG,OAAWzG,EACX0G,EAAY,EACZlF,IACFgF,EAAWhF,GAETC,IACFgF,EAAWhF,GAETC,IACFgF,EAAYhF,GAGd,IAAIiF,EAAgC,GAChCnG,IACFmG,EAAenG,GAGjB,IAAMoG,EAAgB,WAChBpF,GAAOhB,GAASA,EAAQgB,GAC1BpF,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,MAAOgB,KAE/CC,GAAOjB,GAASA,EAAQiB,GAC1BrF,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,MAAOiB,MAIrD,OACE,sBAAKxF,UAAU,kBAAf,UACE,uBACEkK,QAAO,mBAAcxE,GACrB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIGhE,IAEH,uBACE1F,UAAU,eACV+J,KAAK,SACLxF,MAAOmG,EACPV,SAAU,SAACY,GACTN,GAAU,GACVnK,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,MAAOqG,EAAEC,OAAOtG,UAE5DuG,OAAQ,SAACF,GACPD,KAEFI,WAAY,SAACH,GACG,UAAVA,EAAEtG,MACJqG,IACAhB,IACAW,GAAU,GACVM,EAAEI,mBAGNzF,IAAKgF,EACL/E,IAAKgF,EACL/E,KAAMgF,IAEPJ,GAASD,GACR,qBACEzK,MAAO,CACLG,MAAO,QACPmL,SAAU,WACVC,IAAK,MACLC,KAAM,OALV,SAQE,wBACEnL,UAAU,iCACVa,QAAS,SAAC+J,GACRD,IACAhB,IACAW,GAAU,GACVM,EAAEI,kBAEJrL,MAAO,CACLyL,SAAU,QACVC,OAAQ,QAVZ,gD,aChFK,SAASC,GAAT,GAUC,IATdrG,EASa,EATbA,UACAS,EAQa,EARbA,MACAnB,EAOa,EAPbA,MACAgB,EAMa,EANbA,IACAC,EAKa,EALbA,IACAC,EAIa,EAJbA,KAEAiE,GAEa,EAHb6B,SAGa,EAFb7B,UACAC,EACa,EADbA,MAEMxJ,EAAWC,cAEbmK,EAAW,EACXC,EAAW,IACXC,EAAY,EACZlF,IACFgF,EAAWhF,GAETC,IACFgF,EAAWhF,GAETC,IACFgF,EAAYhF,GAGd,IAAM+F,EACK,MAATjH,QAA2BR,IAAVQ,GAAwC,IAAjBA,EAAMkH,OAC1ClH,EACA,CAACgG,EAAUC,GAEjB,OACE,sBAAKxK,UAAU,kBAAf,UACE,uBACEkK,QAAO,uBAAkBxE,GACzB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIGhE,IAGH,qBACE/F,MAAO,CACL+L,WAAY,OACZC,QAAS,OACTC,eAAgB,SAChBC,SAAU,QALd,SAQE,cAAC,SAAD,CACEnC,SAAUA,EACV8B,OAAQA,EACR/F,KAAMgF,EACNlF,IAAKgF,EACL/E,IAAKgF,EACLR,SAAU,SAACwB,GAETrL,EACEkE,GAAe,CACbC,IAAKW,EACLV,MAAOiH,MAIbM,cAAe,SAACN,GACd7B,KAEFoC,YAAa,gBAAGC,EAAH,EAAGA,MAAOC,EAAV,EAAUA,SAAV,OACX,qBACEC,YAAaF,EAAME,YACnBC,aAAcH,EAAMG,aACpBxM,MAAK,2BACAqM,EAAMrM,OADN,IAEH8B,OAAQ,OACRkK,QAAS,OACTnI,MAAO,SAPX,SAUE,sBACE4I,IAAKJ,EAAMI,IACXzM,MAAO,CACL8B,OAAQ,MACR+B,MAAO,OACP6I,aAAc,MACdC,WAAYC,8BAAmB,CAC7Bf,SACAgB,OAAQ,CACN,OACA9C,EAAW,qBAAuB,UAClC,QAEFnE,IAAKgF,EACL/E,IAAKgF,IAEPiC,UAAW,UAhBf,UAmBGR,EAED,sBACEtM,MAAO,CACLgM,QAAS,eACTnI,MAAO,OACP4H,SAAU,OACVM,WAAY,QALhB,UAQE,qBAAK/L,MAAO,CAAEG,MAAO,QAArB,SAAgCyK,IAChC,qBAAK5K,MAAO,CAAEG,MAAO,SAArB,SAAiC0K,aAKzCkC,YAAa,gBAAGC,EAAH,EAAGA,MAAOX,EAAV,EAAUA,MAAOY,EAAjB,EAAiBA,UAAjB,OACX,gDACMZ,GADN,IAEErM,MAAK,2BACAqM,EAAMrM,OADN,IAEH8B,OAAQ,OACR+B,MAAO,OACP6H,OAAQ,kBACRgB,aAAc,MACdQ,gBAAiB,OACjBlB,QAAS,OACTC,eAAgB,SAChBkB,WAAY,SACZC,UAAW,mBACXC,QAAS,SAbb,UAgBE,qBACErN,MAAO,CACLsL,SAAU,WACVC,IAAK,QACLtL,MAAO,OACPqN,WAAY,OACZ7B,SAAU,OACV8B,WAAY,4CACZrN,QAAS,MACTwM,aAAc,MACdQ,gBAAiBnD,EAAW,qBAAuB,WAVvD,SAaG8B,EAAOmB,KAEV,qBACEhN,MAAO,CACL8B,OAAQ,OACR+B,MAAO,MACPqJ,gBAAiBD,EAAY,UAAY,sB,cC5I5C,SAASO,GAAT,GAQE,IAPflI,EAOc,EAPdA,UACAS,EAMc,EANdA,MACAnB,EAKc,EALdA,MACAqB,EAIc,EAJdA,QACAwH,EAGc,EAHdA,MACA1D,EAEc,EAFdA,SACAC,EACc,EADdA,MAEMxJ,EAAWC,cADH,EAEqBwJ,oBAAS,GAF9B,mBAEP1E,EAFO,KAEE2E,EAFF,KAIRwD,EAAe,CACnBC,KAAM,SAACC,GAAD,mBAAC,eACFA,GADC,IAEJC,OAAQ,QAIRC,EAA8B,CAAElJ,MAAO,GAAImB,MAAO,IAClDgI,EAAiC,CAAC,CAAEnJ,MAAO,GAAImB,MAAO,KAEtDiI,EAA8C/H,EAAQgI,KAAI,SAACC,GAI7D,OAHItJ,GAASsJ,IAAWtJ,IAAU6I,IAChCK,EAAgB,CAAElJ,MAAOsJ,EAAQnI,MAAOmI,IAEnC,CAAEtJ,MAAOsJ,EAAQnI,MAAOmI,MAuBjC,OApBIT,IACFM,EAAiB,GACjB9H,EAAQgI,KAAI,SAACC,GAIX,OAHItJ,GAASA,EAAMuJ,SAASD,IAAWT,GACrCM,EAAexM,KAAK,CAAEqD,MAAOsJ,EAAQnI,MAAOmI,IAEvC,CAAEtJ,MAAOsJ,EAAQnI,MAAOmI,OAInC/D,qBAAU,WACR,GAAK5E,EAAL,CACA,IAAM6I,EAAYC,YAAW,WAE3BrE,ML1CwB,KK4C1B,OAAO,kBAAMsE,aAAaF,OAEzB,CAACxJ,IAGF,sBAAKvE,UAAU,kBAAf,UACE,uBACEkK,QAAO,iBAAYxE,GACnB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIGhE,IAEH,cAAC,KAAD,CACEjF,GAAE,iBAAYiF,GACdwI,WAAYxE,EACZxL,KAAMwH,GAAgB,SACtByI,OAAQd,EACR9I,MAAO6I,EAAQM,EAAiBD,EAChCE,QAASA,EACTS,QAAShB,EACTpD,SAAU,SAACY,GACT,GAAIA,EAEF,GADAf,GAAgB,GAnFrB,SACL8D,GAEA,YAA2C5J,IAAnC4J,EAAyBpJ,MAiFnB8J,CAAezD,GACjBzK,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,MAAOqG,EAAErG,aAC9C,CAEL,IAAM+J,EAAKC,MAAMC,KAAK5D,EAAEY,UAAUiD,QAChC,SAACC,GAAD,YAAa3K,IAAN2K,KAKTvO,EACEkE,GAAe,CACbC,IAAKW,EACLV,MAAO+J,EAAGV,KAAI,SAACc,GAAD,OAAOA,EAAEnK,mBCzF1B,SAASoK,GAAT,GAUE,IATf1J,EASc,EATdA,UACAS,EAQc,EARdA,MACAnB,EAOc,EAPdA,MACAgB,EAMc,EANdA,IACAC,EAKc,EALdA,IACAC,EAIc,EAJdA,KAEAiE,GAEc,EAHd6B,SAGc,EAFd7B,UACAC,EACc,EADdA,MAEMxJ,EAAWC,cAEbmK,EAAW,EACXC,EAAW,IACXC,EAAY,EACZlF,IACFgF,EAAWhF,GAETC,IACFgF,EAAWhF,GAETC,IACFgF,EAAYhF,GAEd,IAAMmJ,EAAiB,CAAW,OAAVrK,EAAiBA,EAAQiG,GAEjD,OACE,sBAAKxK,UAAU,kBAAf,UACE,uBACEkK,QAAO,iBAAYxE,GACnB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIGhE,IAGH,qBACE/F,MAAO,CACL+L,WAAY,OACZC,QAAS,OACTC,eAAgB,SAChBC,SAAU,QALd,SAQE,cAAC,SAAD,CACEnC,SAAUA,EACV8B,OAAQoD,EACRnJ,KAAMgF,EACNlF,IAAKgF,EACL/E,IAAKgF,EACLR,SAAU,SAACwB,GACTrL,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,MAAOiH,EAAO,OAE1DM,cAAe,SAACN,GACd7B,KAEFoC,YAAa,gBAAGC,EAAH,EAAGA,MAAOC,EAAV,EAAUA,SAAV,OACX,qBACEC,YAAaF,EAAME,YACnBC,aAAcH,EAAMG,aACpBxM,MAAK,2BACAqM,EAAMrM,OADN,IAEH8B,OAAQ,OACRkK,QAAS,OACTnI,MAAO,SAPX,SAUE,sBACE4I,IAAKJ,EAAMI,IACXzM,MAAO,CACL8B,OAAQ,MACR+B,MAAO,OACP6I,aAAc,MACdC,WAAYC,8BAAmB,CAC7Bf,OAAQoD,EACRpC,OAAQ,CACN9C,EAAW,qBAAuB,UAClC,QAEFnE,IAAKgF,EACL/E,IAAKgF,IAEPiC,UAAW,UAff,UAkBGR,EAED,sBACEtM,MAAO,CACLgM,QAAS,eACTnI,MAAO,OACP4H,SAAU,OACVM,WAAY,QALhB,UAQE,qBAAK/L,MAAO,CAAEG,MAAO,QAArB,SAAgCyK,IAChC,qBAAK5K,MAAO,CAAEG,MAAO,SAArB,SAAiC0K,aAKzCkC,YAAa,gBAAGV,EAAH,EAAGA,MAAOY,EAAV,EAAUA,UAAV,OACX,gDACMZ,GADN,IAEErM,MAAK,2BACAqM,EAAMrM,OADN,IAEH8B,OAAQ,OACR+B,MAAO,OACP6H,OAAQ,OACRgB,aAAc,MACdQ,gBAAiB,OACjBlB,QAAS,OACTC,eAAgB,SAChBkB,WAAY,SACZC,UAAW,mBACXC,QAAS,SAbb,UAgBE,qBACErN,MAAO,CACLsL,SAAU,WACVC,IAAK,QACLtL,MAAO,OACPqN,WAAY,OACZ7B,SAAU,OACV8B,WAAY,4CACZrN,QAAS,MACTwM,aAAc,MACdQ,gBAAiBnD,EAAW,qBAAuB,WAVvD,SAaGkF,EAAK,KAER,qBACEjP,MAAO,CACL8B,OAAQ,OACR+B,MAAO,MACPqJ,gBAAiBD,EAAY,UAAY,sB,6ECjI5C,SAASiC,GAAT,GAOA,IANb5J,EAMY,EANZA,UACAS,EAKY,EALZA,MACAoJ,EAIY,EAJZA,YACApF,EAGY,EAHZA,SACAnF,EAEY,EAFZA,MACAoF,EACY,EADZA,MAEMxJ,EAAWC,cADL,EAEuBwJ,oBAAS,GAFhC,mBAEL1E,EAFK,KAEI2E,EAFJ,KAGRkF,EAAgB,QAYpB,OAXID,IACFC,EAAgBD,GAElBhF,qBAAU,WACJ5E,GAA4B,IAAjBX,EAAMkH,QAEnB9B,MAGD,CAACpF,IAGF,sBAAKvE,UAAU,kBAAf,UACE,uBACEkK,QAAO,eAAUxE,GACjB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIGhE,IAEH,8BACE,cAAC,YAAD,CACEgE,SAAUA,EACVoF,YAAaC,EACbC,cAAe,SAAC7N,EAAO8N,GACrBpF,GAAgB,GAChB1J,EACEkE,GAAe,CACbC,IAAKW,EACLV,MAAO,CAAC0K,EAAKjS,SAAUiS,EAAKC,cAIlCC,OAAQ,CACNpS,IAAI,GAAD,OAAKL,IAAMC,SAASyS,QAApB,cACH5N,QAAS,YACT6N,OAAO,WAAD,4BAAE,WAAOC,EAAcC,EAAMpO,GAA3B,SAAAL,EAAA,+EAEEpE,IAAM8S,OAAN,UACD9S,IAAMC,SAASyS,QADd,qBAEJ,CACE9R,KAAMgS,IALN,OAQJnP,EAASkE,GAAe,CAAEC,IAAKW,EAAWV,MAAO,MAEjDgL,IAVI,gDAaJpO,EAAM,sCAbF,yDAAF,uDAAC,IAiBTsO,UAAU,qFC1EL,SAASC,GAAT,GAQA,IAPbzK,EAOY,EAPZA,UACAS,EAMY,EANZA,MACAnB,EAKY,EALZA,MACAoB,EAIY,EAJZA,KACA+D,EAGY,EAHZA,SACAC,EAEY,EAFZA,MACAS,EACY,EADZA,iBAEMjK,EAAWC,cADL,EAEewJ,oBAAS,GAFxB,mBAELS,EAFK,KAEEC,EAFF,KAGRqF,EAAoBhK,GAAc,EAEhCiK,EAAiB,SAACC,GACtB,OAAOA,EAAaC,QAAQ,mBAAoB,KAGlD,OACE,sBAAK9P,UAAU,kBAAf,UACE,uBACEkK,QAAO,mBAAcxE,GACrB/F,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIGhE,IAEY,IAAdiK,GACC,uBACE3P,UAAU,eACV+J,KAAK,OACLtJ,GAAE,eAAUiF,GACZnB,MAAOA,GAAgB,GACvByF,SAAU,SAACY,GACTN,GAAU,GACVnK,EACEkE,GAAe,CACbC,IAAKW,EACLV,MAAOqL,EAAehF,EAAEC,OAAOtG,WAIrCwG,WAAY,SAACH,GACG,UAAVA,EAAEtG,MACJqF,IACAW,GAAU,GACVM,EAAEI,mBAGNtB,SAAUA,IAGbiG,EAAY,GACX,0BACE3P,UAAU,eACVS,GAAE,oBAAeiF,GACjBC,KAAMgK,EACNpL,MAAOA,GAAgB,GACvByF,SAAU,SAACY,GACTN,GAAU,GACVnK,EACEkE,GAAe,CACbC,IAAKW,EACLV,MAAOqL,EAAehF,EAAEC,OAAOtG,WAIrCmF,SAAUA,IAIbW,GAASD,GAAkC,IAAduF,GAC5B,qBACEhQ,MAAO,CACLyL,SAAU,QACVtL,MAAO,QACPmL,SAAU,WACVC,IAAK,MACLC,KAAM,OACNvL,MAAO,WAPX,kCAaDyK,GAASD,GAAoBuF,EAAY,GACxC,qBACEhQ,MAAO,CACLG,MAAO,QACPmL,SAAU,WACVC,IAAK,MACLC,KAAM,OALV,SAQE,wBACEnL,UAAU,iCACVa,QAAS,SAAC+J,GACRjB,IACAW,GAAU,GACVM,EAAEI,kBAEJrL,MAAO,CACLyL,SAAU,SARd,wBDhGV2E,0BACEC,KACAC,KACAC,M,IETUC,GAOAC,G,+CCGG,SAASC,GAAT,GAA6D,IAAnC9L,EAAkC,EAAlCA,MAAOmF,EAA2B,EAA3BA,SAC9C,OACE,qBACE1J,UAAU,kBACVL,MAAO,CAAEC,MAAO8J,EAAW,OAAS,WAFtC,SAIE,cAAC,KAAD,CACE4G,cAAe,CAACC,KAAWC,KAAiBC,KAAOC,MADrD,SAGGnM,O,SDnBG4L,K,wBAAAA,E,sBAAAA,E,kBAAAA,E,6BAAAA,Q,cAOAC,K,kBAAAA,E,oBAAAA,E,kBAAAA,E,kBAAAA,E,YAAAA,E,iBAAAA,Q,KASZ,IAAM3S,GAAe,CACnBkT,eAAgBR,GAAeS,QAC/BC,YAAaT,GAAYQ,QACzBE,cAAU/M,EACVgN,YAAa,IAGTC,GAAU/S,YAAY,CAC1BC,KAAM,KACNT,gBACAU,SAAU,CACR8S,kBADQ,SACU5S,EAAOC,GACvBD,EAAMsS,eAAiBrS,EAAOC,SAEhC2S,eAJQ,SAIO7S,EAAOC,GACpBD,EAAMwS,YAAcvS,EAAOC,SAE7B4S,YAPQ,SAOI9S,EAAOC,GACjBD,EAAMyS,SAAWxS,EAAOC,SAE1B6S,eAVQ,SAUO/S,EAAOC,GACpBD,EAAM0S,YAAczS,EAAOC,YAKlByS,MAAf,Q,GAOIA,GAAQrS,QAJVsS,G,GAAAA,kBACAC,G,GAAAA,eACAC,G,GAAAA,YACAC,G,GAAAA,eAGWC,GAAoB,SAAChT,GAAD,OAAsBA,EAAMiT,GAAGX,gBACnDY,GAAiB,SAAClT,GAAD,OAAsBA,EAAMiT,GAAGT,aAChDW,GAAc,SAACnT,GAAD,OAAsBA,EAAMiT,GAAGR,UAC7CW,GAAiB,SAACpT,GAAD,OAAsBA,EAAMiT,GAAGP,aEjCvDW,GAAmBC,6BAAc5N,GAInC6N,GAAW,sBACXC,IAAc,EAWH,SAASC,GAAT,GAIX,IAHF7F,EAGC,EAHDA,SAIA7E,QAAQ2K,IAAI,qBAEZ,IAAM5R,EAAWC,cACX0D,EAAqBkO,YAAY1L,IACjC2L,EAAWD,YAAYzL,IAEzB2L,OAAoCnO,EAElCoO,EAAc,SAAC5T,QACAwF,IAAfmO,GAA4BA,EAAWE,aAAeF,EAAWG,MACnEH,EAAWI,KAAK/T,IAIpB,SAASgU,EAAOC,GACdL,EACEjL,KAAKuL,UAAU,CACbC,QAAS,iBACTC,QAASf,MAGbzR,EAAS8Q,GAAkBd,GAAeyC,YAC1CC,IAGF,SAASC,EAAUN,GAGjB,IAAMO,EAAW7L,KAAKC,MAAMqL,EAAMlV,MAC9B,YAAayV,IACU,iBAArBA,EAASL,SAEXvS,EAAS+Q,GAAe6B,EAAS1U,QACjC8B,EAASgR,GAAY4B,EAASjC,YACA,sBAArBiC,EAASL,UAEN,OAARK,QAAQ,IAARA,OAAA,EAAAA,EAAUC,sBAAyCjP,IAAvBD,GAE9B3D,EAAS2G,GAAchD,IAEzB3D,EAASiR,GAAe2B,EAASE,QAEH,mBAArBF,EAASL,aACS3O,IAAvBD,GACF3D,EV4IN,SAAC8I,GAAD,IAAqBiK,IAArB,uGACI,WAAO/S,GAAP,qBAAAW,EAAA,6DAEIX,EAAS6H,GAAgB,KACrBkL,GACA/S,EAAS6G,MAGP7K,EAAYD,IAPtB,SAUca,EAVd,oCAUiDkM,EAVjD,YAU+D9M,GAV/D,SAW+BO,IAAMO,IAAIF,GAXzC,gBAWgBO,EAXhB,EAWgBA,KACR6C,EAASqI,GAAoBlL,IAZrC,kDAcQ6C,EAAS6G,MAdjB,0DADJ,sDU5IemM,CAAsBrP,GAAoB,IAEvB,mBAArBiP,EAASL,QAClBvS,EAAS6E,GAAoB+N,IACC,iBAArBA,EAASL,QAClBvS,EAAS2F,GAAYiN,IACS,iBAArBA,EAASL,QAElBvS,EAAS4F,GAAYgN,IACU,iBAArBA,EAASL,QACnBvS,EAAS6F,GAAY+M,EAAS9M,QACC,qBAArB8M,EAASL,QACnBvS,EAAS+F,GAAe6M,EAASK,WAEZ,kBAArBL,EAASL,SACY,iBAArBK,EAASL,SAELK,EAAShW,KAAOgW,EAAS/V,WAC3BmD,EAASgI,IAAkB,IAC3BrL,EAAeiW,EAAShW,IAAKgW,EAAS/V,YAM9C,SAASqW,EAAQb,GACfrS,EAAS8Q,GAAkBd,GAAemD,eAC1CnT,EAAS+Q,GAAed,GAAYQ,UAGtC,SAAS2C,EAAQf,GACfrS,EAAS8Q,GAAkBd,GAAemD,eAC1CnT,EAAS+Q,GAAed,GAAYQ,UACpCzQ,EAASgR,QAAYpN,IACrBmO,OAAanO,EACbiK,YAAW,kBAAMwF,MAAW,KAG9B,SAASX,IACPV,EACEjL,KAAKuL,UAAU,CACbC,QAAS,sBAGM3O,IAAfmO,GAA4BA,EAAWE,aAAeF,EAAWG,MACnErE,YAAW,kBAAM6E,MAAQ,KAI7B,SAASW,KAEJ3B,IAAgBI,QACMlO,IAAvBD,QACeC,IAAfmO,KAEAA,EAAa,IAAIuB,UAAJ,UACR7B,GADQ,sBACc9N,EADd,YACoC5H,IADpC,OAGFwX,OAASnB,EACpBL,EAAWyB,UAAYb,EACvBZ,EAAW0B,QAAUP,EACrBnB,EAAW2B,QAAUN,GAGzBC,IAEA,IAAMlC,EAAK,CACTa,eAGF,OACE,cAACT,GAAiBoC,SAAlB,CAA2BvP,MAAO+M,EAAlC,SAAuCrF,ICvJ5B,SAAS8H,KACtB,IAAMC,EAAWhC,YAAYX,IACvBR,EAAcmB,YAAYT,IAE5B0C,EAAY,SACZD,IAAa7D,GAAeyC,UAC9BqB,EAAY,QAEZD,IAAa7D,GAAemD,cAC5BU,IAAa7D,GAAeS,UAE5BqD,EAAY,OAGd,IAAIC,EAAc,SAalB,OAXErD,IAAgBT,GAAY+D,SAC5BtD,IAAgBT,GAAYgE,KAE5BF,EAAc,QAEdrD,IAAgBT,GAAYiE,SAC5BxD,IAAgBT,GAAYQ,UAE5BsD,EAAc,OAId,gCACE,sBAAMjO,MAAK,qBAAgB+N,GAA3B,SACE,sBACEM,MAAM,6BACN9Q,MAAM,KACN/B,OAAO,KACP8S,KAAMN,EACNjU,UAAU,aACVwU,QAAQ,YANV,UAQE,sBAAMC,EAAE,6NACR,sBAAMA,EAAE,0kBAEJ,IACR,sBAAMxO,MAAK,kBAAa4K,EAAb,yBAAyC3U,KAApD,SACE,qBACEoY,MAAM,6BACN9Q,MAAM,KACN/B,OAAO,KACP8S,KAAML,EACNlU,UAAU,YACVwU,QAAQ,YANV,SAQE,sBAAMC,EAAE,2vBAGX5D,IAAgBT,GAAYgE,MAC3B,uBAAMnO,MAAM,iBAAZ,UACG,IACD,qBACEqO,MAAM,6BACN9Q,MAAM,KACN/B,OAAO,KACP8S,KAAK,QACLvU,UAAU,iBACVwU,QAAQ,YANV,SAQE,sBACEE,SAAS,UACTD,EAAE,8MAZR,cClDO,SAASE,GAAT,GAOE,IANf1P,EAMc,EANdA,UACAS,EAKc,EALdA,MACA/F,EAIc,EAJdA,MACA4E,EAGc,EAHdA,MACAmF,EAEc,EAFdA,SACAC,EACc,EADdA,MAEMxJ,EAAWC,cAEbwU,EAAgB,cAmBpB,MAlBc,YAAVjV,EACFiV,EAAgB,cACG,WAAVjV,EACTiV,EAAgB,aACG,SAAVjV,EACTiV,EAAgB,WACG,YAAVjV,IACTiV,EAAgB,eAGlB9K,qBAAU,WACJvF,IACF6C,QAAQ2K,IAAI,mBACZpI,OAGD,CAACpF,IAGF,qBAAKvE,UAAU,kBAAf,SACE,wBACE+J,KAAK,SACL/J,UAAS,cAAS4U,GAClBjV,MAAO,CAAEkV,YAAa,OAAQrR,MAAO,OACrC3C,QAAS,WACPV,EACEkE,GAAe,CACbC,IAAKW,EACLV,OAAO,MAIbmF,SAAUA,EAZZ,SAcGhE,MClDM,SAASoP,GAAT,GAIK,IAHlBnL,EAGiB,EAHjBA,MACAoL,EAEiB,EAFjBA,QACAlE,EACiB,EADjBA,YAEA,OACE,yBACE9G,KAAK,SACL/J,UAAU,kBACVL,MAAO,CAAEkV,YAAa,OAAQrR,MAAO,OACrC3C,QAAS,WACP8I,KAEFD,SACEqL,GAEAlE,IAAgBT,GAAY+D,QAVhC,UAaGtD,IAAgBT,GAAY+D,SAC3B,iCACE,mBAAGnU,UAAU,aAAaC,cAAY,SADxC,UAID4Q,IAAgBT,GAAYgE,MAC3B,iCACE,qBACEE,MAAM,6BACN9Q,MAAM,KACN/B,OAAO,KACP8S,KAAK,QACLvU,UAAU,iBACVwU,QAAQ,YANV,SAQE,sBACEE,SAAS,UACTD,EAAE,8MAEC,IAbT,UAiBD5D,IAAgBT,GAAYgE,MAC3BvD,IAAgBT,GAAY+D,SAAW,0DHtBhB,0BAA3B5Q,OAAOiG,SAASwL,QAClBpD,GAAW,sBACXC,IAAc,IAEdD,GAAWrO,OAAOiG,SAASwL,OACxBlF,QAAQ,UAAW,SACnBA,QAAQ,WAAY,UACvB+B,IAAc,G,aIkCD,SAASoD,GAAT,GAgBG,IAfhBC,EAee,EAffA,cACAjM,EAce,EAdfA,WACAkM,EAae,EAbfA,iBACAC,EAYe,EAZfA,cAEAL,GAUe,EAXfnR,aAWe,EAVfmR,SACAM,EASe,EATfA,cACAC,EAQe,EARfA,UACAC,EAOe,EAPfA,aACAC,EAMe,EANfA,aACAC,EAKe,EALfA,UACAC,EAIe,EAJfA,eAEAtL,GAEe,EAHfuL,oBAGe,EAFfvL,kBACAwL,EACe,EADfA,eAEMzV,EAAWC,cACXyV,EAAgB7D,YAAYnL,IAC5BgK,EAAcmB,YAAYT,IAE1BD,EAAKwE,qBAAWpE,IAShB/H,EAAQ,WACRS,GACF2L,KAIEA,EAAS,WACb,IAAM7R,EAAagF,KACnB/I,EAAS4E,GAAcb,IAEvBoN,EAAGa,YAAYjL,KAAKuL,UNnDf,CACLC,QAAS,eACTvO,QMiD0C+C,KAAKuL,UAAUoD,OA2B3D/L,qBAAU,WACR,GAAIuL,EACF,cAAgCjQ,OAAO4Q,QAAQX,GAA/C,eAA+D,CAAC,IAAD,sBAArD/Q,EAAqD,KAAhD2R,EAAgD,KACzD3R,KAAOuR,IAIgB,SAAvBI,EAAarT,MACfzC,EAASkE,GAAe,CAAEC,MAAKC,MAAO,MACN,SAAvB0R,EAAarT,MACtBzC,EACEkE,GAAe,CACbC,MACAC,MAAO0R,EAAa1R,MAAQ0R,EAAa1R,MAAQ,MAG5CnB,GAAiB6S,KAGjB/S,GAAoB+S,GAC7B9V,EAASkE,GAAe,CAAEC,MAAKC,MAAO,gBAEtCpE,EAASkE,GAAe,CAAEC,MAAKC,MAAO0R,EAAa1R,cAIxD,CAACpE,EAAUkV,EAAeQ,IAE7B,IAAI1R,EAAU,GACV+R,EAAW,GAEf,GAAIb,IAAkBO,EAAgB,CAGpC,IADA,IAAIO,EAAa,GACjB,MAAgB/Q,OAAOC,KAAKgQ,GAA5B,eAA4C,CAAvC,IAAI/Q,EAAG,KACJ8R,EAAQ9R,EAAI+R,MAAM,KACxBF,EAAWjV,KAAK,CAACoD,EAAKgS,WAAW,GAAD,OAAIF,EAAM,GAAV,YAAgBA,EAAM,OAExDD,EAAWI,MAAK,SAAUzV,EAAG0V,GAG3B,OAFW1V,EAAE,GACF0V,EAAE,MAIf,cAAiBL,EAAjB,eAA6B,CAAxB,IACG7R,EADK,KACM,GACX2R,EAAeZ,EAAc/Q,GAE/B5B,GAAeuT,GACjB9R,EAAQjD,KACN,cAACiM,GAAD,CACElI,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GACrBsB,QAAO,OAAEqQ,QAAF,IAAEA,OAAF,EAAEA,EAAcrQ,QACvBwH,MAAK,OAAE6I,QAAF,IAAEA,OAAF,EAAEA,EAAc7I,MAErBzD,MAAOA,GADFrF,IAIAzB,GAAiBoT,GAC1B9R,EAAQjD,KACN,cAACuI,GAAD,CACExE,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GAErBqF,MAAOA,GADFrF,IAIAxB,GAAgBmT,GACzB9R,EAAQjD,KACN,cAACiJ,GAAD,CACElF,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GACrBiB,IAAG,OAAE0Q,QAAF,IAAEA,OAAF,EAAEA,EAAc1Q,IACnBC,IAAG,OAAEyQ,QAAF,IAAEA,OAAF,EAAEA,EAAczQ,IACnBC,KAAI,OAAEwQ,QAAF,IAAEA,OAAF,EAAEA,EAAcxQ,KAEpBkE,MAAOA,EACPS,iBAAkBA,GAFb9F,IAKAvB,GAAekT,GACxB9R,EAAQjD,KACN,cAACyN,GAAD,CACE1J,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GACrBiB,IAAG,OAAE0Q,QAAF,IAAEA,OAAF,EAAEA,EAAc1Q,IACnBC,IAAG,OAAEyQ,QAAF,IAAEA,OAAF,EAAEA,EAAczQ,IACnBC,KAAI,OAAEwQ,QAAF,IAAEA,OAAF,EAAEA,EAAcxQ,KACpB8F,SAAQ,OAAE0K,QAAF,IAAEA,OAAF,EAAEA,EAAc1K,SAExB5B,MAAOA,GADFrF,IAIAtB,GAAciT,GACvB9R,EAAQjD,KACN,cAACoK,GAAD,CACErG,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GACrBiB,IAAG,OAAE0Q,QAAF,IAAEA,OAAF,EAAEA,EAAc1Q,IACnBC,IAAG,OAAEyQ,QAAF,IAAEA,OAAF,EAAEA,EAAczQ,IACnBC,KAAI,OAAEwQ,QAAF,IAAEA,OAAF,EAAEA,EAAcxQ,KACpB8F,SAAQ,OAAE0K,QAAF,IAAEA,OAAF,EAAEA,EAAc1K,SAExB5B,MAAOA,GADFrF,IjB9I0B,SiBkJb2R,EjBlJGrT,OiBmJzBuB,EAAQjD,KACN,cAAC2N,GAAD,CACE5J,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBoJ,YAAW,OAAEmH,QAAF,IAAEA,OAAF,EAAEA,EAAcnH,YAE3BvK,MAAOsR,EAAcvR,GACrBqF,MAAOA,GAFFrF,IAKT4R,EAAShV,KAAKoD,IACLrB,GAAagT,GACtB9R,EAAQjD,KACN,cAACwO,GAAD,CACEzK,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GACrBqB,KAAI,OAAEsQ,QAAF,IAAEA,OAAF,EAAEA,EAActQ,KAEpBgE,MAAOA,EACPS,iBAAkBA,GAFb9F,IAKAlB,GAAiB6S,GAC1B9R,EAAQjD,KACN,cAACmP,GAAD,CACE9L,MAAO0R,EAAa1R,MACpBmF,SAAUqL,GACLzQ,IAGAjB,GAAe4S,GACxB9R,EAAQjD,KACN,cAACyT,GAAD,CACE1P,UAAWX,EACXoF,SAAUqL,EACVrP,MAAK,OAAEuQ,QAAF,IAAEA,OAAF,EAAEA,EAAcvQ,MACrBnB,MAAOsR,EAAcvR,GACrB3E,MAAK,OAAEsW,QAAF,IAAEA,OAAF,EAAEA,EAActW,MAErBgK,MAAOA,GADFrF,IAIApB,GAAoB+S,IAG7B7O,QAAQ2K,IAAI,sBAAuBkE,IAsBzC,IAAIQ,EAAkB,GAKtB,OAJIjB,IACFiB,EAAkB,CAAE5W,QAAS,QAI7B,qBACEY,GAAG,cACHT,UAAU,uCACVL,MAAK,2BAAO8W,GAAP,IAAwBC,UAAW,SAH1C,SAKE,cAAC,KAAD,CAASC,UAAU,EAAOC,QAAQ,GAAlC,SACE,sBAAK5W,UAAU,sBAAf,UACE,+BACGkV,EACD,wBACElV,UAAU,kCACV+J,KAAK,SACLpK,MAAO,CACLG,MAAO,QACP0N,OAAQ,OAEV3M,QAAS,kBAAMV,EAASgC,GAAe,KACvC0U,cAAY,UACZC,iBAAe,QACf7Q,MAAM,eAVR,SAYE,mBAAGjG,UAAU,qBAAqBC,cAAY,cAIlD,qBAAKN,MAAO,CAAEE,QAAS,OAAvB,SACE,iCACGsE,EACD,sBAAKnE,UAAU,4BAAf,WACIoK,GACA,cAAC0K,GAAD,CACEnL,MAAOoM,EACPhB,QAASA,EACTlE,YAAaA,IAGjB,sBACE7Q,UAAU,WACVL,MAAO,CACL6D,MAAO,MACP1D,MAAOsK,EAAmB,OAAS,SAJvC,UAOE,wBACEpK,UAAU,kCACVL,MAAO,CAAEY,OAAQ,MAAOiD,MAAO,QAC/BuG,KAAK,SACLrJ,iBAAe,WACfgJ,SAAUqL,EALZ,sBAUA,qBAAI/U,UAAU,kCAAd,UACE,6BACE,oBACEL,MAAO,CAAEoX,OAAQ,WACjB/W,UAAU,gBACVa,QAAS,WACH+U,EACF9Y,EAAe,GAAD,OACTJ,IAAMC,SAASyS,SADN,OACgBmG,GADhB,UAETL,EAFS,UAzQjCU,GACHtE,EAAGa,YAAYjL,KAAKuL,UNhDjB,CACLC,QAAS,oBMkTS,UAmBE,mBAAG1S,UAAU,oBAAoBC,cAAY,SAAY,IAnB3D,wBAuBF,6BACE,oBAAID,UAAU,uBAEhB,6BACE,yBACE+J,KAAK,SACL/J,UAAU,gBACVa,QAAS,WACH+U,EACFzV,EdjPxB,SAAC8I,EAAoBsM,GAArB,8CACI,WAAOpV,GAAP,qBAAAW,EAAA,sEAEQX,EAASgI,IAAkB,IAC3BhI,EAASkI,MACTlI,EAASiI,GAAoB,KAEvBjM,EAAYD,IAGZoJ,EAAS,CACX0R,WAAY7a,EACZ8a,YAAahO,EACbiO,cAAe3B,GAZ3B,SAc+B7Y,IAAMqE,KAdrC,sBAc+CuE,GAd/C,gBAcgBhI,EAdhB,EAcgBA,KACR6C,EAASiI,GAAoB9K,EAAK6Z,SAf1C,kDAiBQnW,IAAMG,MAAN,sDACAhB,EAASoI,MAlBjB,0DADJ,sDciPiC6O,CAAYnO,EAAYsM,KAEjCpV,EAASgI,IAAkB,IAhS9CyN,GACHtE,EAAGa,YAAYjL,KAAKuL,UNhDjB,CACLC,QAAS,oBMuUS,UAYE,mBAAG1S,UAAU,mBAAmBC,cAAY,SAAY,IAZ1D,gCAiEc,KAArBkV,GACC,sBAAKnV,UAAU,2BAA2BQ,KAAK,QAA/C,UACE,8BACE,mBAAGR,UAAU,gBAAgBC,cAAY,SAAY,IADvD,0BAE0BkV,EAF1B,QAKCC,GACC,8BACG,IACD,mBAAGpV,UAAU,iBAAiBC,cAAY,SAF5C,sBAGgBmV,EAHhB,OAMF,gCACE,mBAAGpV,UAAU,gBAAgBC,cAAY,SAD3C,uCAOHmK,GACC,8BAEE,yBAWH2K,IACElE,IAAgBT,GAAYQ,SAC3BC,IAAgBT,GAAYiH,SAC5B,sBAAKrX,UAAU,gCAAgCQ,KAAK,QAApD,UACE,mBAAGR,UAAU,aAAaC,cAAY,SADxC,6BAKH8U,GAAWlE,IAAgBT,GAAYkH,UACtC,sBAAKtX,UAAU,gCAAgCQ,KAAK,QAApD,UACE,mBAAGR,UAAU,aAAaC,cAAY,SADxC,8BAKDqV,GACC,sBAAKtV,UAAU,kCAAkCQ,KAAK,QAAtD,UACE,mBAAGR,UAAU,gBAAgBC,cAAY,SAD3C,gGAODyV,GACC,sBAAK1V,UAAU,2BAA2BQ,KAAK,QAA/C,UACE,mBAAGR,UAAU,mBAAmBC,cAAY,SAD9C,oCAE4B,kCAF5B,0BAE4D,IAC1D,oCAHF,YAIE,uBACA,uBACA,mBAAGD,UAAU,eAAeC,cAAY,SAN1C,oCAOyB,oCAPzB,+BA0DLwV,GACC,gCACE,uBACA,yBACEzV,UAAU,mCACVL,MAAO,CACL0L,OAAQ,QAGVxK,QAAS,WACPV,EAAS6B,EAAQ,SAPrB,UAUE,mBAAGhC,UAAU,eAAeC,cAAY,SAV1C,UAaA,yBACED,UAAU,mCACVL,MAAO,CACL0L,OAAQ,QAGVxK,QAAS,WACPV,EAAS6B,EAAQ,WAPrB,UAUE,mBAAGhC,UAAU,sBAAsBC,cAAY,SAAY,IAV7D,0BAeY8D,IAAfkF,IAA6B2M,GAC5B,gCACE,uBACA,sBAAKjW,MAAO,CAAE+B,YAAa,QAA3B,UACE,cAAC,GAAD,IAAsB,iB,cC5lBvB,SAAS6V,GAAT,GAaI,IAZjBC,EAYgB,EAZhBA,QACA5T,EAWgB,EAXhBA,aACA2R,EAUgB,EAVhBA,aACAR,EASgB,EAThBA,QACA0C,EAQgB,EARhBA,SACAnC,EAOgB,EAPhBA,UACAE,EAMgB,EANhBA,aACAtW,EAKgB,EALhBA,MACAxB,EAIgB,EAJhBA,SACAwG,EAGgB,EAHhBA,WACAwT,EAEgB,EAFhBA,aACAhC,EACgB,EADhBA,eAEQjU,EjB9BK,WAAgC,IAAD,EACImI,mBAC9CtG,MAF0C,mBACrCqU,EADqC,KACnBC,EADmB,KAc5C,OATA9N,qBAAU,WACR,SAAS+N,IACPD,EAAoBtU,MAItB,OADAC,OAAOuU,iBAAiB,SAAUD,GAC3B,kBAAMtU,OAAOwU,oBAAoB,SAAUF,MACjD,IAEIF,EiBgBYK,GAAXvW,OAEFwW,EAAezC,EAAe/T,EAAS,GAAKA,EAAS,GACrDtB,EAAWC,cACb8X,EAAKlG,YAAY3L,IACjB0K,EAAciB,YAAYP,IAE1B2B,GAAW,EAUf,QATWrP,IAAPmU,QAAkCnU,IAAdmU,EAAG5S,aAEIvB,IAA3BmU,EAAG5S,OAAO,cACiB,OAA3B4S,EAAG5S,OAAO,eAEV8N,EAAW8E,EAAG5S,OAAO,cAIL,KAAhByL,IAAuB2E,IACzB3E,EAAc,oCAAqCA,GAE9CqC,GAAU,CAUbrC,EATmB,mMASWA,EAIlC,GAAoB,KAAhBA,GAAsB2E,GAAiC,KAAfxR,IACI,IAA1C6M,EAAYoH,QAAQ,iBAAyB,CAC/C,IAAMC,EAAWlU,EAAWmS,MAAM,KAC9BgC,EAAa,GACO,IAApBD,EAAS3M,OACX4M,EAAU,uBAAmBD,EAAS,GAA5B,aAAmCA,EAAS,GAA5C,aAAmDA,EAAS,GAA5D,MACmB,IAApBA,EAAS3M,OAClB4M,EAAU,uBAAmBD,EAAS,GAA5B,aAAmCA,EAAS,GAA5C,MACmB,IAApBA,EAAS3M,SAClB4M,EAAU,uBAAmBD,EAAS,GAA5B,OAGO,KAAfC,IACFtH,EAAcA,EAAYjB,QACxB,sBADY,mCAEgBuI,EAFhB,wBAQpBvO,qBAAU,gBACa/F,IAAjBwR,GACF7Y,IACGO,IADH,UACUP,IAAMC,SAASyS,SADzB,OACmCmG,GADnC,OACkDrR,IAC/C/G,MAAK,SAAC4V,GACL,IAAIuF,EAAQvF,EAASzV,KAChBoY,IAMH4C,GADAA,GADAA,GADAA,GADAA,GADAA,EAAQA,EAAMxI,QAAQ,yBAA0B,KAClCA,QAAQ,SAAU,KAClBA,QAAQ,UAAW,KACnBA,QAAQ,QAAS,SACjBA,QAAQ,UAAW,WACnBA,QAAQ,kBAAmB,KAE3C3P,EAASiR,GAAekH,SAG7B,CAACnY,EAAUoV,EAAcrR,EAAYwR,IAExC,IAAI6C,EAAY,CACd7M,WAAY,MACZ8M,aAAc,MACd9W,YAAa,MACbiK,QAAqB,UAAZ6L,EAAsB,OAAS,SAG1C,OACE,sBAAMxX,UAAS,4BAAuB0X,GAAgB/X,MAAO4Y,EAA7D,SACE,cAAC,KAAD,CAASE,IAAI,MAAM9B,SAAU5B,EAA7B,SACE,gCACoB,YAAjBnR,IAA+B0R,GAC9B,kEAEgB,UAAjB1R,IAA6B1E,GAC5B,mBAAGS,MAAO,CAAEY,OAAQ,QAApB,sGAMgB,UAAjBqD,GAA4B1E,GAAsB,KAAbxB,GACpC,oBAAGiC,MAAO,CAAEY,OAAQ,QAApB,UACE,mEACA,oBAAGR,KAAK,SAASC,UAAU,0BAA3B,UACE,mBAAGA,UAAU,gBAAgBC,cAAY,SAD3C,gBAMc,UAAjB2D,GAA4B1E,GAAsB,KAAbxB,GACpC,mBAAGiC,MAAO,CAAEY,OAAQ,QAApB,sGAYDkX,GACC,sBAAKzX,UAAU,0BAA0BQ,KAAK,QAA9C,UACE,kEACA,4BAAIiX,OAiBM,KAAbA,GACkB,YAAjB7T,GACA8R,GACgB,KAAhB3E,GACE,wBACEvN,MAAM,OACN/B,OAAQwW,EAERS,OAAQ3H,EACR9K,MAAM,UACNxF,GAAG,cACH4S,QAAS,WACPjM,QAAQ2K,IAAI,kBALTwD,GAUM,KAAhBxE,IAAuB2E,GACtB,cAAC,KAAD,CAAWiD,KAAM5H,WCjK7B,IACe6H,GAtBf,YAA2C,IAAtB3P,EAAqB,EAArBA,WACb9I,EAAWC,cACXyY,EAAW7G,YAAY3L,IACvBpC,EAAmB+N,YAAYrL,IAerC,OAbAmD,qBAAU,WAEa,gBAAnB+O,EAASxa,OACU,eAAnBwa,EAASxa,OACU,gBAAnBwa,EAASxa,OAET2P,YAAW,WACT7N,EAAS2G,GAAcmC,GAAY,IACnC9I,EAAS6I,GAAiBC,MACzB,OAEJ,CAAC9I,EAAU0Y,EAAU5P,EAAYhF,IAE7B,yBClBM,SAAS6U,GAAT,GAIK,IAAD,EAHjBjX,EAGiB,EAHjBA,MACAC,EAEiB,EAFjBA,WACAiT,EACiB,EADjBA,QAEM5U,EAAWC,cAYb2Y,EAAa,GAbA,cAeHlX,GAfG,yBAeRmX,EAfQ,QAgBXC,EAAQD,EAAE3C,MAAM,KAAK6C,MACrBF,GAAKC,GACPF,EAAW7X,KACT,gCACE,mBACElB,UAAU,oBACVC,cAAY,OACZN,MAAO,CAAE6Y,aAAc,SACnB,IACN,4BAAIS,IACJ,yBACEtZ,MAAO,CAAEG,MAAO,SAChBiK,KAAK,SACL/J,UAAU,kBACVa,QAAS,kBA3BK9D,EA4BG,GAAD,OAAIL,IAAMC,SAASyS,SAAnB,OAA6B4J,GA5BlBhc,EA4BuBic,OA3B1Dvc,IACGO,IAAIF,EAAK,CACRG,aAAc,SAEfC,MAAK,SAACC,GACLC,IAAaD,EAAIE,KAAMN,MANN,IAACD,EAAaC,GAuB7B,UAQE,mBAAGgD,UAAU,iBAAiBC,cAAY,SAR5C,eAUA,yBAjBQ+Y,KAJhB,2BAAsB,IAfL,8BA0CjB,OACE,uBAAMhZ,UAAU,+BAA+BL,MAAO,CAAEE,QAAS,QAAjE,UACE,sBAAKG,UAAU,QAAf,UACE,qBAAIL,MAAO,CAAEwZ,cAAe,QAA5B,UACE,mBAAGnZ,UAAU,sBAAsBC,cAAY,SADjD,mBAGA,cAAC,KAAD,CAASwY,IAAI,MAAM9B,SAAU5B,EAA7B,SACE,gCACkB,WAAfjT,GAA2BiX,EACZ,YAAfjX,GACC,oFAEc,YAAfA,GAA4B,8DACb,UAAfA,GACC,qBAAK9B,UAAU,0BAA0BQ,KAAK,QAA9C,4HASR,yBACER,UAAU,2BAEVa,QAAS,WACPV,EAAS6B,EAAQ,SAJrB,UAOE,mBAAGhC,UAAU,mBAAmBC,cAAY,SAP9C,qBCjFS,SAASmZ,KACtB,OACE,mBAAGrZ,KAAK,yBAAyB8K,OAAO,SAASwO,IAAI,aAArD,SACE,sBAAKrZ,UAAU,YAAf,UACE,sBAAKA,UAAU,cAAf,UACG,IACD,mBAAGL,MAAO,CAAEyL,SAAU,SAAtB,0BAAkD,OAEpD,8BACE,qBACE9J,IAAI,UACJC,IACEC,iCAIF7B,MAAO,CAAE8B,OAAQ,iBCHd,SAAS6X,GAAT,GAuBb,IAjBS,IALTC,EAKQ,EALRA,KACAlE,EAIQ,EAJRA,cACAE,EAGQ,EAHRA,aACAmC,EAEQ,EAFRA,aACA8B,EACQ,EADRA,cACQ,EACwB5P,mBAC9B1C,KAAKuL,UAAU,CAAEgH,IAAK,oBAFhB,mBACD1G,EADC,KACS2G,EADT,KAIF7D,EAAgB7D,YAAYnL,IAE9B8S,EAAkB,GAWtB,MAAgCvU,OAAO4Q,QAAQX,GAA/C,eAA+D,CAAC,IAAD,sBAArD/Q,EAAqD,UAC5C1B,QACf+W,EAAgBrV,GAAOuR,EAAcvR,IAnBjC,4CAuBR,8BAAAxD,EAAA,+EAE2BpE,IAAMO,IAAN,cAAiBuc,IAF5C,gBAEYlc,EAFZ,EAEYA,KACRoc,EAAYxS,KAAKuL,UAAUnV,IAH/B,0GAvBQ,sBA8BRwM,qBAAU,WACJ0P,GA/BE,mCAgCJI,KAGD,CAACJ,EAAejE,IAEnB,IAAIpZ,EAAY,6BACZqd,IACFrd,EAAYqd,GAGd,IAAIK,EAAW,gEAA2D3S,KAAKuL,UAC7EkH,GADa,aAETjd,IAAMC,SAASyS,QAFN,gBAEqBmK,GACpC,OACE,sBACEvZ,UAAS,4BAAuB0X,GAChC/X,MAAO,CACL0L,OAAQ,OACRK,WAAY,MACZ8M,aAAc,MACd9W,YAAa,MACb7B,QAAS,QAPb,UAUE,sDACA,wIAKA,sBAAKG,UAAU,wBAAwBQ,KAAK,QAA5C,UACE,sEACA,0BACEkJ,UAAQ,EACR/J,MAAO,CAAE6D,MAAO,QAChBmC,KAAM,EACNpB,MAAOsV,IANX,oHAUE,uBAVF,oBAYE,gDAAiB1d,EAAjB,WAEF,sBAAK6D,UAAU,wBAAwBQ,KAAK,QAA5C,UACE,6EACA,0BACEkJ,UAAQ,EACR/J,MAAO,CAAE6D,MAAO,QAChBmC,KAAM,EACNpB,MAAK,eAAU7H,IAAMC,SAASyS,QAAzB,gBAAwCjT,QAIjD,sBAAK6D,UAAU,sBAAsBQ,KAAK,QAA1C,UACE,0CACA,8BAAMuS,UCnGC,SAAS+G,GAAT,GAA6C,IAAtB7Q,EAAqB,EAArBA,WAC9B9I,EAAWC,cACXyY,EAAW7G,YAAY3L,IAS7B,OAPAyD,qBAAU,WACRkE,YAAW,WACT7N,EAAS2G,GAAcmC,GAAY,IACnC9I,EAAS6I,GAAiBC,MACzB,OACF,CAAC9I,EAAU8I,EAAY4P,IAEnB,wBChBM,SAASkB,KACtB,IAAM5Z,EAAWC,cACX4Z,EAAUhI,YAAYjJ,IACtBkR,EAAQjI,YAAYlJ,IACpBoR,EAAelI,YAAYnJ,IAoBjC,OAlBAiB,qBAAU,WACK,KAAVmQ,GAGCC,IAIAF,EAAU,IACZhM,YAAW,WACT7N,ErBsLJ,SAAC8Z,GAAD,8CACI,WAAO9Z,GAAP,mBAAAW,EAAA,sEAEc/D,EAFd,0BAEuCkd,GAFvC,SAG+Bvd,IAAMO,IAAIF,GAHzC,iBAGgBO,EAHhB,EAGgBA,MACC6c,OACLha,EAASoI,MACU,KAAfjL,EAAK6D,MACLH,IAAMG,MAAM7D,EAAK6D,OAEjBrE,EAAe,GAAD,OACPJ,IAAMC,SAASyS,SADR,OACkB9R,EAAKP,KADvB,UAEPO,EAAK2I,SAIhB9F,EAASmI,MAfrB,gDAkBQtH,IAAMG,MAAN,sDACAhB,EAASoI,MAnBjB,yDADJ,sDqBtLa6R,CAAOH,MACf,MAEH9Z,EAASoI,MACTvH,IAAMG,MAAM,8EAA+E,CAAEkZ,UAAW,UAEzG,CAACla,EAAU6Z,EAASC,EAAOC,IAEvB,wBC0QT,IACeI,GAtPf,YAAkE,EAAnDC,YAAoD,IAAD,UAAtCtR,EAAsC,EAAtCA,WAAYuM,EAA0B,EAA1BA,aAChCrV,EAAWC,cACXyY,EAAW7G,YAAY3L,IACvBzC,EAAeoO,YAAYtL,IAC3B8T,EAAOxI,YAAYvJ,IACnBlB,EAAeyK,YAAYrJ,IAC3BlB,EAAeuK,YAAYpJ,IAC3B4O,EAAUxF,YAAY3P,IACtBoY,EAAczI,YAAYxP,IAC1BkY,EAAmB1I,YAAYzP,IAC/BrD,EAAQ8S,YAAY1S,GACpB5B,EAAWsU,YAAYlT,GACvBrC,EAAQuV,YAAYpT,GACpBsF,EAAa8N,YAAYpL,IACzB7E,EAAciQ,YAAYvP,IAC1BiF,EAAiBsK,YAAYnJ,IAC7BiI,EAAWkB,YAAYR,IACvBX,EAAcmB,YAAYT,IAQ1BoJ,EAAa,WAAO,IAAD,EACvB,eAAI9B,QAAJ,IAAIA,GAAJ,UAAIA,EAAUvT,cAAd,aAAI,EAAkBmB,kBAGfoK,IAAgBT,GAAY+D,SAG/ByG,EAAc,WAClB,MACqB,gBAAnB/B,EAASxa,OACU,eAAnBwa,EAASxa,OACU,gBAAnBwa,EAASxa,OAIbyL,qBAAU,WACR3J,EAAS2G,GAAcmC,MAItB,CAAC9I,EAAU8I,EAAYxM,IAoC1BqN,qBAAU,WAAO,IAAD,EAEA,UAAZ0N,GAC8B,OAAtB,OAARqB,QAAQ,IAARA,GAAA,UAAAA,EAAUvT,cAAV,eAAkB/F,eACLwE,IAAb+M,GAEA3Q,E1B7DJ,SAAC2Q,GAAD,8CACE,WAAO3Q,GAAP,qBAAAW,EAAA,sEAEIX,EAAS8B,EAAc,YACvB9B,EAAS+B,EAAS,KACZ/F,EAAYD,IACZa,EALV,sCAK+CZ,EAL/C,YAK4D2U,GAL5D,SAM2BpU,IAAMO,IAAIF,GANrC,gBAMYO,EANZ,EAMYA,KACR6C,EAAS+B,EAAS5E,IAClB6C,EAAS8B,EAAc,WAR3B,kDAUI9B,EAAS8B,EAAc,UACvBmF,QAAQjG,MAAR,6DAXJ,0DADF,sD0B6Da0Z,CAAuB/J,MAEjC,CAAC3Q,EAAUqX,EAASqB,EAAU/H,IAEjC,IAAIyE,EAAesD,EAASiC,kBACxBN,EAAKnc,OAAwB,SAAfmc,EAAKnc,OAAoBmc,EAAKO,SAC9CxF,EAAeiF,EAAKO,QAEtB,IAAItD,EAAW,GACX+C,EAAKnc,OAASmc,EAAKO,QAAyB,UAAfP,EAAKnc,QACpCoZ,EAAW+C,EAAKO,QAKhBxT,EAAalJ,OACU,SAAvBkJ,EAAalJ,OACbkJ,EAAawT,SAEbxF,EAAehO,EAAawT,QAG5BxT,EAAalJ,OACbkJ,EAAawT,QACU,UAAvBxT,EAAalJ,QAEboZ,EAAWlQ,EAAawT,QAKxBxF,IAAiBsD,EAASiC,mBAC1BrT,EAAapJ,OACU,SAAvBoJ,EAAapJ,OACboJ,EAAasT,SAEbxF,EAAe9N,EAAasT,QAG9B,IAaIC,GAAc,EAKlB,OAJInC,EAAS1V,QAAU0V,EAAS1V,OAAO8X,cAAcrW,WAAW,UAC9DoW,GAAc,GAId,sBAAKhb,UAAU,MAAf,WACIwV,GAAgB,cAACnU,EAAD,CAAQnC,MAAOA,EAAOxB,SAAUA,IAClD,eAAC,KAAD,CACEiZ,SAAUjP,EACVkP,QAAQ,oCAFV,UAIGlP,GAAkB,cAACqS,GAAD,IACnB,qBAAK/Z,UAAU,kBAAf,SACE,sBAAKA,UAAU,MAAf,UACE,cAAC,GAAD,CAAoBiJ,WAAYA,SAETlF,IAAtB8U,EAASqC,UAAgD,KAAtBrC,EAASqC,UAC3C,cAACpB,GAAD,CAAa7Q,WAAYA,IAG1BlH,GACC,cAACkT,GAAD,CACEC,cAAe2D,EAAS5S,MACxBgD,WAAYA,EACZkM,iBAAkB0D,EAASqC,SAC3B9F,cAAeoF,EAAKW,WACpBvX,aAAcA,EACdmR,QAAS4F,IACTtF,cAAa,OAAEwD,QAAF,IAAEA,GAAF,UAAEA,EAAUvT,cAAZ,aAAE,EAAkBA,OACjCgQ,UAAWsF,IACXrF,aAAcA,EACdC,aAAcA,EACdC,UA9CkB,SAC9BJ,GAEA,GAAIA,EACF,cAA6BjQ,OAAO4Q,QAAQX,GAA5C,eAA4D,CAC1D,GAAInS,GADsD,wBAExD,OAAO,EAIb,OAAO,EAoCgBkY,CAAuB,OAACvC,QAAD,IAACA,GAAD,UAACA,EAAUvT,cAAX,aAAC,EAAkBA,QACrDoQ,oBACsB3R,IAApB8U,EAAS1V,QAA4C,WAApB0V,EAAS1V,OAE5CwS,oBAAqBkD,EAASwC,OAC9BjR,iBAAgB,OAAEyO,QAAF,IAAEA,GAAF,UAAEA,EAAUvT,cAAZ,aAAE,EAAkBgW,kBACpC1F,eAAc,OAAEiD,QAAF,IAAEA,GAAF,UAAEA,EAAUvT,cAAZ,aAAE,EAAkBmB,mBAIpC1E,GACA,8BACE,wBACE/B,UAAU,kCACV+J,KAAK,SACLpK,MAAO,CACLsL,SAAU,WACVC,IAAKsK,EAAe,MAAQ,OAC5BrK,KAAM,MACNqC,OAAQ,OAEV3M,QAAS,kBAAMV,EAASgC,GAAe,KACvC0U,cAAY,UACZC,iBAAe,QACf7Q,MAAM,eAZR,SAcE,mBAAGjG,UAAU,sBAAsBC,cAAY,aAKpD+a,GACC,cAAC1B,GAAD,CACEC,KAAMV,EAASU,KACflE,cAAa,OAAEwD,QAAF,IAAEA,GAAF,UAAEA,EAAUvT,cAAZ,aAAE,EAAkBA,OACjCiQ,aAAcA,EACdmC,aAAc3V,EAAc,EAAI,GAChCyX,cAAegB,EAAKxD,aAIxB,cAACO,GAAD,CACEC,QAASA,EACT5T,aAAcA,EACd2R,aAAcA,EACdkC,SAAUA,EACV1C,QAAS4F,IACTrF,UAAWsF,IACXpF,aAAcA,EACdtW,MAAOA,EACPxB,SAAUA,EACVwG,WAAYA,EACZwT,aAAc3V,EAAc,EAAI,GAChC2T,oBACsB3R,IAApB8U,EAAS1V,QAA4C,WAApB0V,EAAS1V,SAIjC,UAAZqU,GACC,cAACsB,GAAD,CACEjX,MAAO4Y,EACP3Y,WAAY4Y,EACZ3F,QAAS4F,cAMlBnF,GAAgB,cAAC4D,GAAD,QC3QvB,IACemC,GADHC,aAlBZ,WAAkB,IACRvE,EAAgBwE,cAAhBxE,YACFhO,EAAayS,OAAOzE,GAElB0E,EAAUF,cAAVE,MACFnG,KAAkBmG,GAAmB,UAAVA,GAEjC,OACE,cAAC7J,GAAD,UACE,cAAC,GAAD,CACEyI,aAAa,EACbtR,WAAYA,EACZuM,aAAcA,SCfP,SAASoG,KACtB,OACE,wBACE5b,UAAU,SACVL,MAAO,CACLsL,SAAU,WACV4Q,OAAQ,IACRrY,MAAO,OACP/B,OAAQ,OACRqa,WAAY,OACZjP,gBAAiB,UACjBkP,UAAW,qBATf,SAYE,sBAAK/b,UAAU,YAAf,UACE,uBAAMA,UAAU,aAAaL,MAAO,CAAEC,MAAO,QAA7C,yBACY,IACV,mBACED,MAAO,CAAEqc,eAAgB,OAAQpc,MAAO,QACxCG,KAAK,oBACL8K,OAAO,SACPwO,IAAI,aAJN,sBASF,uBAAMrZ,UAAU,aAAaL,MAAO,CAAEG,MAAO,SAA7C,UAEE,mBACEH,MAAO,CAAEqc,eAAgB,OAAQpc,MAAO,QACxCG,KAAK,mCACL8K,OAAO,SACPwO,IAAI,aAJN,qBAQC,IACD,mBAAGrZ,UAAU,eAAeC,cAAY,iBC7BnC,SAASoB,GAAT,GAAmD,IAAjCnC,EAAgC,EAAhCA,MAAOxB,EAAyB,EAAzBA,SACtC,OACE,wBACEsC,UAAU,4CADZ,SAGE,sBAAKA,UAAU,MAAML,MAAO,CAAE6D,MAAO,OAAQgV,aAAc,OAA3D,UACE,qBAAKxY,UAAU,UACf,qBAAKA,UAAU,oBAAf,SACE,mBAAGD,KAAK,IAAR,SACE,qBACEuB,IAAI,UACJC,IACEC,2BAIF7B,MAAO,CAAE8B,OAAQ,cAIvB,sBACEzB,UAAU,QACVL,MAAO,CAAEkV,YAAa,MAAO2D,aAAc,OAF7C,UAIGtZ,GAAsB,KAAbxB,GAAmB,cAACgC,EAAD,IAC5BR,GAAsB,KAAbxB,GAAmB,cAACwC,EAAD,CAAYxC,SAAUA,YC7B9C,SAASue,GAAT,GAA4D,IAAjCC,EAAgC,EAAhCA,YACxC,OACE,qBAAKvc,MAAO,CAAEE,QAAS,QAAvB,SACE,sBAAKG,UAAU,2BAA2BQ,KAAK,QAA/C,UACE,+BACE,mBAAGR,UAAU,oBAAoBC,cAAY,SAD/C,yBAEU,OAHZ,qEAKqE,IAClEic,EANH,yQAUM,IACJ,mBAAGnc,KAAK,4BAA4B8K,OAAO,SAASwO,IAAI,aAAxD,qBAXF,IAeE,uBACA,uBACA,uBACA,oBAAGtZ,KAAK,IAAR,UACE,mBAAGC,UAAU,aAAaC,cAAY,SADxC,wBCZOub,oBAAW,WACxB,IAAMrb,EAAWC,cAD8B,EAETwJ,mBAAS,IAFA,mBAExCuS,EAFwC,KAE3BC,EAF2B,OAGPxS,mBAAS,IAHF,mBAGxCyS,EAHwC,KAG1BC,EAH0B,OAIP1S,mBAAS,IAJF,mBAIxC2S,EAJwC,KAI1BC,EAJ0B,KAKzCtd,EAAQ8S,YAAY1S,GACpBL,EAAgB+S,YAAYxS,GAC5B9B,EAAWsU,YAAYlT,GACvBnB,EAAOqU,YAAYjT,GAUzB,OARAqK,SAAS6J,KAAKtT,MAAMkN,gBAAkB,QAEtC/C,qBAAU,WACJ5K,GACFiB,EpC0FJ,uCACE,WAAOA,GAAP,iBAAAW,EAAA,+EAG2BpE,IAAMO,IADjB,sBAFhB,gBAGYK,EAHZ,EAGYA,KACR6C,EAASzB,EAAYpB,IAJzB,gDAMI8J,QAAQ2K,IAAR,mDANJ,yDADF,yDoCxFG,CAAC5R,EAAUjB,EAAOD,IAGnB,sBAAKe,UAAU,MAAf,UACE,cAAC,GAAD,CAAYd,MAAOA,EAAOxB,SAAUA,KAElCwB,IAAUD,GACV,cAACgd,GAAD,CAAiBC,YAAa,iBAE/Bhd,GACC,qBAAKc,UAAU,YAAf,SACE,sBAAKA,UAAU,UAAUL,MAAO,CAAE6D,MAAO,SAAzC,UACE,sBAAKxD,UAAU,MAAML,MAAO,CAAE8c,UAAW,QAAzC,UACE,+BACE,mBAAGzc,UAAU,aAAaC,cAAY,SADxC,cAGA,iCACE,sBAAKD,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,sBACA,uBACEA,UAAU,eACVuE,MAAO5G,EAAKD,SACZgM,UAAQ,OAGZ,sBAAK1J,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,wBACA,uBACEA,UAAU,eACVuE,MAAO5G,EAAKE,WACZ6L,UAAQ,OAGZ,sBAAK1J,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,uBACA,uBACEA,UAAU,eACVuE,MAAO5G,EAAKG,UACZ4L,UAAQ,OAIZ,sBAAK1J,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,2BACA,uBAAOA,UAAU,eAAeuE,MAAO5G,EAAKI,MAAO2L,UAAQ,aAIjE,uBACA,sBAAK1J,UAAU,MAAf,UACE,+BACE,mBAAGA,UAAU,YAAYC,cAAY,SADvC,sBAGA,gCACE,sBAAKD,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,0BACA,uBACE+J,KAAK,WACL/J,UAAU,eACVuE,MAAO4X,EACPnS,SAAU,SAACY,GAAD,OAAOwR,EAAexR,EAAEC,OAAOtG,aAG7C,sBAAKvE,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,0BACA,uBACE+J,KAAK,WACL/J,UAAU,eACVuE,MAAO8X,EACPrS,SAAU,SAACY,GAAD,OAAO0R,EAAgB1R,EAAEC,OAAOtG,aAG9C,sBAAKvE,UAAU,OAAf,UACE,uBAAOA,UAAU,aAAjB,iCACA,uBACE+J,KAAK,WACL/J,UAAU,eACVuE,MAAOgY,EACPvS,SAAU,SAACY,GAAD,OAAO4R,EAAgB5R,EAAEC,OAAOtG,aAG9C,qBAAKvE,UAAU,OAAOL,MAAO,CAACwZ,cAAe,QAA7C,SACE,wBACEnZ,UAAU,kBACVa,QAAS,kBACPV,EpCgBpB,SAACgc,EAAqBE,EAAsBE,GAA5C,8CACE,WAAOpc,GAAP,SAAAW,EAAA,+EAGUpE,IAAMqE,KADA,gCACU,CAAE2b,aAAcP,EAAaQ,cAAeN,EAAcO,cAAeL,IAHnG,OAIIvb,IAAMC,QAAQ,iCAJlB,gDAMID,IAAMG,MAAM,yDANhB,yDADF,sDoCfsB0b,CAAeV,EAAaE,EAAcE,KAG9C7S,SACkB,KAAhByS,GACiB,KAAjBE,GACiB,KAAjBE,EAVJ,0CAqBZ,cAACX,GAAD,UCjHSJ,gBAAW,WACxB,IAAMrb,EAAWC,cACXuD,EAAYqO,YAAY7L,IACxBvC,EAAeoO,YAAY5L,IAC3BjH,EAAU6S,YAAYvS,GACtBP,EAAQ8S,YAAY1S,GACpB5B,EAAWsU,YAAYlT,GACvBrC,EAAQuV,YAAYpT,GAE1BkL,qBAAU,WACR3J,E7B0R0B,uCAAM,WAAOA,GAAP,mBAAAW,EAAA,sEAEhCX,EAAS4E,GAAc,KACvB5E,EAASuE,GAAgB,YACzBvE,EAAS6G,MAJuB,SAMTtK,IAAMO,IADjB,sBALoB,gBAMxBK,EANwB,EAMxBA,KACFwf,EAAkBxf,EAAKsQ,KAAI,SAACiL,GAChC,IAAM5R,EAAeC,KAAKC,MAAM0R,EAASvT,QAEzC,OAAO,2BACFuT,GADL,IAEEvT,OAAQ2B,OAGZ9G,EAASsE,GAAaqY,IACtB3c,EAASuE,GAAgB,WAhBO,kDAkBhCvE,EAASuE,GAAgB,UACzB0C,QAAQjG,MAAR,0DAnBgC,0DAAN,uD6BzR1BhB,EpCoCF,uCACE,WAAOA,GAAP,iBAAAW,EAAA,+EAI2BpE,IAAMO,IADjB,oBAHhB,gBAIYK,EAJZ,EAIYA,KACR6C,EAASd,EAAW/B,EAAKmc,MAL7B,gDAOIrS,QAAQ2K,IAAR,iEAPJ,yDADF,yDoCjCG,CAAC5R,EAAU1D,IAEd,IAAMsgB,EAAe,SAACC,EAAqBC,GACzC,OAAa,OAATD,QAA0BjZ,IAATiZ,EACZA,EAAKE,MAAM,EAAGD,IAAUD,EAAKvR,OAASwR,EAAQ,OAAS,IAEzD,IAGHE,EAAgBxZ,EAAUiK,KAAI,SAACiL,EAAUlM,GAC7C,OACE,qBACE3M,UAAU,WACVL,MAAO,CAAEwZ,cAAe,QAF1B,SAKE,sBAAKnZ,UAAU,OAAf,UACE,qBACEL,MAAO,CACL8B,OAAQ,QACR+B,MAAO,OACP3D,QAAS,MACTud,SAAU,UALd,SAQE,wBACEpd,UAAU,kBACVwD,MAAM,OACN/B,OAAQ,IACRF,IAAG,UAAK7E,IAAMC,SAASyS,SAApB,OAA8ByJ,EAASiC,mBAC1C7U,MAAM,UACNoX,UAAU,SAGd,mBACEtd,KAAI,eAAU8Y,EAASpY,IACvBd,MAAO,CAAEqc,eAAgB,OAAQpc,MAAO,SACxCI,UAAU,aAHZ,SAKE,sBACEA,UAAU,YACVL,MAAO,CACLoc,UAAW,4BACXta,OAAQ,SAJZ,UAOE,oBAAIzB,UAAU,aAAd,SAA4B+c,EAAalE,EAAS5S,MAAO,MAEzD,mBAAGjG,UAAU,YAAb,SACG+c,EAAalE,EAASvT,OAAOgY,YAAa,gBAtCrD,mBAGmBzE,EAASpY,GAH5B,SAqDJ,OAFA2I,SAAS6J,KAAKtT,MAAMkN,gBAAkB,QAGpC,sBAAK7M,UAAU,MAAf,UACE,cAAC,GAAD,CAAYd,MAAOA,EAAOxB,SAAUA,IACpC,sBAAKsC,UAAU,YAAYL,MAAO,CAAEwZ,cAAe,QAAnD,UACe,KAAZha,GACC,oBAAIQ,MAAO,CAAEE,QAAS,OAAQ0d,UAAW,UAAzC,sBAEW,KAAZpe,GACC,qBAAKQ,MAAO,CAAE+L,WAAY,OAAQyN,cAAe,QAAjD,SACE,cAAC,KAAD,CACE7I,cAAe,CAACC,KAAWC,KAAiBC,KAAOC,MADrD,SAGGvR,MAKP,sBAAKa,UAAU,MAAf,UACoB,YAAjB4D,GACC,mEAGgB,WAAjBA,GAA6B1E,GAA8B,IAArByE,EAAU8H,QAC/C,8BACE,sBAAKzL,UAAU,sBAAsBQ,KAAK,QAA1C,UACE,+BACE,mBAAGR,UAAU,YAAYC,cAAY,SADvC,gCAIA,qIAKA,oBAAGF,KAAK,SAASC,UAAU,0BAA3B,UACE,mBAAGA,UAAU,gBAAgBC,cAAY,SAD3C,kBAMY,WAAjB2D,GAAkD,IAArBD,EAAU8H,QACtC,gCACE,yGAKA,2GAIA,qBAAKzL,UAAU,sBAAsBQ,KAAK,QAA1C,SACE,sBAAKb,MAAO,CAAEY,OAAQ,OAAtB,2BACiB,0BAInB,gFACA,qBAAKP,UAAU,sBAAsBQ,KAAK,QAA1C,SACE,sBAAKb,MAAO,CAAEY,OAAQ,OAAtB,yBACe,6BAKH,UAAjBqD,GACC,0HAKDuZ,QAGL,cAACvB,GAAD,UClKSJ,gBAAW,WACxB,IAAInb,EAAUC,cACRH,EAAWC,cAF4B,EAGbwJ,mBAAS,IAHI,mBAGtClM,EAHsC,KAG5Be,EAH4B,OAIbmL,mBAAS,IAJI,mBAItC4T,EAJsC,KAI5BC,EAJ4B,KAKvCve,EAAQ8S,YAAY1S,GACpBL,EAAgB+S,YAAYxS,GAIlC,OAFA4J,SAAS6J,KAAKtT,MAAMkN,gBAAkB,UAGpC,sBAAK7M,UAAU,MAAf,UACE,cAAC,GAAD,CAAYd,MAAOA,EAAOxB,SAAU,MAElCwB,IAAUD,GACV,cAACgd,GAAD,CAAiBC,YAAa,mBAE/Bhd,GACC,sBAAKc,UAAU,yBAAf,UACE,uBACEA,UAAU,cACV0d,SAAU,SAAC9S,GACTA,EAAEI,iBACFJ,EAAE+S,kBACFxd,EtC8CZ,SAACzC,EAAkB8f,EAAkBnd,GAArC,8CACE,WAAOF,GAAP,6BAAAW,EAAA,+EAG2BpE,IAAMqE,KADjB,sBAC2B,CAAErD,WAAU8f,aAHvD,gBAGYlgB,EAHZ,EAGYA,KACR6C,EAAS/B,EAASd,EAAKgH,MACvBnE,EAAS1B,EAAYf,IACrBsD,IAAMC,QAAQ,sBAEdZ,EAAQa,KAAK,KARjB,kDAUU0c,EAVV,KAWQnE,EAAM,uCACmC1V,KAAzC,UAAA6Z,EAAI7K,gBAAJ,mBAAczV,YAAd,eAAoBugB,oBACtBpE,GAAG,UAAImE,EAAI7K,gBAAR,iBAAI,EAAczV,YAAlB,aAAI,EAAoBugB,kBAE7B7c,IAAMG,MAAMsY,GAfhB,0DADF,sDsC9CqBqE,CAAWpgB,EAAU8f,EAAUnd,KAL5C,UAQE,oBAAIL,UAAU,6BAAd,4BACA,uBAAOA,UAAU,UAAjB,sBACA,uBACE+J,KAAK,WACLtJ,GAAG,gBACHT,UAAU,eACV+d,YAAY,WACZxZ,MAAO7G,EACPsM,SAAU,SAACY,GACTnM,EAAYmM,EAAEC,OAAOtG,QAEvByZ,UAAQ,IAEV,uBAAOhe,UAAU,UAAjB,sBACA,uBACE+J,KAAK,WACLtJ,GAAG,gBACHT,UAAU,eACV+d,YAAY,WACZxZ,MAAOiZ,EACPxT,SAAU,SAACY,GACT6S,EAAY7S,EAAEC,OAAOtG,QAEvByZ,UAAQ,IAEV,yBACEhe,UAAU,mCACV+J,KAAK,SACLpK,MAAO,CAAEY,OAAQ,OACjBmJ,SAAuB,KAAbhM,GAAgC,KAAb8f,EAJ/B,UAME,mBAAGxd,UAAU,gBAAgBC,cAAY,SAN3C,gBASF,qBACED,UAAU,UACVL,MAAO,CAAE6D,MAAO,QAASiZ,UAAW,QAFtC,SAIE,mBAAGzc,UAAU,aAAb,sGAON,cAAC4b,GAAD,UCnEN,SAASL,GAAIvP,GAAe,IAClBC,EAAaD,EAAbC,SACR,OAAO,mCAAGA,IAGG,SAASgS,KACtB,IAAM9d,EAAWC,cAejB,OAbA0J,qBAAU,WACR5N,IACAiE,EtCoBF,uCACE,WAAOA,GAAP,mBAAAW,EAAA,+EAI2BpE,IAAMO,IADjB,oBAHhB,gBAIYK,EAJZ,EAIYA,KACR6C,EAASf,EAAW9B,IALxB,gDAOI8J,QAAQ2K,IAAR,yDACIrV,IAAMwhB,aAAN,OAC6B,OAA3B,eAAMnL,gBAAN,eAAgBoL,UAElBhe,EAAS/B,EAAS,OAClB+B,EAAS1B,EAAY,OACrB8E,OAAOiG,SAAS4U,UAbxB,yDADF,uDsCnBM5gB,aAAanB,QAAQ,UACvB8D,EAAS/B,EAASZ,aAAanB,QAAQ,WAErCmB,aAAanB,QAAQ,aACvB8D,EAAS1B,EAAYjB,aAAanB,QAAQ,gBAI3C,IAGD,cAAC,IAAD,UACE,cAAC,GAAD,UACE,eAAC,IAAD,WACE,cAAC,IAAD,CAAOgiB,OAAK,EAACC,KAAK,IAAIC,UAAWC,KACjC,cAAC,IAAD,CACEH,OAAK,EACLC,KAAK,4BACLC,UAAWE,KAEb,cAAC,IAAD,CAAOJ,OAAK,EAACC,KAAK,SAASC,UAAWG,KACtC,cAAC,IAAD,CAAOL,OAAK,EAACC,KAAK,WAAWC,UAAWI,YCtClD,IAMeC,GANF,SAAC,GAAD,IAAGC,EAAH,EAAGA,MAAH,EAAUxe,QAAV,OACX,cAAC,IAAD,CAAUwe,MAAOA,EAAjB,SACE,cAACZ,GAAD,O,4BCLG,IAMyBxgB,GANnB4C,GAAUye,eACjBC,GCIKC,aAAgB,CACnBrb,UAAWsb,GACXvW,MAAOwW,GAEP3f,QAAS4f,EACT7c,IAAK8c,EACLvgB,KAAMwgB,EACN/N,GAAIgO,KDRNC,GAAU,aAAOC,eEKjBX,I,wDFDUY,YAAe,CAC3BC,QAASX,GACTQ,cACAI,eAAgBliB,MEAW,0BAA3B8F,OAAOiG,SAASwL,OAClBtY,IAAMC,SAASyS,QAAU,wBAEzB1S,IAAMC,SAASyS,QAAU7L,OAAOiG,SAASwL,OAEvCzR,OAAOiG,SAASwL,OAAOpQ,WAAW,sBACpClI,IAAMC,SAASyS,QAAU7L,OAAOiG,SAASzJ,MAI3CrD,IAAMC,SAASyS,QAAU1S,IAAMC,SAASyS,QAAQiH,MAAM,KAAK,GAC3D3Z,IAAMC,SAASyS,QAAU1S,IAAMC,SAASyS,QAAQiH,MAAM,KAAK,GAC3D3Z,IAAMC,SAASyS,QAAU1S,IAAMC,SAASyS,QAAQiH,MAAM,KAAK,GAG3DjN,SAAS0O,iBAAiB,oBAAoB,kBAC5C8H,iBACE,gCACE,cAAC,GAAD,CAAMf,MAAOA,GAAOxe,QAASA,KAC7B,cAAC,IAAD,CACE4K,SAAS,YACToP,UAAW,IACXwF,iBAAiB,EACjBC,aAAa,EACbC,cAAY,EACZC,cAAY,OAGhB5W,SAASC,eAAe,c","file":"static/js/main.141347ae.chunk.js","sourcesContent":["import { v4 as uuidv4 } from 'uuid';\r\nimport axios from \"axios\";\r\nimport fileDownload from \"js-file-download\";\r\n\r\nexport const getSessionId = () => {\r\n    var sessionId = sessionStorage.getItem(\"sessionId\");\r\n    if (sessionId == null) {\r\n        sessionId = uuidv4();\r\n        sessionStorage.setItem(\"sessionId\", sessionId);\r\n    }\r\n    return sessionId;\r\n}\r\n\r\nexport const setAxiosAuthToken = (token: string | null) => {\r\n    if (typeof token !== \"undefined\" && token) {\r\n        // Apply for every request\r\n        axios.defaults.headers.common[\"Authorization\"] = \"Token \" + token;\r\n    } else {\r\n        // Delete auth header\r\n        delete axios.defaults.headers.common[\"Authorization\"];\r\n    }\r\n};\r\n\r\nexport const handleDownload = (url: string, filename: string) => {\r\n    axios\r\n        .get(url, {\r\n            responseType: \"blob\",\r\n        })\r\n        .then((res) => {\r\n            fileDownload(res.data, filename);\r\n        });\r\n};","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from '@reduxjs/toolkit';\r\nimport axios, { AxiosError } from 'axios';\r\nimport { toast } from 'react-toastify';\r\n\r\nimport { RootState } from '../store';\r\nimport { setAxiosAuthToken } from '../utils';\r\n\r\nlet initToken = null;\r\nif (localStorage.getItem(\"token\")) {\r\n  initToken = localStorage.getItem(\"token\");\r\n  setAxiosAuthToken(initToken);\r\n}\r\n\r\ntype UserType = {\r\n  pk: number;\r\n  username: string;\r\n  first_name: string;\r\n  last_name: string;\r\n  email: string;\r\n}\r\n\r\nconst initialState = {\r\n  token: initToken as string | null,\r\n  username: \"\" as string,\r\n  user: {\r\n    pk: 0,\r\n    username: \"\",\r\n    first_name: \"\",\r\n    last_name: \"\",\r\n    email: \"\"\r\n  } as UserType,\r\n};\r\n\r\nconst authSlice = createSlice({\r\n  name: 'auth',\r\n  initialState,\r\n  reducers: {\r\n    setToken(state, action: PayloadAction<string | null>) {\r\n      state.token = action.payload;\r\n      setAxiosAuthToken(state.token);\r\n      if (state.token) {\r\n        localStorage.setItem(\"token\", state.token);\r\n      } else {\r\n        localStorage.removeItem(\"token\")\r\n      }\r\n    },\r\n    setUsername(state, action: PayloadAction<string | null>) {\r\n      state.username = action.payload ? action.payload : \"\";\r\n      if (state.username && state.username !== \"\") {\r\n        localStorage.setItem(\"username\", state.username);\r\n      } else {\r\n        localStorage.removeItem(\"username\");\r\n      }\r\n    },\r\n    setUserInfo(state, action: PayloadAction<UserType>) {\r\n      state.user = action.payload;\r\n    }\r\n\r\n  },\r\n});\r\n\r\nexport default authSlice.reducer;\r\n\r\nexport const {\r\n  setToken,\r\n  setUsername,\r\n  setUserInfo,\r\n} = authSlice.actions;\r\n\r\nexport const getToken = (state: RootState) => state.auth.token;\r\nexport const getUsername = (state: RootState) => state.auth.username;\r\nexport const getUserInfo = (state: RootState) => state.auth.user;\r\n\r\n\r\nexport const fetchToken =\r\n  (username: string, password: string, history: any) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = '/api/v1/auth/login/';\r\n        const { data } = await axios.post(url, { username, password });\r\n        dispatch(setToken(data.key));\r\n        dispatch(setUsername(username));\r\n        toast.success(\"Log in successfull\")\r\n        // redirect ...\r\n        history.push(\"/\");\r\n      } catch (error) {\r\n        const err = error as AxiosError\r\n        let msg = \"Problem during authentication. \"\r\n        if (err.response?.data?.non_field_errors !== undefined) {\r\n          msg += err.response?.data?.non_field_errors;\r\n        }\r\n        toast.error(msg)\r\n      }\r\n    };\r\n\r\n\r\nexport const logout =\r\n  (history: any) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = '/api/v1/auth/logout/';\r\n        await axios.post(url);\r\n        toast.success(\"Log out successfull\");\r\n        dispatch(setToken(\"\"));\r\n        dispatch(setUsername(\"\"));\r\n        history.push(\"/\");\r\n      } catch (error) {\r\n        toast.error(\"Problem during log out\")\r\n      }\r\n    };\r\n\r\n\r\nexport const fetchUserInfo =\r\n  () =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = '/api/v1/auth/user/';\r\n        const { data } = await axios.get(url);\r\n        dispatch(setUserInfo(data));\r\n      } catch (error) {\r\n        console.log(`Problem during getting user info. ${error}`)\r\n      }\r\n    };\r\n\r\n\r\nexport const changePassword =\r\n  (oldPassword: string, newPassword1: string, newPassword2: string) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        const url = '/api/v1/auth/password/change/';\r\n        await axios.post(url, { old_password: oldPassword, new_password1: newPassword1, new_password2: newPassword2 });\r\n        toast.success(\"Password changed successfully\")\r\n      } catch (error) {\r\n        toast.error(\"Password not changed. Problem during password change.\")\r\n      }\r\n    };","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nimport { RootState } from '../store';\r\nimport { setToken, setUsername } from './authSlice';\r\n\r\n\r\nconst initialState = {\r\n  fetchingIsPro: true,\r\n  isPro: false,\r\n  welcome: \"\"\r\n};\r\n\r\nconst versionSlice = createSlice({\r\n  name: 'version',\r\n  initialState,\r\n  reducers: {\r\n    setVersion(state, action: PayloadAction<{ isPro: boolean }>) {\r\n      const { isPro } = action.payload;\r\n      state.isPro = isPro;\r\n      state.fetchingIsPro = false;\r\n    },\r\n    setWelcome(state, action: PayloadAction<string>) {\r\n      state.welcome = action.payload;\r\n    }\r\n  },\r\n});\r\n\r\nexport default versionSlice.reducer;\r\n\r\nexport const {\r\n  setVersion,\r\n  setWelcome,\r\n} = versionSlice.actions;\r\n\r\nexport const getIsPro = (state: RootState) => state.version.isPro;\r\nexport const getFetchingIsPro = (state: RootState) => state.version.fetchingIsPro;\r\nexport const getWelcome = (state: RootState) => state.version.welcome;\r\n\r\nexport const fetchVersion =\r\n  () =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n      try {\r\n        const url = '/api/v1/version/';\r\n        const { data } = await axios.get(url);\r\n        dispatch(setVersion(data));\r\n      } catch (error) {\r\n        console.log(`Problem during loading Mercury version. ${error}`);\r\n        if (axios.isAxiosError(error)) {\r\n          if (error.response?.status === 401) {\r\n            // clear auth data \r\n            dispatch(setToken(null));\r\n            dispatch(setUsername(null));\r\n            window.location.reload();\r\n          }\r\n        }\r\n      }\r\n    };\r\n\r\n\r\nexport const fetchWelcome =\r\n  () =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n      try {\r\n        const url = '/api/v1/welcome/';\r\n        const { data } = await axios.get(url);\r\n        dispatch(setWelcome(data.msg));\r\n      } catch (error) {\r\n        console.log(`Problem during loading Mercury welcome message. ${error}`);\r\n      }\r\n\r\n    };\r\n\r\n","import React from \"react\";\n\nexport default function LoginButton() {\n  return (\n    <div style={{ color: \"white\", padding: \"5px\", float: \"right\" }}>\n      <a href=\"/login\" className=\"btn btn-primary btn-sm \">\n        <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n      </a>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { useHistory } from \"react-router-dom\";\nimport { logout } from \"./authSlice\";\n\ntype UserButtonProps = {\n  username: string;\n};\n\nexport default function UserButton({ username }: UserButtonProps) {\n  const dispatch = useDispatch();\n  const history = useHistory();\n  return (\n    <div>\n      <div className=\"dropdown\" style={{ float: \"right\" }}>\n        <a\n          className=\"btn btn-secondary btn-sm dropdown-toggle\"\n          style={{ margin: \"5px\" }}\n          href=\"#\"\n          role=\"button\"\n          id=\"dropdownMenuLink\"\n          data-bs-toggle=\"dropdown\"\n          aria-expanded=\"false\"\n        >\n          {username}\n        </a>\n\n        <ul\n          className=\"dropdown-menu dropdown-menu-end\"\n          aria-labelledby=\"dropdownMenuLink\"\n        >\n          <li>\n            <a className=\"dropdown-item\" href=\"/account\">\n              <i className=\"fa fa-user\" aria-hidden=\"true\"></i> Account\n            </a>\n          </li>\n          <li>\n            <hr className=\"dropdown-divider\" />\n          </li>\n          <li>\n            <a\n              className=\"dropdown-item\"\n              onClick={() => dispatch(logout(history))}\n            >\n              <i className=\"fa fa-sign-out\" aria-hidden=\"true\"></i> Log out\n            </a>\n          </li>\n        </ul>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport LoginButton from \"./LoginButton\";\nimport UserButton from \"./UserButton\";\n\ntype NavBarProps = {\n  isPro: boolean;\n  username: string;\n};\n\nexport default function NavBar({ isPro, username }: NavBarProps) {\n  return (\n    <header className=\"navbar navbar-dark sticky-top bg-dark flex-md-nowrap p-0\">\n      <a className=\"navbar-brand col-md-3 col-lg-3 me-0 px-3\" href=\"/\">\n        {/* <i className=\"fa fa-home\" aria-hidden=\"true\"></i> {\" \"} */}\n        <img\n          alt=\"Mercury\"\n          src={\n            process.env.PUBLIC_URL +\n            process.env.REACT_APP_LOCAL_URL +\n            \"/mercury_logo.svg\"\n          }\n          style={{ height: \"28px\", paddingLeft: \"10px\" }} // height was 24px\n        />\n      </a>\n\n      {isPro && username === \"\" && <LoginButton />}\n      {isPro && username !== \"\" && <UserButton username={username} />}\n    </header>\n  );\n}\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\n\r\nimport { RootState } from '../store';\r\nimport { getSessionId } from '../utils';\r\n\r\n\r\nconst initialState = {\r\n  view: \"app\",\r\n  files: [] as string[],\r\n  filesState: \"unknown\",\r\n  showSideBar: true,\r\n};\r\n\r\nconst appSlice = createSlice({\r\n  name: 'app',\r\n  initialState,\r\n  reducers: {\r\n    setView(state, action: PayloadAction<string>) {\r\n      state.view = action.payload;\r\n    },\r\n    setFilesState(state, action: PayloadAction<string>) {\r\n      state.filesState = action.payload;\r\n    },\r\n    setFiles(state, action: PayloadAction<string[]>) {\r\n      state.files = action.payload;\r\n    },\r\n    setShowSideBar(state, action: PayloadAction<boolean>) {\r\n      state.showSideBar = action.payload;\r\n    },\r\n    toggleShowSideBar(state) {\r\n      state.showSideBar = !state.showSideBar;\r\n    },\r\n  },\r\n});\r\n\r\nexport default appSlice.reducer;\r\n\r\nexport const {\r\n  setView,\r\n  setFilesState,\r\n  setFiles,\r\n  setShowSideBar,\r\n  toggleShowSideBar,\r\n} = appSlice.actions;\r\n\r\nexport const getView = (state: RootState) => state.app.view;\r\nexport const getOutputFilesState = (state: RootState) => state.app.filesState;\r\nexport const getOutputFiles = (state: RootState) => state.app.files;\r\nexport const getShowSideBar = (state: RootState) => state.app.showSideBar;\r\n\r\nexport const fetchOutputFiles =\r\n  (taskId: number) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        dispatch(setFilesState(\"loading\"))\r\n        dispatch(setFiles([]));\r\n        const sessionId = getSessionId();\r\n        const url = `/api/v1/output_files/${sessionId}/${taskId}`;\r\n        const { data } = await axios.get(url);\r\n        dispatch(setFiles(data));\r\n        dispatch(setFilesState(\"loaded\"))\r\n      } catch (error) {\r\n        dispatch(setFilesState(\"error\"))\r\n        console.error(`Problem during loading output files. ${error}`);\r\n      }\r\n\r\n    };\r\n\r\nexport const fetchWorkerOutputFiles =\r\n  (workerId: number) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        dispatch(setFilesState(\"loading\"))\r\n        dispatch(setFiles([]));\r\n        const sessionId = getSessionId();\r\n        const url = `/api/v1/worker_output_files/${sessionId}/${workerId}`;\r\n        const { data } = await axios.get(url);\r\n        dispatch(setFiles(data));\r\n        dispatch(setFilesState(\"loaded\"))\r\n      } catch (error) {\r\n        dispatch(setFilesState(\"error\"))\r\n        console.error(`Problem during loading worker output files. ${error}`);\r\n      }\r\n\r\n    };\r\n","export interface ISelectWidget {\n  label: string | null;\n  value: string | null;\n  input: string;\n  choices: string[];\n  multi: boolean | undefined;\n}\n\nexport interface ICheckboxWidget {\n  label: string | null;\n  value: boolean | null;\n  input: string;\n}\n\nexport interface INumericWidget {\n  label: string | null;\n  value: number | null;\n  input: string;\n  min: number;\n  max: number;\n  step: number;\n}\n\nexport interface ISliderWidget {\n  vertical: boolean | null;\n  label: string | null;\n  value: number | null;\n  input: string;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n}\n\nexport interface IRangeWidget {\n  vertical: boolean | null;\n  label: string | null;\n  value: [number, number] | null;\n  input: string;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n}\n\nexport interface IFileWidget {\n  label: string | null;\n  value: string | null;\n  input: string;\n  maxFileSize: string | null;\n}\n\nexport interface ITextWidget {\n  label: string | null;\n  value: string | undefined;\n  input: string;\n  rows: number | null;\n}\n\nexport interface IOutputFilesWidget {\n  output: string;\n  input: null;\n  value: null;\n}\n\nexport interface IMarkdownWidget {\n  output: string;\n  input: null;  // we need to add input to be IWidget\n  value: string;\n}\n\nexport interface IButtonWidget {\n  label: string | null;\n  style: string;\n  input: string;\n  value: string | boolean | null;\n}\n\n\nexport type IWidget =\n  | ISelectWidget\n  | ICheckboxWidget\n  | INumericWidget\n  | ISliderWidget\n  | IRangeWidget\n  | IFileWidget\n  | ITextWidget\n  | IOutputFilesWidget\n  | IMarkdownWidget\n  | IButtonWidget;\n\nexport function isSelectWidget(widget: IWidget): widget is ISelectWidget {\n  return (widget as ISelectWidget).input === \"select\";\n}\n\nexport function isCheckboxWidget(widget: IWidget): widget is ICheckboxWidget {\n  return (widget as ICheckboxWidget).input === \"checkbox\";\n}\n\nexport function isNumericWidget(widget: IWidget): widget is INumericWidget {\n  return (widget as INumericWidget).input === \"numeric\";\n}\n\nexport function isSliderWidget(widget: IWidget): widget is ISliderWidget {\n  return (widget as ISliderWidget).input === \"slider\";\n}\n\nexport function isRangeWidget(widget: IWidget): widget is IRangeWidget {\n  return (widget as IRangeWidget).input === \"range\";\n}\n\nexport function isFileWidget(widget: IWidget): widget is IFileWidget {\n  return (widget as IFileWidget).input === \"file\";\n}\n\nexport function isTextWidget(widget: IWidget): widget is ITextWidget {\n  return (widget as ITextWidget).input === \"text\";\n}\n\nexport function isOutputFilesWidget(widget: IWidget): widget is IOutputFilesWidget {\n  return (widget as IOutputFilesWidget).output === \"dir\";\n}\n\nexport function isMarkdownWidget(widget: IWidget): widget is IMarkdownWidget {\n  return (widget as IMarkdownWidget).output === \"markdown\";\n}\n\nexport function isButtonWidget(widget: IWidget): widget is IButtonWidget {\n  return (widget as IButtonWidget).input === \"button\";\n}\n","// code from https://stackoverflow.com/questions/36862334/get-viewport-window-height-in-reactjs\nimport { useState, useEffect } from \"react\";\n\nexport function getWindowDimensions() {\n  const { innerWidth: width, innerHeight: height } = window;\n  return {\n    width,\n    height,\n  };\n}\n\nexport default function useWindowDimensions() {\n  const [windowDimensions, setWindowDimensions] = useState(\n    getWindowDimensions()\n  );\n\n  useEffect(() => {\n    function handleResize() {\n      setWindowDimensions(getWindowDimensions());\n    }\n\n    window.addEventListener(\"resize\", handleResize);\n    return () => window.removeEventListener(\"resize\", handleResize);\n  }, []);\n\n  return windowDimensions;\n}\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n  createSlice,\r\n  PayloadAction,\r\n  AnyAction,\r\n  Dispatch,\r\n} from \"@reduxjs/toolkit\";\r\nimport axios from \"axios\";\r\n\r\nimport { RootState } from \"../../store\";\r\nimport { clearExecutionHistory } from \"../../tasks/tasksSlice\";\r\nimport { setShowSideBar } from \"../../views/appSlice\";\r\nimport {\r\n  IWidget,\r\n  isSelectWidget,\r\n  isSliderWidget,\r\n  isTextWidget,\r\n  isRangeWidget,\r\n  isCheckboxWidget,\r\n  isNumericWidget,\r\n  isMarkdownWidget,\r\n  isButtonWidget,\r\n} from \"../Widgets/Types\";\r\nimport { getWindowDimensions } from \"../WindowDimensions\";\r\n\r\nexport const RUN_DELAY = 600; // ms\r\nexport const RUN_DELAY_FAST = 100; // ms\r\n\r\nexport interface INotebookParams {\r\n  title: string | null;\r\n  description: string | null;\r\n  date: string | null;\r\n  author: string | null;\r\n  \"show-code\": boolean | null;\r\n  params: Record<string, IWidget>; //IWidget[];\r\n  version: string;\r\n  continuous_update: boolean;\r\n  static_notebook: boolean;\r\n}\r\n\r\nexport interface INotebook {\r\n  id: number;\r\n  created_at: Date;\r\n  file_updated_at: Date;\r\n  title: string;\r\n  slug: string;\r\n  path: string;\r\n  share: string;\r\n  params: INotebookParams;\r\n  state: string;\r\n  default_view_path: string;\r\n  output: string;\r\n  format: string;\r\n  slidesHash: string;\r\n  schedule: string;\r\n  errors: string;\r\n}\r\n\r\ntype WidgetValueType =\r\n  | string\r\n  | boolean\r\n  | number\r\n  | [number, number]\r\n  | string[]\r\n  | null\r\n  | undefined\r\n  | unknown;\r\n\r\nconst initialState = {\r\n  notebooks: [] as INotebook[],\r\n  loadingState: \"loading\",\r\n  selectedNotebook: {} as INotebook,\r\n  selectedNotebookId: undefined as undefined | number,\r\n  loadingStateSelected: \"loading\",\r\n  watchModeCounter: 0,\r\n  slidesHash: \"\",\r\n  widgets: {} as Record<string, WidgetValueType>,\r\n};\r\n\r\nconst notebooksSlice = createSlice({\r\n  name: \"notebooks\",\r\n  initialState,\r\n  reducers: {\r\n    setWidgetValue(\r\n      state,\r\n      action: PayloadAction<{ key: string; value: WidgetValueType }>\r\n    ) {\r\n      const { key, value } = action.payload;\r\n      state.widgets[key] = value;\r\n      //console.log({ key, value });\r\n    },\r\n    clearWidgets(state) {\r\n      state.widgets = {};\r\n    },\r\n    setNotebooks(state, action: PayloadAction<INotebook[]>) {\r\n      state.notebooks = action.payload;\r\n    },\r\n    setLoadingState(state, action: PayloadAction<string>) {\r\n      state.loadingState = action.payload;\r\n    },\r\n    setSelectedNotebook(state, action: PayloadAction<INotebook>) {\r\n      if (\r\n        action.payload.state.startsWith(\"WATCH\") &&\r\n        state.selectedNotebook.file_updated_at ===\r\n        action.payload.file_updated_at\r\n      ) {\r\n        // console.log(\"skip notebook update\")\r\n      } else {\r\n        state.selectedNotebook = action.payload;\r\n        state.selectedNotebookId = state.selectedNotebook.id;\r\n      }\r\n      if (action.payload.state.startsWith(\"WATCH\")) {\r\n        state.watchModeCounter += 1;\r\n      }\r\n    },\r\n    setLoadingStateSelected(state, action: PayloadAction<string>) {\r\n      state.loadingStateSelected = action.payload;\r\n    },\r\n    setSlidesHash(state, action: PayloadAction<string>) {\r\n      state.slidesHash = action.payload;\r\n    },\r\n    updateWidgetsParams(state, action: PayloadAction<any>) {\r\n      const { widgetKey } = action.payload;\r\n\r\n      let updated = false;\r\n\r\n      let noMatch = true;\r\n\r\n      for (let key of Object.keys(state.selectedNotebook.params.params)) {\r\n        if (key === widgetKey) {\r\n          noMatch = false;\r\n          let widget = { ...state.selectedNotebook.params.params[widgetKey] };\r\n\r\n          if (isRangeWidget(widget)) {\r\n            if (widget.min !== action.payload.min) {\r\n              widget.min = action.payload.min;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.max !== action.payload.max) {\r\n              widget.max = action.payload.max;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.step !== action.payload.step) {\r\n              widget.step = action.payload.step;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isTextWidget(widget)) {\r\n            if (widget.rows !== action.payload.rows) {\r\n              widget.rows = action.payload.rows;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isSliderWidget(widget)) {\r\n            if (widget.min !== action.payload.min) {\r\n              widget.min = action.payload.min;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.max !== action.payload.max) {\r\n              widget.max = action.payload.max;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.step !== action.payload.step) {\r\n              widget.step = action.payload.step;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isSelectWidget(widget)) {\r\n            if (\r\n              widget.choices.toString() !== action.payload.choices.toString()\r\n            ) {\r\n              widget.choices = action.payload.choices;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isCheckboxWidget(widget)) {\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isNumericWidget(widget)) {\r\n            if (widget.min !== action.payload.min) {\r\n              widget.min = action.payload.min;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.max !== action.payload.max) {\r\n              widget.max = action.payload.max;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.step !== action.payload.step) {\r\n              widget.step = action.payload.step;\r\n              state.widgets[key] = action.payload.value;\r\n              updated = true;\r\n            }\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n          } else if (isMarkdownWidget(widget)) {\r\n            if (widget.value !== action.payload.value) {\r\n              widget.value = action.payload.value;\r\n              updated = true;\r\n            }\r\n          } else if (isButtonWidget(widget)) {\r\n            state.widgets[key] = action.payload.value;\r\n\r\n            if (widget.label !== action.payload.label) {\r\n              widget.label = action.payload.label;\r\n              updated = true;\r\n            }\r\n            if (widget.style !== action.payload.style) {\r\n              widget.style = action.payload.style;\r\n              updated = true;\r\n            }\r\n          }\r\n\r\n          if (updated) {\r\n            state.selectedNotebook.params.params[widgetKey] = widget;\r\n          }\r\n        }\r\n      }\r\n      if (noMatch) {\r\n        state.selectedNotebook.params.params[widgetKey] = action.payload;\r\n      }\r\n    },\r\n    hideWidgets(state, action: PayloadAction<any>) {\r\n      const { keys } = action.payload;\r\n      for (let key of keys) {\r\n        if (key in state.selectedNotebook.params.params) {\r\n          delete state.selectedNotebook.params.params[key];\r\n        }\r\n      }\r\n    },\r\n    initWidgets(state, action: PayloadAction<any>) {\r\n      const { widgets } = action.payload;\r\n      state.selectedNotebook.params.params = {}\r\n      state.widgets = {}\r\n      for (let widget of widgets) {\r\n        // console.log(widget);\r\n        state.selectedNotebook.params.params[widget.widgetKey] = widget;\r\n        state.widgets[widget.widgetKey] = widget.value;\r\n\r\n      }\r\n    },\r\n    updateTitle(state, action: PayloadAction<string>) {\r\n      state.selectedNotebook.title = action.payload;\r\n    },\r\n    updateShowCode(state, action: PayloadAction<boolean>) {\r\n      state.selectedNotebook.params[\"show-code\"] = action.payload;\r\n    },\r\n  },\r\n});\r\n\r\nexport default notebooksSlice.reducer;\r\n\r\nexport const {\r\n  setNotebooks,\r\n  setLoadingState,\r\n  setSelectedNotebook,\r\n  setLoadingStateSelected,\r\n  setSlidesHash,\r\n  updateWidgetsParams,\r\n  hideWidgets,\r\n  setWidgetValue,\r\n  clearWidgets,\r\n  initWidgets,\r\n  updateTitle,\r\n  updateShowCode,\r\n} = notebooksSlice.actions;\r\n\r\nexport const getNotebooks = (state: RootState) => state.notebooks.notebooks;\r\nexport const getLoadingState = (state: RootState) =>\r\n  state.notebooks.loadingState;\r\nexport const getSelectedNotebook = (state: RootState) =>\r\n  state.notebooks.selectedNotebook;\r\nexport const getSelectedNotebookId = (state: RootState) =>\r\n  state.notebooks.selectedNotebookId;\r\nexport const isStaticNotebook = (state: RootState) => {\r\n  let st = state.notebooks.selectedNotebook?.params?.static_notebook;\r\n  if (st === undefined) {\r\n    return false;\r\n  }\r\n  return st;\r\n};\r\nexport const getLoadingStateSelected = (state: RootState) =>\r\n  state.notebooks.loadingStateSelected;\r\nexport const getWatchModeCounter = (state: RootState) =>\r\n  state.notebooks.watchModeCounter;\r\nexport const getSlidesHash = (state: RootState) => state.notebooks.slidesHash;\r\n\r\nexport const getWidgetsValues = (state: RootState) => state.notebooks.widgets;\r\n\r\nexport const fetchNotebooks = () => async (dispatch: Dispatch<AnyAction>) => {\r\n  try {\r\n    dispatch(setSlidesHash(\"\"));\r\n    dispatch(setLoadingState(\"loading\"));\r\n    dispatch(clearExecutionHistory());\r\n    const url = \"/api/v1/notebooks/\";\r\n    const { data } = await axios.get(url);\r\n    const parsedNotebooks = data.map((notebook: any) => {\r\n      const parsedParams = JSON.parse(notebook.params);\r\n\r\n      return {\r\n        ...notebook,\r\n        params: parsedParams as INotebookParams,\r\n      };\r\n    });\r\n    dispatch(setNotebooks(parsedNotebooks));\r\n    dispatch(setLoadingState(\"loaded\"));\r\n  } catch (error) {\r\n    dispatch(setLoadingState(\"error\"));\r\n    console.error(`Problem during loading recent notebooks. ${error}`);\r\n  }\r\n};\r\n\r\nexport const fetchNotebook =\r\n  (id: number, silent = false) =>\r\n    async (dispatch: Dispatch<AnyAction>) => {\r\n      try {\r\n        if (!silent) {\r\n          dispatch(setSlidesHash(\"\"));\r\n          dispatch(clearExecutionHistory());\r\n        }\r\n\r\n        const { width } = getWindowDimensions();\r\n        dispatch(setShowSideBar(width > 992));\r\n\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"loading\"));\r\n        }\r\n        const url = `/api/v1/notebooks/${id}/`;\r\n        const { data } = await axios.get(url);\r\n        const parsedParams = JSON.parse(data.params);\r\n        dispatch(\r\n          setSelectedNotebook({\r\n            ...data,\r\n            params: parsedParams as INotebookParams,\r\n          })\r\n        );\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"loaded\"));\r\n        }\r\n      } catch (error) {\r\n        if (!silent) {\r\n          dispatch(setLoadingStateSelected(\"error\"));\r\n        }\r\n        console.error(\r\n          `Problem during loading selected notebook (${id}). ${error}`\r\n        );\r\n      }\r\n    };\r\n","/* eslint-disable import/no-cycle */\r\nimport {\r\n    createSlice,\r\n    AnyAction,\r\n    Dispatch,\r\n    PayloadAction,\r\n} from '@reduxjs/toolkit';\r\nimport axios from 'axios';\r\nimport { RootState } from '../store';\r\nimport { toast } from \"react-toastify\";\r\nimport { getSessionId, handleDownload } from '../utils';\r\nimport { setSlidesHash } from '../components/Notebooks/notebooksSlice';\r\n\r\nexport interface ITask {\r\n    id: number;\r\n    task_id: string;\r\n    session_id: string;\r\n    created_at: Date;\r\n    state: \"CREATED\" | \"RECEIVED\" | \"DONE\" | \"ERROR\";\r\n    params: string;\r\n    result: string;\r\n}\r\n\r\nconst initialState = {\r\n    currentTask: {} as ITask,\r\n    historicTask: {} as ITask,\r\n    showCurrent: true,\r\n    previousTask: {} as ITask,\r\n    exportingToPDF: false,\r\n    exportToPDFJobId: '',\r\n    exportToPDFCounter: 0,\r\n    executionHistory: [] as ITask[],\r\n};\r\n\r\nconst tasksSlice = createSlice({\r\n    name: 'tasks',\r\n    initialState,\r\n    reducers: {\r\n        setShowCurrent(state, action: PayloadAction<boolean>) {\r\n            state.showCurrent = action.payload;\r\n        },\r\n        setCurrentTask(state, action: PayloadAction<ITask>) {\r\n            state.currentTask = action.payload;\r\n        },\r\n        setHistoricTask(state, action: PayloadAction<ITask>) {\r\n            state.historicTask = action.payload;\r\n        },\r\n        setPreviousTask(state, action: PayloadAction<ITask>) {\r\n            state.previousTask = action.payload;\r\n        },\r\n        copyCurrentToPreviousTask(state) {\r\n            state.previousTask = state.currentTask;\r\n        },\r\n        setExportingToPDF(state, action: PayloadAction<boolean>) {\r\n            state.exportingToPDF = action.payload;\r\n        },\r\n        setExportToPDFJobId(state, action: PayloadAction<string>) {\r\n            state.exportToPDFJobId = action.payload;\r\n        },\r\n        resetExportToPDFCounter(state) {\r\n            state.exportToPDFCounter = 0;\r\n        },\r\n        increaseExportToPDFCounter(state) {\r\n            state.exportToPDFCounter += 1;\r\n        },\r\n        stopPDFExport(state) {\r\n            state.exportingToPDF = false;\r\n            state.exportToPDFJobId = \"\";\r\n            state.exportToPDFCounter = 0;\r\n        },\r\n        setExecutionHistory(state, action: PayloadAction<ITask[]>) {\r\n            state.executionHistory = action.payload;\r\n        },\r\n        clearExecutionHistory(state) {\r\n            state.executionHistory = [];\r\n        }\r\n    },\r\n});\r\n\r\nexport default tasksSlice.reducer;\r\n\r\nexport const {\r\n    setShowCurrent,\r\n    setCurrentTask,\r\n    setHistoricTask,\r\n    setPreviousTask,\r\n    copyCurrentToPreviousTask,\r\n    setExportingToPDF,\r\n    setExportToPDFJobId,\r\n    resetExportToPDFCounter,\r\n    increaseExportToPDFCounter,\r\n    stopPDFExport,\r\n    setExecutionHistory,\r\n    clearExecutionHistory,\r\n} = tasksSlice.actions;\r\n\r\nexport const getShowCurrent = (state: RootState) => state.tasks.showCurrent;\r\nexport const getCurrentTask = (state: RootState) => state.tasks.currentTask;\r\nexport const getHistoricTask = (state: RootState) => state.tasks.historicTask;\r\nexport const getPreviousTask = (state: RootState) => state.tasks.previousTask;\r\nexport const getExportingToPDF = (state: RootState) => state.tasks.exportingToPDF;\r\nexport const getExportToPDFJobId = (state: RootState) => state.tasks.exportToPDFJobId;\r\nexport const getExportToPDFCounter = (state: RootState) => state.tasks.exportToPDFCounter;\r\nexport const getExecutionHistory = (state: RootState) => state.tasks.executionHistory;\r\n\r\nexport const fetchCurrentTask =\r\n    (notebookId: Number) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n            const sessionId = getSessionId();\r\n\r\n            try {\r\n                const url = `/api/v1/latest_task/${notebookId}/${sessionId}`;\r\n                const { data } = await axios.get(url);\r\n                dispatch(setCurrentTask(data))\r\n\r\n            } catch (error) {\r\n                // console.clear();\r\n                dispatch(setCurrentTask({} as ITask));\r\n            }\r\n\r\n        };\r\n\r\nexport const scrapeSlidesHash = () => {\r\n    try {\r\n        const iframeElement = (document.getElementById(\"main-iframe\") as HTMLIFrameElement);\r\n        const hash = iframeElement?.contentWindow?.location?.hash;\r\n        if (hash) {\r\n            return hash;\r\n        }\r\n    } catch (error) { }\r\n    return \"\";\r\n}\r\n\r\n\r\nexport const executeNotebook =\r\n    (notebookId: Number) =>\r\n        async (dispatch: Dispatch<AnyAction>, getState: () => any) => {\r\n            const { widgets } = getState().widgets;\r\n            const sessionId = getSessionId();\r\n\r\n            const slidesHash = scrapeSlidesHash();\r\n            dispatch(setSlidesHash(slidesHash));\r\n\r\n            try {\r\n                const task = {\r\n                    session_id: sessionId,\r\n                    params: JSON.stringify(widgets),\r\n                }\r\n                const url = `/api/v1/execute/${notebookId}`;\r\n                const { data } = await axios.post(url, task);\r\n                dispatch(setCurrentTask(data))\r\n\r\n            } catch (error) {\r\n                console.error(`Problem during notebook execution. ${error}`);\r\n            }\r\n\r\n        };\r\n\r\n\r\nexport const clearTasks =\r\n    (notebookId: Number) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n            try {\r\n                const sessionId = getSessionId();\r\n                const url = `/api/v1/clear_tasks/${notebookId}/${sessionId}`;\r\n                await axios.post(url);\r\n                dispatch(setCurrentTask({} as ITask));\r\n                dispatch(setHistoricTask({} as ITask));\r\n                dispatch(setPreviousTask({} as ITask));\r\n                dispatch(setExecutionHistory([]));\r\n                toast.success(\"All previous tasks deleted. The default view of the app is displayed.\")\r\n            } catch (error) {\r\n                toast.error(`Trying to clear previous tasks. The error occured. ${error}`)\r\n            }\r\n        };\r\n\r\n\r\nexport const exportToPDF =\r\n    (notebookId: Number, notebookPath: String) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n            try {\r\n                dispatch(setExportingToPDF(true));\r\n                dispatch(resetExportToPDFCounter());\r\n                dispatch(setExportToPDFJobId(\"\"));\r\n\r\n                const sessionId = getSessionId();\r\n                const url = `/api/v1/export_pdf/`;\r\n                // convert from JS camel case to Python undescore variables\r\n                const params = {\r\n                    session_id: sessionId,\r\n                    notebook_id: notebookId,\r\n                    notebook_path: notebookPath,\r\n                }\r\n                const { data } = await axios.post(url, params);\r\n                dispatch(setExportToPDFJobId(data.job_id))\r\n            } catch (error) {\r\n                toast.error(`The error occured during PDF export. ${error}`);\r\n                dispatch(stopPDFExport());\r\n            }\r\n        };\r\n\r\nexport const getPDF =\r\n    (jobId: String) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n            try {\r\n                const url = `/api/v1/get_pdf/${jobId}`;\r\n                const { data } = await axios.get(url);\r\n                if (data.ready) {\r\n                    dispatch(stopPDFExport());\r\n                    if (data.error !== \"\") {\r\n                        toast.error(data.error);\r\n                    } else {\r\n                        handleDownload(\r\n                            `${axios.defaults.baseURL}${data.url}`,\r\n                            `${data.title}`\r\n                        )\r\n                    }\r\n                } else {\r\n                    dispatch(increaseExportToPDFCounter());\r\n                }\r\n            } catch (error) {\r\n                toast.error(`The error occured during PDF export. ${error}`);\r\n                dispatch(stopPDFExport());\r\n            }\r\n        };\r\n\r\n\r\n\r\nexport const fetchExecutionHistory =\r\n    (notebookId: Number, clearPreviousHistory = true) =>\r\n        async (dispatch: Dispatch<AnyAction>) => {\r\n\r\n            dispatch(setHistoricTask({} as ITask));\r\n            if (clearPreviousHistory) {\r\n                dispatch(clearExecutionHistory());\r\n            }\r\n\r\n            const sessionId = getSessionId();\r\n\r\n            try {\r\n                const url = `/api/v1/execution_history/${notebookId}/${sessionId}`;\r\n                const { data } = await axios.get(url);\r\n                dispatch(setExecutionHistory(data))\r\n            } catch (error) {\r\n                dispatch(clearExecutionHistory());\r\n            }\r\n\r\n        };\r\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\n\nimport { setWidgetValue } from \"../Notebooks/notebooksSlice\";\n\ntype CheckboxProps = {\n  widgetKey: string;\n  label: string | null;\n  value: boolean | null;\n  disabled: boolean;\n  runNb: () => void;\n};\n\nexport default function CheckboxWidget({\n  widgetKey,\n  label,\n  value,\n  disabled,\n  runNb,\n}: CheckboxProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n\n  useEffect(() => {\n    if (updated) {\n      //console.log(\"run from checkbox\");\n      runNb();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group form-check form-switch mb-3\">\n      <input\n        className=\"form-check-input\"\n        type=\"checkbox\"\n        id={`checkbox-${label}`}\n        disabled={disabled}\n        onChange={() => {\n          userInteraction(true);\n          dispatch(setWidgetValue({ key: widgetKey, value: !value }));\n        }}\n        checked={value != null ? value : false}\n      />\n      <label\n        className=\"form-check-label\"\n        htmlFor={`checkbox-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { setWidgetValue } from \"../Notebooks/notebooksSlice\";\n\ntype NumericProps = {\n  widgetKey: string;\n  label: string | null;\n  value: number | null;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  disabled: boolean;\n  runNb: () => void;\n  continuousUpdate: boolean;\n};\n\nexport default function NumericWidget({\n  widgetKey,\n  label,\n  value,\n  min,\n  max,\n  step,\n  disabled,\n  runNb,\n  continuousUpdate,\n}: NumericProps) {\n  const dispatch = useDispatch();\n  const [apply, showApply] = useState(false);\n\n  let minValue = undefined;\n  let maxValue = undefined;\n  let stepValue = 1;\n  if (min) {\n    minValue = min;\n  }\n  if (max) {\n    maxValue = max;\n  }\n  if (step) {\n    stepValue = step;\n  }\n\n  let displayValue: string | number = \"\";\n  if (value) {\n    displayValue = value;\n  }\n\n  const validateValue = () => {\n    if (min && value && value < min) {\n      dispatch(setWidgetValue({ key: widgetKey, value: min }));\n    }\n    if (max && value && value > max) {\n      dispatch(setWidgetValue({ key: widgetKey, value: max }));\n    }\n  };\n\n  return (\n    <div className=\"form-group mb-3\">\n      <label\n        htmlFor={`checkbox-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      <input\n        className=\"form-control\"\n        type=\"number\"\n        value={displayValue as number | string}\n        onChange={(e) => {\n          showApply(true);\n          dispatch(setWidgetValue({ key: widgetKey, value: e.target.value }));\n        }}\n        onBlur={(e) => {\n          validateValue();\n        }}\n        onKeyPress={(e) => {\n          if (e.key === \"Enter\") {\n            validateValue();\n            runNb();\n            showApply(false);\n            e.preventDefault();\n          }\n        }}\n        min={minValue}\n        max={maxValue}\n        step={stepValue}\n      />\n      {apply && continuousUpdate && (\n        <div\n          style={{\n            float: \"right\",\n            position: \"relative\",\n            top: \"0px\",\n            left: \"0px\",\n          }}\n        >\n          <button\n            className=\"btn btn-sm btn-outline-primary\"\n            onClick={(e) => {\n              validateValue();\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }}\n            style={{\n              fontSize: \"0.7em\",\n              border: \"none\",\n            }}\n          >\n            Press enter or click to apply\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { setWidgetValue } from \"../Notebooks/notebooksSlice\";\nimport { Range, getTrackBackground } from \"react-range\";\n\ntype RangeProps = {\n  widgetKey: string;\n  label: string | null;\n  value: [number, number] | null;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  vertical: boolean | null;\n  disabled: boolean;\n  runNb: () => void;\n};\n\nexport default function RangeWidget({\n  widgetKey,\n  label,\n  value,\n  min,\n  max,\n  step,\n  vertical,\n  disabled,\n  runNb,\n}: RangeProps) {\n  const dispatch = useDispatch();\n  //const [updated, userInteraction] = useState(false);\n  let minValue = 0;\n  let maxValue = 100;\n  let stepValue = 1;\n  if (min) {\n    minValue = min;\n  }\n  if (max) {\n    maxValue = max;\n  }\n  if (step) {\n    stepValue = step;\n  }\n\n  const values =\n    value != null && value !== undefined && value.length === 2\n      ? value\n      : [minValue, maxValue];\n\n  return (\n    <div className=\"form-group mb-3\">\n      <label\n        htmlFor={`range-slider-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n\n      <div\n        style={{\n          paddingTop: \"12px\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Range\n          disabled={disabled}\n          values={values}\n          step={stepValue}\n          min={minValue}\n          max={maxValue}\n          onChange={(values) => {\n            //userInteraction(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: values as [number, number],\n              })\n            );\n          }}\n          onFinalChange={(values) => {\n            runNb();\n          }}\n          renderTrack={({ props, children }) => (\n            <div\n              onMouseDown={props.onMouseDown}\n              onTouchStart={props.onTouchStart}\n              style={{\n                ...props.style,\n                height: \"36px\",\n                display: \"flex\",\n                width: \"100%\",\n              }}\n            >\n              <div\n                ref={props.ref}\n                style={{\n                  height: \"5px\",\n                  width: \"100%\",\n                  borderRadius: \"4px\",\n                  background: getTrackBackground({\n                    values,\n                    colors: [\n                      \"#ccc\",\n                      disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\",\n                      \"#ccc\",\n                    ],\n                    min: minValue,\n                    max: maxValue,\n                  }),\n                  alignSelf: \"center\",\n                }}\n              >\n                {children}\n\n                <div\n                  style={{\n                    display: \"inline-block\",\n                    width: \"100%\",\n                    fontSize: \"12px\",\n                    paddingTop: \"13px\",\n                  }}\n                >\n                  <div style={{ float: \"left\" }}>{minValue}</div>\n                  <div style={{ float: \"right\" }}>{maxValue}</div>\n                </div>\n              </div>\n            </div>\n          )}\n          renderThumb={({ index, props, isDragged }) => (\n            <div\n              {...props}\n              style={{\n                ...props.style,\n                height: \"18px\",\n                width: \"18px\",\n                border: \"None !important\",\n                borderRadius: \"4px\",\n                backgroundColor: \"#FFF\",\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                boxShadow: \"0px 2px 6px #AAA\",\n                outline: \"none\",\n              }}\n            >\n              <div\n                style={{\n                  position: \"absolute\",\n                  top: \"-24px\",\n                  color: \"#fff\",\n                  fontWeight: \"bold\",\n                  fontSize: \"12px\",\n                  fontFamily: \"Arial,Helvetica Neue,Helvetica,sans-serif\",\n                  padding: \"2px\",\n                  borderRadius: \"3px\",\n                  backgroundColor: disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\",\n                }}\n              >\n                {values[index]}\n              </div>\n              <div\n                style={{\n                  height: \"12px\",\n                  width: \"3px\",\n                  backgroundColor: isDragged ? \"#2684ff\" : \"#CCC\",\n                }}\n              />\n            </div>\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport Select, { MultiValue } from \"react-select\";\nimport { RUN_DELAY_FAST, setWidgetValue } from \"../Notebooks/notebooksSlice\";\n\ntype SingleOption = { value: string; label: string };\ntype MultiOption = MultiValue<{ value: string; label: string } | undefined>;\n\nexport function isSingleOption(\n  options: SingleOption | MultiOption\n): options is SingleOption {\n  return (options as SingleOption).value !== undefined;\n}\n\ntype SelectProps = {\n  widgetKey: string;\n  label: string | null;\n  value: string | string[] | null;\n  choices: string[];\n  multi: boolean | undefined;\n  disabled: boolean;\n  runNb: () => void;\n};\n\nexport default function SelectWidget({\n  widgetKey,\n  label,\n  value,\n  choices,\n  multi,\n  disabled,\n  runNb,\n}: SelectProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n\n  const selectStyles = {\n    menu: (base: any) => ({\n      ...base,\n      zIndex: 100,\n    }),\n  };\n\n  let selectedValue: SingleOption = { value: \"\", label: \"\" };\n  let selectedValues: SingleOption[] = [{ value: \"\", label: \"\" }];\n\n  let options: { value: string; label: string }[] = choices.map((choice) => {\n    if (value && choice === value && !multi) {\n      selectedValue = { value: choice, label: choice };\n    }\n    return { value: choice, label: choice };\n  });\n\n  if (multi) {\n    selectedValues = [];\n    choices.map((choice) => {\n      if (value && value.includes(choice) && multi) {\n        selectedValues.push({ value: choice, label: choice });\n      }\n      return { value: choice, label: choice };\n    });\n  }\n\n  useEffect(() => {\n    if (!updated) return;\n    const timeOutId = setTimeout(() => {\n      // console.log(\"run from select\");\n      runNb();\n    }, RUN_DELAY_FAST);\n    return () => clearTimeout(timeOutId);\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group mb-3\">\n      <label\n        htmlFor={`select-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      <Select\n        id={`select-${label}`}\n        isDisabled={disabled}\n        name={label ? label : \"Select\"}\n        styles={selectStyles}\n        value={multi ? selectedValues : selectedValue}\n        options={options}\n        isMulti={multi}\n        onChange={(e) => {\n          if (e) {\n            userInteraction(true);\n            if (isSingleOption(e)) {\n              dispatch(setWidgetValue({ key: widgetKey, value: e.value }));\n            } else {\n              // console.log({ msg: \"values\", values: e.values() });\n              const vs = Array.from(e.values()).filter(\n                (i) => i !== undefined\n              ) as { label: string; value: string }[];\n              // console.log({\n              //   key: widgetKey,\n              // });\n              dispatch(\n                setWidgetValue({\n                  key: widgetKey,\n                  value: vs.map((i) => i.value) as string[],\n                })\n              );\n            }\n          }\n        }}\n      />\n    </div>\n  );\n}\n","import React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { setWidgetValue } from \"../Notebooks/notebooksSlice\";\nimport { Range, getTrackBackground } from \"react-range\";\n\ntype SliderProps = {\n  widgetKey: string;\n  label: string | null;\n  value: number | null;\n  min: number | null;\n  max: number | null;\n  step: number | null;\n  vertical: boolean | null;\n  disabled: boolean;\n  runNb: () => void;\n};\n\nexport default function SliderWidget({\n  widgetKey,\n  label,\n  value,\n  min,\n  max,\n  step,\n  vertical,\n  disabled,\n  runNb,\n}: SliderProps) {\n  const dispatch = useDispatch();\n\n  let minValue = 0;\n  let maxValue = 100;\n  let stepValue = 1;\n  if (min) {\n    minValue = min;\n  }\n  if (max) {\n    maxValue = max;\n  }\n  if (step) {\n    stepValue = step;\n  }\n  const vals: number[] = [value !== null ? value : maxValue];\n\n  return (\n    <div className=\"form-group mb-3\">\n      <label\n        htmlFor={`slider-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n\n      <div\n        style={{\n          paddingTop: \"12px\",\n          display: \"flex\",\n          justifyContent: \"center\",\n          flexWrap: \"wrap\",\n        }}\n      >\n        <Range\n          disabled={disabled}\n          values={vals}\n          step={stepValue}\n          min={minValue}\n          max={maxValue}\n          onChange={(values) => {\n            dispatch(setWidgetValue({ key: widgetKey, value: values[0] }));\n          }}\n          onFinalChange={(values) => {\n            runNb();\n          }}\n          renderTrack={({ props, children }) => (\n            <div\n              onMouseDown={props.onMouseDown}\n              onTouchStart={props.onTouchStart}\n              style={{\n                ...props.style,\n                height: \"36px\",\n                display: \"flex\",\n                width: \"100%\",\n              }}\n            >\n              <div\n                ref={props.ref}\n                style={{\n                  height: \"5px\",\n                  width: \"100%\",\n                  borderRadius: \"4px\",\n                  background: getTrackBackground({\n                    values: vals,\n                    colors: [\n                      disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\", // \"#548BF4\",\n                      \"#ccc\",\n                    ],\n                    min: minValue,\n                    max: maxValue,\n                  }),\n                  alignSelf: \"center\",\n                }}\n              >\n                {children}\n\n                <div\n                  style={{\n                    display: \"inline-block\",\n                    width: \"100%\",\n                    fontSize: \"12px\",\n                    paddingTop: \"13px\",\n                  }}\n                >\n                  <div style={{ float: \"left\" }}>{minValue}</div>\n                  <div style={{ float: \"right\" }}>{maxValue}</div>\n                </div>\n              </div>\n            </div>\n          )}\n          renderThumb={({ props, isDragged }) => (\n            <div\n              {...props}\n              style={{\n                ...props.style,\n                height: \"18px\",\n                width: \"18px\",\n                border: \"None\",\n                borderRadius: \"4px\",\n                backgroundColor: \"#FFF\",\n                display: \"flex\",\n                justifyContent: \"center\",\n                alignItems: \"center\",\n                boxShadow: \"0px 2px 6px #AAA\",\n                outline: \"none\",\n              }}\n            >\n              <div\n                style={{\n                  position: \"absolute\",\n                  top: \"-24px\",\n                  color: \"#fff\",\n                  fontWeight: \"bold\",\n                  fontSize: \"12px\",\n                  fontFamily: \"Arial,Helvetica Neue,Helvetica,sans-serif\",\n                  padding: \"2px\",\n                  borderRadius: \"3px\",\n                  backgroundColor: disabled ? \"rgba(0, 0, 0, 0.3)\" : \"#2684ff\",\n                }}\n              >\n                {vals[0]}\n              </div>\n              <div\n                style={{\n                  height: \"12px\",\n                  width: \"3px\",\n                  backgroundColor: isDragged ? \"#2684ff\" : \"#CCC\",\n                }}\n              />\n            </div>\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect, useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport { setWidgetValue } from \"../Notebooks/notebooksSlice\";\n\nimport { FilePond, registerPlugin } from \"react-filepond\";\nimport FilePondPluginImageExifOrientation from \"filepond-plugin-image-exif-orientation\";\nimport FilePondPluginImagePreview from \"filepond-plugin-image-preview\";\nimport FilePondPluginFileValidateSize from \"filepond-plugin-file-validate-size\";\n\nregisterPlugin(\n  FilePondPluginImageExifOrientation,\n  FilePondPluginImagePreview,\n  FilePondPluginFileValidateSize\n);\n\ntype FileProps = {\n  widgetKey: string;\n  label: string | null;\n  maxFileSize: string | null;\n  disabled: boolean;\n  value: string[];\n  runNb: () => void;\n};\n\nexport default function FileWidget({\n  widgetKey,\n  label,\n  maxFileSize,\n  disabled,\n  value,\n  runNb,\n}: FileProps) {\n  const dispatch = useDispatch();\n  const [updated, userInteraction] = useState(false);\n  let fileSizeLimit = \"100MB\";\n  if (maxFileSize) {\n    fileSizeLimit = maxFileSize;\n  }\n  useEffect(() => {\n    if (updated && value.length === 2) {\n      //console.log(\"run from file\");\n      runNb();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group mb-3\">\n      <label\n        htmlFor={`file-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      <div>\n        <FilePond\n          disabled={disabled}\n          maxFileSize={fileSizeLimit}\n          onprocessfile={(error, file) => {\n            userInteraction(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: [file.filename, file.serverId],\n              })\n            );\n          }}\n          server={{\n            url: `${axios.defaults.baseURL}/api/v1/fp`,\n            process: \"/process/\",\n            revert: async (uniqueFileId, load, error) => {\n              try {\n                await axios.delete(\n                  `${axios.defaults.baseURL}/api/v1/fp/revert`,\n                  {\n                    data: uniqueFileId,\n                  }\n                );\n                dispatch(setWidgetValue({ key: widgetKey, value: [] }));\n                // Should call the load method when done, no parameters required\n                load();\n              } catch (e) {\n                // Can call the error method if something is wrong, should exit after\n                error(\"Problem with uploaded file removal\");\n              }\n            },\n          }}\n          labelIdle='Drag & Drop your file or <span class=\"filepond--label-action\">Browse</span>'\n        />\n      </div>\n    </div>\n  );\n}\n","import React, { useState } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { setWidgetValue } from \"../Notebooks/notebooksSlice\";\n\ntype TextProps = {\n  widgetKey: string;\n  label: string | null;\n  value: string | undefined;\n  rows: number | null;\n  disabled: boolean;\n  runNb: () => void;\n  continuousUpdate: boolean;\n};\n\nexport default function TextWidget({\n  widgetKey,\n  label,\n  value,\n  rows,\n  disabled,\n  runNb,\n  continuousUpdate,\n}: TextProps) {\n  const dispatch = useDispatch();\n  const [apply, showApply] = useState(false);\n  let rowsValue: number = rows ? rows : 1;\n\n  const sanitizeString = (input_string: string) => {\n    return input_string.replace(/[\"'(){}[\\]`^]/gim, \"\");\n  };\n\n  return (\n    <div className=\"form-group mb-3\">\n      <label\n        htmlFor={`textarea-${label}`}\n        style={{ color: disabled ? \"#555\" : \"#212529\" }}\n      >\n        {label}\n      </label>\n      {rowsValue === 1 && (\n        <input\n          className=\"form-control\"\n          type=\"text\"\n          id={`text-${label}`}\n          value={value ? value : \"\"}\n          onChange={(e) => {\n            showApply(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: sanitizeString(e.target.value),\n              })\n            );\n          }}\n          onKeyPress={(e) => {\n            if (e.key === \"Enter\") {\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }\n          }}\n          disabled={disabled}\n        />\n      )}\n      {rowsValue > 1 && (\n        <textarea\n          className=\"form-control\"\n          id={`text-area-${label}`}\n          rows={rowsValue}\n          value={value ? value : \"\"}\n          onChange={(e) => {\n            showApply(true);\n            dispatch(\n              setWidgetValue({\n                key: widgetKey,\n                value: sanitizeString(e.target.value),\n              })\n            );\n          }}\n          disabled={disabled}\n        />\n      )}\n\n      {apply && continuousUpdate && rowsValue === 1 && (\n        <div\n          style={{\n            fontSize: \"0.7em\",\n            float: \"right\",\n            position: \"relative\",\n            top: \"0px\",\n            left: \"-5px\",\n            color: \"#2684ff\",\n          }}\n        >\n          Press enter to apply\n        </div>\n      )}\n      {apply && continuousUpdate && rowsValue > 1 && (\n        <div\n          style={{\n            float: \"right\",\n            position: \"relative\",\n            top: \"2px\",\n            left: \"0px\",\n          }}\n        >\n          <button\n            className=\"btn btn-sm btn-outline-primary\"\n            onClick={(e) => {\n              runNb();\n              showApply(false);\n              e.preventDefault();\n            }}\n            style={{\n              fontSize: \"0.7em\",\n            }}\n          >\n            Apply\n          </button>\n        </div>\n      )}\n    </div>\n  );\n}\n","/* eslint-disable import/no-cycle */\nimport { createSlice, PayloadAction } from \"@reduxjs/toolkit\";\nimport { RootState } from \"../store\";\n\nexport enum WebSocketState {\n  Connecting = \"Connecting\",\n  Connected = \"Connected\",\n  Unknown = \"Unknown\",\n  Disconnected = \"Disconnected\",\n}\n\nexport enum WorkerState {\n  Unknown = \"Unknown\",\n  Starting = \"Starting\",\n  Running = \"Running\",\n  Missing = \"Missing\",\n  Busy = \"Busy\",\n  Queued = \"Queued\",\n}\n\nconst initialState = {\n  webSocketState: WebSocketState.Unknown,\n  workerState: WorkerState.Unknown,\n  workerId: undefined as undefined | number,\n  notebookSrc: \"\",\n};\n\nconst wsSlice = createSlice({\n  name: \"ws\",\n  initialState,\n  reducers: {\n    setWebSocketState(state, action: PayloadAction<WebSocketState>) {\n      state.webSocketState = action.payload;\n    },\n    setWorkerState(state, action: PayloadAction<WorkerState>) {\n      state.workerState = action.payload;\n    },\n    setWorkerId(state, action: PayloadAction<undefined | number>) {\n      state.workerId = action.payload;\n    },\n    setNotebookSrc(state, action: PayloadAction<string>) {\n      state.notebookSrc = action.payload;\n    },\n  },\n});\n\nexport default wsSlice.reducer;\n\nexport const {\n  setWebSocketState,\n  setWorkerState,\n  setWorkerId,\n  setNotebookSrc,\n} = wsSlice.actions;\n\nexport const getWebSocketState = (state: RootState) => state.ws.webSocketState;\nexport const getWorkerState = (state: RootState) => state.ws.workerState;\nexport const getWorkerId = (state: RootState) => state.ws.workerId;\nexport const getNotebookSrc = (state: RootState) => state.ws.notebookSrc;\n\nexport const runNotebook = (widgets_params: string) => {\n  return {\n    purpose: \"run-notebook\",\n    widgets: widgets_params,\n  };\n};\n\nexport const saveNotebook = () => {\n  return {\n    purpose: \"save-notebook\",\n  };\n};\n\nexport const displayNotebook = (taskId: number) => {\n  return {\n    purpose: \"display-notebook\",\n    taskId,\n  };\n};\n\nexport const downloadHTML = () => {\n  return {\n    purpose: \"download-html\",\n  };\n};\n\nexport const downloadPDF = () => {\n  return {\n    purpose: \"download-pdf\",\n  };\n};","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\n\nimport ReactMarkdown from \"react-markdown\";\nimport rehypeHighlight from \"rehype-highlight\";\nimport remarkGfm from \"remark-gfm\";\nimport emoji from \"remark-emoji\";\nimport rehypeRaw from \"rehype-raw\";\n\ntype MarkdownProps = {\n  value: string;\n  disabled: boolean;\n};\n\nexport default function MarkdownWidget({ value, disabled }: MarkdownProps) {\n  return (\n    <div\n      className=\"form-group mb-3\"\n      style={{ color: disabled ? \"#555\" : \"#212529\" }}\n    >\n      <ReactMarkdown\n        rehypePlugins={[remarkGfm, rehypeHighlight, emoji, rehypeRaw]}\n      >\n        {value}\n      </ReactMarkdown>\n    </div>\n  );\n}\n","import React, { createContext } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  getSelectedNotebookId,\n  hideWidgets,\n  isStaticNotebook,\n  updateWidgetsParams,\n  initWidgets,\n  fetchNotebook,\n  updateTitle,\n  updateShowCode,\n} from \"../components/Notebooks/notebooksSlice\";\nimport {\n  setNotebookSrc,\n  setWebSocketState,\n  setWorkerState,\n  setWorkerId,\n  WebSocketState,\n  WorkerState,\n} from \"./wsSlice\";\n\nimport { useSelector } from \"react-redux\";\nimport { getSessionId, handleDownload } from \"../utils\";\nimport { fetchExecutionHistory, setExportingToPDF } from \"../tasks/tasksSlice\";\n\nconst WebSocketContext = createContext(undefined as any);\n\nexport { WebSocketContext };\n\nlet wsServer = \"ws://127.0.0.1:8000\";\nlet localServer = true;\nif (window.location.origin === \"http://localhost:3000\") {\n  wsServer = \"ws://127.0.0.1:8000\";\n  localServer = true;\n} else {\n  wsServer = window.location.origin\n    .replace(\"http://\", \"ws://\")\n    .replace(\"https://\", \"wss://\");\n  localServer = false;\n}\n\nexport default function WebSocketProvider({\n  children,\n}: {\n  children: JSX.Element;\n}) {\n  console.log(\"WebSocketProvider\");\n\n  const dispatch = useDispatch();\n  const selectedNotebookId = useSelector(getSelectedNotebookId);\n  const isStatic = useSelector(isStaticNotebook);\n\n  let connection: WebSocket | undefined = undefined;\n\n  const sendMessage = (payload: string) => {\n    if (connection !== undefined && connection.readyState === connection.OPEN) {\n      connection.send(payload);\n    }\n  };\n\n  function onOpen(event: any): void {\n    sendMessage(\n      JSON.stringify({\n        purpose: \"server-address\",\n        address: wsServer\n      })\n    );\n    dispatch(setWebSocketState(WebSocketState.Connected));\n    ping();\n  }\n\n  function onMessage(event: any): void {\n    // console.log(\"reveived from server\", event.data);\n\n    const response = JSON.parse(event.data);\n    if (\"purpose\" in response) {\n      if (response.purpose === \"worker-state\") {\n        //console.log(\"worker-state\", response.state);\n        dispatch(setWorkerState(response.state));\n        dispatch(setWorkerId(response.workerId));\n      } else if (response.purpose === \"executed-notebook\") {\n        //console.log(response?.reloadNotebook, selectedNotebookId);\n        if (response?.reloadNotebook && selectedNotebookId !== undefined) {\n          //console.log(\"reload notebook ...........................\");\n          dispatch(fetchNotebook(selectedNotebookId));\n        }\n        dispatch(setNotebookSrc(response.body));\n        \n      } else if (response.purpose === \"saved-notebook\") {\n        if (selectedNotebookId !== undefined) {\n          dispatch(fetchExecutionHistory(selectedNotebookId, false));\n        }\n      } else if (response.purpose === \"update-widgets\") {\n        dispatch(updateWidgetsParams(response));\n      } else if (response.purpose === \"hide-widgets\") {\n        dispatch(hideWidgets(response));\n      } else if (response.purpose === \"init-widgets\") {\n        //console.log(\"init-widgets\");\n        dispatch(initWidgets(response));\n      }  else if (response.purpose === \"update-title\") {\n        dispatch(updateTitle(response.title));\n      }  else if (response.purpose === \"update-show-code\") {\n        dispatch(updateShowCode(response.showCode));\n      } else if (\n        response.purpose === \"download-html\" ||\n        response.purpose === \"download-pdf\"\n      ) {\n        if (response.url && response.filename) {\n          dispatch(setExportingToPDF(false));\n          handleDownload(response.url, response.filename);\n        }\n      }\n    }\n  }\n\n  function onError(event: any): void {\n    dispatch(setWebSocketState(WebSocketState.Disconnected));\n    dispatch(setWorkerState(WorkerState.Unknown));\n  }\n\n  function onClose(event: any): void {\n    dispatch(setWebSocketState(WebSocketState.Disconnected));\n    dispatch(setWorkerState(WorkerState.Unknown));\n    dispatch(setWorkerId(undefined));\n    connection = undefined;\n    setTimeout(() => connect(), 5000);\n  }\n\n  function ping(): void {\n    sendMessage(\n      JSON.stringify({\n        purpose: \"worker-ping\",\n      })\n    );\n    if (connection !== undefined && connection.readyState === connection.OPEN) {\n      setTimeout(() => ping(), 5000);\n    }\n  }\n\n  function connect() {\n    if (\n      (localServer || !isStatic) &&\n      selectedNotebookId !== undefined &&\n      connection === undefined\n    ) {\n      connection = new WebSocket(\n        `${wsServer}/ws/client/${selectedNotebookId}/${getSessionId()}/`\n      );\n      connection.onopen = onOpen;\n      connection.onmessage = onMessage;\n      connection.onerror = onError;\n      connection.onclose = onClose;\n    }\n  }\n  connect();\n\n  const ws = {\n    sendMessage,\n  };\n\n  return (\n    <WebSocketContext.Provider value={ws}>{children}</WebSocketContext.Provider>\n  );\n}\n","import React from \"react\";\nimport { useSelector } from \"react-redux\";\nimport { getSessionId } from \"../utils\";\nimport {\n  WorkerState,\n  WebSocketState,\n  getWebSocketState,\n  getWorkerState,\n} from \"./wsSlice\";\n\nexport default function StatusBar() {\n  const wsStatus = useSelector(getWebSocketState);\n  const workerState = useSelector(getWorkerState);\n\n  let wifiColor = \"orange\";\n  if (wsStatus === WebSocketState.Connected) {\n    wifiColor = \"green\";\n  } else if (\n    wsStatus === WebSocketState.Disconnected ||\n    wsStatus === WebSocketState.Unknown\n  ) {\n    wifiColor = \"red\";\n  }\n\n  let workerColor = \"orange\";\n  if (\n    workerState === WorkerState.Running ||\n    workerState === WorkerState.Busy\n  ) {\n    workerColor = \"green\";\n  } else if (\n    workerState === WorkerState.Missing ||\n    workerState === WorkerState.Unknown\n  ) {\n    workerColor = \"red\";\n  }\n\n  return (\n    <div>\n      <span title={`WebSocket: ${wsStatus}`}>\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"16\"\n          height=\"16\"\n          fill={wifiColor}\n          className=\"bi bi-wifi\"\n          viewBox=\"0 0 16 16\"\n        >\n          <path d=\"M15.384 6.115a.485.485 0 0 0-.047-.736A12.444 12.444 0 0 0 8 3C5.259 3 2.723 3.882.663 5.379a.485.485 0 0 0-.048.736.518.518 0 0 0 .668.05A11.448 11.448 0 0 1 8 4c2.507 0 4.827.802 6.716 2.164.205.148.49.13.668-.049z\" />\n          <path d=\"M13.229 8.271a.482.482 0 0 0-.063-.745A9.455 9.455 0 0 0 8 6c-1.905 0-3.68.56-5.166 1.526a.48.48 0 0 0-.063.745.525.525 0 0 0 .652.065A8.46 8.46 0 0 1 8 7a8.46 8.46 0 0 1 4.576 1.336c.206.132.48.108.653-.065zm-2.183 2.183c.226-.226.185-.605-.1-.75A6.473 6.473 0 0 0 8 9c-1.06 0-2.062.254-2.946.704-.285.145-.326.524-.1.75l.015.015c.16.16.407.19.611.09A5.478 5.478 0 0 1 8 10c.868 0 1.69.201 2.42.56.203.1.45.07.61-.091l.016-.015zM9.06 12.44c.196-.196.198-.52-.04-.66A1.99 1.99 0 0 0 8 11.5a1.99 1.99 0 0 0-1.02.28c-.238.14-.236.464-.04.66l.706.706a.5.5 0 0 0 .707 0l.707-.707z\" />\n        </svg>\n      </span>{\" \"}\n      <span title={`Worker: ${workerState}\\nSession Id: ${getSessionId()}`}>\n        <svg\n          xmlns=\"http://www.w3.org/2000/svg\"\n          width=\"16\"\n          height=\"16\"\n          fill={workerColor}\n          className=\"bi bi-cpu\"\n          viewBox=\"0 0 16 16\"\n        >\n          <path d=\"M5 0a.5.5 0 0 1 .5.5V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2h1V.5a.5.5 0 0 1 1 0V2A2.5 2.5 0 0 1 14 4.5h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14v1h1.5a.5.5 0 0 1 0 1H14a2.5 2.5 0 0 1-2.5 2.5v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14h-1v1.5a.5.5 0 0 1-1 0V14A2.5 2.5 0 0 1 2 11.5H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2v-1H.5a.5.5 0 0 1 0-1H2A2.5 2.5 0 0 1 4.5 2V.5A.5.5 0 0 1 5 0zm-.5 3A1.5 1.5 0 0 0 3 4.5v7A1.5 1.5 0 0 0 4.5 13h7a1.5 1.5 0 0 0 1.5-1.5v-7A1.5 1.5 0 0 0 11.5 3h-7zM5 6.5A1.5 1.5 0 0 1 6.5 5h3A1.5 1.5 0 0 1 11 6.5v3A1.5 1.5 0 0 1 9.5 11h-3A1.5 1.5 0 0 1 5 9.5v-3zM6.5 6a.5.5 0 0 0-.5.5v3a.5.5 0 0 0 .5.5h3a.5.5 0 0 0 .5-.5v-3a.5.5 0 0 0-.5-.5h-3z\" />\n        </svg>\n      </span>\n      {workerState === WorkerState.Busy && (\n        <span title=\"Worker is busy\">\n          {\" \"}\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"16\"\n            height=\"16\"\n            fill=\"green\"\n            className=\"bi bi-activity\"\n            viewBox=\"0 0 16 16\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M6 2a.5.5 0 0 1 .47.33L10 12.036l1.53-4.208A.5.5 0 0 1 12 7.5h3.5a.5.5 0 0 1 0 1h-3.15l-1.88 5.17a.5.5 0 0 1-.94 0L6 3.964 4.47 8.171A.5.5 0 0 1 4 8.5H.5a.5.5 0 0 1 0-1h3.15l1.88-5.17A.5.5 0 0 1 6 2Z\"\n            />\n          </svg> Busy\n        </span>\n      )}\n    </div>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport {\n  setWidgetValue,\n} from \"../Notebooks/notebooksSlice\";\n\ntype ButtonProps = {\n  widgetKey: string;\n  label: string | null;\n  style: string;\n  value: string | boolean | null;\n  disabled: boolean;\n  runNb: () => void;\n};\n\nexport default function ButtonWidget({\n  widgetKey,\n  label,\n  style,\n  value,\n  disabled,\n  runNb,\n}: ButtonProps) {\n  const dispatch = useDispatch();\n\n  let selectedClass = \"btn-primary\";\n  if (style === \"success\") {\n    selectedClass = \"btn-success\";\n  } else if (style === \"danger\") {\n    selectedClass = \"btn-danger\";\n  } else if (style === \"info\") {\n    selectedClass = \"btn-info\";\n  } else if (style === \"warning\") {\n    selectedClass = \"btn-warning\";\n  }\n\n  useEffect(() => {\n    if (value) {\n      console.log(\"run from button\");\n      runNb();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [value]);\n\n  return (\n    <div className=\"form-group mb-3\">\n      <button\n        type=\"button\"\n        className={`btn ${selectedClass}`}\n        style={{ marginRight: \"10px\", width: \"47%\" }}\n        onClick={() => {\n          dispatch(\n            setWidgetValue({\n              key: widgetKey,\n              value: true,\n            })\n          );\n        }}\n        disabled={disabled}\n      >\n        {label}\n      </button>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { WorkerState } from \"../websocket/wsSlice\";\n\ntype RunButtonProps = {\n  runNb: () => void;\n  waiting: boolean;\n  workerState: WorkerState;\n};\n\nexport default function RunButton({\n  runNb,\n  waiting,\n  workerState,\n}: RunButtonProps) {\n  return (\n    <button\n      type=\"button\"\n      className=\"btn btn-success\"\n      style={{ marginRight: \"10px\", width: \"47%\" }}\n      onClick={() => {\n        runNb();\n      }}\n      disabled={\n        waiting ||\n        // !allFilesUploaded() ||\n        workerState !== WorkerState.Running\n      }\n    >\n      {workerState === WorkerState.Running && (\n        <span>\n          <i className=\"fa fa-play\" aria-hidden=\"true\"></i> Run\n        </span>\n      )}\n      {workerState === WorkerState.Busy && (\n        <span>\n          <svg\n            xmlns=\"http://www.w3.org/2000/svg\"\n            width=\"16\"\n            height=\"16\"\n            fill=\"white\"\n            className=\"bi bi-activity\"\n            viewBox=\"0 0 16 16\"\n          >\n            <path\n              fillRule=\"evenodd\"\n              d=\"M6 2a.5.5 0 0 1 .47.33L10 12.036l1.53-4.208A.5.5 0 0 1 12 7.5h3.5a.5.5 0 0 1 0 1h-3.15l-1.88 5.17a.5.5 0 0 1-.94 0L6 3.964 4.47 8.171A.5.5 0 0 1 4 8.5H.5a.5.5 0 0 1 0-1h3.15l1.88-5.17A.5.5 0 0 1 6 2Z\"\n            />\n          </svg>{\" \"}\n          Busy\n        </span>\n      )}\n      {workerState !== WorkerState.Busy &&\n        workerState !== WorkerState.Running && <span>Wait for worker ...</span>}\n    </button>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useContext } from \"react\";\nimport { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport axios from \"axios\";\nimport {\n  exportToPDF,\n  scrapeSlidesHash,\n  setExportingToPDF,\n} from \"../tasks/tasksSlice\";\nimport CheckboxWidget from \"./Widgets/Checkbox\";\nimport NumericWidget from \"./Widgets/Numeric\";\nimport RangeWidget from \"./Widgets/Range\";\nimport SelectWidget from \"./Widgets/Select\";\nimport SliderWidget from \"./Widgets/Slider\";\n\nimport {\n  isCheckboxWidget,\n  isFileWidget,\n  isNumericWidget,\n  isRangeWidget,\n  isSelectWidget,\n  isSliderWidget,\n  isTextWidget,\n  isMarkdownWidget,\n  IWidget,\n  isOutputFilesWidget,\n  isButtonWidget,\n} from \"./Widgets/Types\";\n//import { getWidgetsValues, setWidgetValue } from \"./Widgets/widgetsSlice\";\nimport {\n  getWidgetsValues,\n  setSlidesHash,\n  setWidgetValue,\n} from \"./Notebooks/notebooksSlice\";\nimport FileWidget from \"./Widgets/File\";\nimport TextWidget from \"./Widgets/Text\";\nimport { setShowSideBar, setView } from \"../views/appSlice\";\nimport { handleDownload } from \"../utils\";\nimport MarkdownWidget from \"./Widgets/Markdown\";\n\nimport { WebSocketContext } from \"../websocket/Provider\";\nimport WebSocketStateBar from \"../websocket/StatusBar\";\nimport {\n  downloadHTML,\n  downloadPDF,\n  getWorkerState,\n  runNotebook,\n  WorkerState,\n} from \"../websocket/wsSlice\";\nimport ButtonWidget from \"./Widgets/Button\";\nimport RunButton from \"./RunButton\";\nimport BlockUi from \"react-block-ui\";\n\ntype SideBarProps = {\n  notebookTitle: string;\n  notebookId: number;\n  notebookSchedule: string;\n  taskCreatedAt: Date;\n  loadingState: string;\n  waiting: boolean;\n  widgetsParams: Record<string, IWidget>;\n  watchMode: boolean;\n  notebookPath: string;\n  displayEmbed: boolean;\n  showFiles: boolean;\n  isPresentation: boolean;\n  notebookParseErrors: string;\n  continuousUpdate: boolean;\n  staticNotebook: boolean;\n};\n\nexport default function SideBar({\n  notebookTitle,\n  notebookId,\n  notebookSchedule,\n  taskCreatedAt,\n  loadingState,\n  waiting,\n  widgetsParams,\n  watchMode,\n  notebookPath,\n  displayEmbed,\n  showFiles,\n  isPresentation,\n  notebookParseErrors,\n  continuousUpdate,\n  staticNotebook,\n}: SideBarProps) {\n  const dispatch = useDispatch();\n  const widgetsValues = useSelector(getWidgetsValues);\n  const workerState = useSelector(getWorkerState);\n\n  const ws = useContext(WebSocketContext);\n\n  // useEffect(() => {\n  //   const timeOutId = setTimeout(() => {\n  //     console.log(\"effect widgets values\");\n  //   }, RUN_DELAY);\n  //   return () => clearTimeout(timeOutId);\n  // }, [widgetsValues]);\n\n  const runNb = () => {\n    if (continuousUpdate) {\n      execNb();\n    }\n  };\n\n  const execNb = () => {\n    const slidesHash = scrapeSlidesHash();\n    dispatch(setSlidesHash(slidesHash));\n\n    ws.sendMessage(JSON.stringify(runNotebook(JSON.stringify(widgetsValues))));\n  };\n\n  // const saveNb = () => {\n  //   if (!staticNotebook) {\n  //     ws.sendMessage(JSON.stringify(saveNotebook()));\n  //   }\n  // };\n\n  // const displayNb = (taskId: number) => {\n  //   if (!staticNotebook) {\n  //     ws.sendMessage(JSON.stringify(displayNotebook(taskId)));\n  //   }\n  // };\n\n  const runDownloadHTML = () => {\n    if (!staticNotebook) {\n      ws.sendMessage(JSON.stringify(downloadHTML()));\n    }\n  };\n\n  const runDownloadPDF = () => {\n    if (!staticNotebook) {\n      ws.sendMessage(JSON.stringify(downloadPDF()));\n    }\n  };\n\n  useEffect(() => {\n    if (widgetsParams) {\n      for (let [key, widgetParams] of Object.entries(widgetsParams)) {\n        if (key in widgetsValues) {\n          continue;\n        }\n\n        if (widgetParams.input === \"file\") {\n          dispatch(setWidgetValue({ key, value: [] as string[] }));\n        } else if (widgetParams.input === \"text\") {\n          dispatch(\n            setWidgetValue({\n              key,\n              value: widgetParams.value ? widgetParams.value : \"\",\n            })\n          );\n        } else if (isMarkdownWidget(widgetParams)) {\n          // do nothing\n          // dont put value into store\n        } else if (isOutputFilesWidget(widgetParams)) {\n          dispatch(setWidgetValue({ key, value: \"output-dir\" }));\n        } else {\n          dispatch(setWidgetValue({ key, value: widgetParams.value }));\n        }\n      }\n    }\n  }, [dispatch, widgetsParams, widgetsValues]);\n\n  let widgets = [];\n  let fileKeys = [] as string[]; // keys to file widgets, all need to be selected to enable RUN button\n\n  if (widgetsParams && !staticNotebook) {\n    // sort widgets keys based on cell index and code line number\n    let widgetKeys = [];\n    for (let key of Object.keys(widgetsParams)) {\n      const parts = key.split(\".\");\n      widgetKeys.push([key, parseFloat(`${parts[1]}.${parts[2]}`)]);\n    }\n    widgetKeys.sort(function (a, b) {\n      const a1 = a[1] as number;\n      const b1 = b[1] as number;\n      return a1 - b1;\n    });\n\n    for (let wKey of widgetKeys) {\n      const key = wKey[0] as string;\n      const widgetParams = widgetsParams[key];\n\n      if (isSelectWidget(widgetParams)) {\n        widgets.push(\n          <SelectWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as string}\n            choices={widgetParams?.choices}\n            multi={widgetParams?.multi}\n            key={key}\n            runNb={runNb}\n          />\n        );\n      } else if (isCheckboxWidget(widgetParams)) {\n        widgets.push(\n          <CheckboxWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as boolean}\n            key={key}\n            runNb={runNb}\n          />\n        );\n      } else if (isNumericWidget(widgetParams)) {\n        widgets.push(\n          <NumericWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as number}\n            min={widgetParams?.min}\n            max={widgetParams?.max}\n            step={widgetParams?.step}\n            key={key}\n            runNb={runNb}\n            continuousUpdate={continuousUpdate}\n          />\n        );\n      } else if (isSliderWidget(widgetParams)) {\n        widgets.push(\n          <SliderWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as number}\n            min={widgetParams?.min}\n            max={widgetParams?.max}\n            step={widgetParams?.step}\n            vertical={widgetParams?.vertical}\n            key={key}\n            runNb={runNb}\n          />\n        );\n      } else if (isRangeWidget(widgetParams)) {\n        widgets.push(\n          <RangeWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as [number, number]}\n            min={widgetParams?.min}\n            max={widgetParams?.max}\n            step={widgetParams?.step}\n            vertical={widgetParams?.vertical}\n            key={key}\n            runNb={runNb}\n          />\n        );\n      } else if (isFileWidget(widgetParams)) {\n        widgets.push(\n          <FileWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            maxFileSize={widgetParams?.maxFileSize}\n            key={key}\n            value={widgetsValues[key] as string[]}\n            runNb={runNb}\n          />\n        );\n        fileKeys.push(key);\n      } else if (isTextWidget(widgetParams)) {\n        widgets.push(\n          <TextWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as string}\n            rows={widgetParams?.rows}\n            key={key}\n            runNb={runNb}\n            continuousUpdate={continuousUpdate}\n          />\n        );\n      } else if (isMarkdownWidget(widgetParams)) {\n        widgets.push(\n          <MarkdownWidget\n            value={widgetParams.value as string}\n            disabled={waiting}\n            key={key}\n          />\n        );\n      } else if (isButtonWidget(widgetParams)) {\n        widgets.push(\n          <ButtonWidget\n            widgetKey={key}\n            disabled={waiting}\n            label={widgetParams?.label}\n            value={widgetsValues[key] as boolean}\n            style={widgetParams?.style}\n            key={key}\n            runNb={runNb}\n          />\n        );\n      } else if (isOutputFilesWidget(widgetParams)) {\n        // do nothing\n      } else {\n        console.log(\"Unknown widget type\", widgetParams);\n      }\n    }\n  }\n\n  // const allFilesUploaded = () => {\n  //   if (fileKeys.length === 0) {\n  //     // no files at all, so OK\n  //     return true;\n  //   }\n  //   for (const key of fileKeys) {\n  //     if (!Object.prototype.hasOwnProperty.call(widgetsValues, key)) {\n  //       return false;\n  //     }\n  //     let files = widgetsValues[key] as string[];\n  //     if (files === undefined || files.length === 0) {\n  //       return false;\n  //     }\n  //   }\n  //   return true;\n  // };\n\n  let additionalStyle = {};\n  if (displayEmbed) {\n    additionalStyle = { padding: \"0px\" };\n  }\n\n  return (\n    <nav\n      id=\"sidebarMenu\"\n      className=\"col-lg-3 d-md-block bg-light sidebar\"\n      style={{ ...additionalStyle, overflowY: \"auto\" }}\n    >\n      <BlockUi blocking={false} message=\"\">\n        <div className=\"position-sticky p-3\">\n          <h4>\n            {notebookTitle}\n            <button\n              className=\"btn btn-sm  btn-outline-primary\"\n              type=\"button\"\n              style={{\n                float: \"right\",\n                zIndex: \"101\",\n              }}\n              onClick={() => dispatch(setShowSideBar(false))}\n              data-toggle=\"tooltip\"\n              data-placement=\"right\"\n              title=\"Hide sidebar\"\n            >\n              <i className=\"fa fa-chevron-left\" aria-hidden=\"true\" />\n            </button>\n          </h4>\n\n          <div style={{ padding: \"0px\" }}>\n            <form>\n              {widgets}\n              <div className=\"form-group mb-3 pb-1 pt-2\">\n                {!continuousUpdate && (\n                  <RunButton\n                    runNb={execNb}\n                    waiting={waiting}\n                    workerState={workerState}\n                  />\n                )}\n                <div\n                  className=\"dropdown\"\n                  style={{\n                    width: \"47%\",\n                    float: continuousUpdate ? \"left\" : \"right\",\n                  }}\n                >\n                  <button\n                    className=\"btn btn-primary dropdown-toggle\"\n                    style={{ margin: \"0px\", width: \"100%\" }}\n                    type=\"button\"\n                    data-bs-toggle=\"dropdown\"\n                    disabled={waiting}\n                  >\n                    Download\n                  </button>\n\n                  <ul className=\"dropdown-menu dropdown-menu-end\">\n                    <li>\n                      <a\n                        style={{ cursor: \"pointer\" }}\n                        className=\"dropdown-item\"\n                        onClick={() => {\n                          if (staticNotebook) {\n                            handleDownload(\n                              `${axios.defaults.baseURL}${notebookPath}`,\n                              `${notebookTitle}.html`\n                            );\n                          } else {\n                            runDownloadHTML();\n\n                            //handleDownload(\n                            //  `${axios.defaults.baseURL}${notebookPath}`,\n                            //</li>  `${notebookTitle}.html`\n                            //);\n                          }\n                        }}\n                      >\n                        <i className=\"fa fa-file-code-o\" aria-hidden=\"true\"></i>{\" \"}\n                        Download as HTML\n                      </a>\n                    </li>\n                    <li>\n                      <hr className=\"dropdown-divider\" />\n                    </li>\n                    <li>\n                      <button\n                        type=\"button\"\n                        className=\"dropdown-item\"\n                        onClick={() => {\n                          if (staticNotebook) {\n                            dispatch(exportToPDF(notebookId, notebookPath));\n                          } else {\n                            dispatch(setExportingToPDF(true));\n                            runDownloadPDF();\n                          }\n                        }}\n                      >\n                        <i className=\"fa fa-file-pdf-o\" aria-hidden=\"true\"></i>{\" \"}\n                        Download as PDF\n                      </button>\n                    </li>\n                  </ul>\n                </div>\n              </div>\n\n              {/* {fileKeys && !allFilesUploaded() && (\n                <div className=\"alert alert-danger mb-3\" role=\"alert\">\n                  <i className=\"fa fa-file\" aria-hidden=\"true\"></i> Please\n                  upload all required files.\n                </div>\n              )} */}\n\n              {/* {notebookTitle === \"Please provide title\" && (\n                <div className=\"alert alert-warning mb-3\" role=\"alert\">\n                  <i\n                    className=\"fa fa-exclamation-triangle\"\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  <b>\n                    Please add YAML config to your notebook as a first raw cell.\n                  </b>\n                  <br />\n                  <br />\n                  Example:\n                  <pre>\n                    ---\n                    <br />\n                    title: Report title\n                    <br />\n                    author: Your name\n                    <br />\n                    description: My amazing report\n                    <br />\n                    ---\n                  </pre>\n                  <button\n                    type=\"button\"\n                    className=\"btn btn-primary\"\n                    onClick={() =>\n                      window.open(\n                        \"https://github.com/mljar/mercury#convert-notebook-to-web-app-with-yaml\",\n                        \"_blank\"\n                      )\n                    }\n                  >\n                    <i className=\"fa fa-book\" aria-hidden=\"true\"></i> Read more\n                  </button>\n                </div>\n              )} */}\n\n              {notebookSchedule !== \"\" && (\n                <div className=\"alert alert-success mb-3\" role=\"alert\">\n                  <p>\n                    <i className=\"fa fa-clock-o\" aria-hidden=\"true\"></i>{\" \"}\n                    Scheduled notebook at '{notebookSchedule}'.\n                  </p>\n\n                  {taskCreatedAt && (\n                    <p>\n                      {\" \"}\n                      <i className=\"fa fa-calendar\" aria-hidden=\"true\"></i> Last\n                      execution at {taskCreatedAt}.\n                    </p>\n                  )}\n                  <div>\n                    <i className=\"fa fa-refresh\" aria-hidden=\"true\"></i> Website\n                    refresh every minute.\n                  </div>\n                </div>\n              )}\n\n              {continuousUpdate && (\n                <div>\n                  {/* add some space */}\n                  <br />\n                </div>\n              )}\n\n              {/* {waiting && workerState === WorkerState.Busy && (\n                <div className=\"alert alert-success mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-cogs\" aria-hidden=\"true\"></i> Notebook is\n                  executed. Please wait.\n                </div>\n              )} */}\n\n              {waiting &&\n                (workerState === WorkerState.Unknown ||\n                  workerState === WorkerState.Queued) && (\n                  <div className=\"alert alert-warning mb-3 mt-3\" role=\"alert\">\n                    <i className=\"fa fa-cogs\" aria-hidden=\"true\"></i> Waiting\n                    for worker ...\n                  </div>\n                )}\n              {waiting && workerState === WorkerState.Starting && (\n                <div className=\"alert alert-success mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-cogs\" aria-hidden=\"true\"></i> Initializing\n                  worker ...\n                </div>\n              )}\n              {watchMode && (\n                <div className=\"alert alert-secondary mb-3 mt-3\" role=\"alert\">\n                  <i className=\"fa fa-refresh\" aria-hidden=\"true\"></i> Notebook\n                  in watch mode. All changes to Notebook will be automatically\n                  visible in Mercury.\n                </div>\n              )}\n\n              {isPresentation && (\n                <div className=\"alert alert-primary mb-3\" role=\"alert\">\n                  <i className=\"fa fa-television\" aria-hidden=\"true\"></i> Click\n                  on presentation and press <b>F</b> for full screen. Press{\" \"}\n                  <b>Esc</b> to quit.\n                  <br />\n                  <br />\n                  <i className=\"fa fa-arrows\" aria-hidden=\"true\"></i> Click on\n                  presentation and press <b>Esc</b> to navigate slides.\n                </div>\n              )}\n\n              {/* {notebookParseErrors && (\n                <div className=\"alert alert-danger mb-3\" role=\"alert\">\n                  <i\n                    className=\"fa fa-exclamation-circle\"\n                    aria-hidden=\"true\"\n                  ></i>{\" \"}\n                  <b>Errors in the YAML</b>\n                  <br />\n                  {notebookParseErrors}\n                </div>\n              )} */}\n            </form>\n          </div>\n\n          {/* <hr style={{ marginTop: \"20px\", marginBottom: \"20px\" }} />\n          <div>\n            {!watchMode && <SelectExecutionHistory disabled={waiting} displayNb={displayNb} />}\n            {!staticNotebook && (\n              <div>\n                <button\n                  className=\"btn btn-sm btn-outline-primary\"\n                  onClick={() => {\n                    saveNb();\n                  }}\n                  style={{ border: \"none\" }}\n                  disabled={waiting}\n                  title=\"Click to save current run\"\n                >\n                  <i className=\"fa fa-floppy-o\" aria-hidden=\"true\"></i> Save run\n                </button>\n                <button\n                  className=\"btn btn-sm btn-outline-danger\"\n                  onClick={() => {\n                    dispatch(clearTasks(notebookId));\n                    dispatch(fetchNotebook(notebookId));\n                  }}\n                  style={{ border: \"none\" }}\n                  disabled={waiting}\n                  title=\"Click to clear all previous runs of the notebook\"\n                >\n                  <i className=\"fa fa-times-circle\" aria-hidden=\"true\"></i>{\" \"}\n                  Delete runs\n                </button>\n              </div>\n            )}\n          </div>\n           */}\n          {showFiles && (\n            <div>\n              <hr />\n              <button\n                className=\"btn btn-sm btn-outline-secondary\"\n                style={{\n                  border: \"none\",\n                  //fontWeight: 500,\n                }}\n                onClick={() => {\n                  dispatch(setView(\"app\"));\n                }}\n              >\n                <i className=\"fa fa-laptop\" aria-hidden=\"true\"></i> App\n              </button>\n\n              <button\n                className=\"btn btn-sm btn-outline-secondary\"\n                style={{\n                  border: \"none\",\n                  //fontWeight: 500,\n                }}\n                onClick={() => {\n                  dispatch(setView(\"files\"));\n                }}\n              >\n                <i className=\"fa fa-folder-open-o\" aria-hidden=\"true\"></i>{\" \"}\n                Output Files\n              </button>\n            </div>\n          )}\n          {notebookId !== undefined && !staticNotebook && (\n            <div>\n              <hr />\n              <div style={{ paddingLeft: \"10px\" }}>\n                <WebSocketStateBar />{\" \"}\n              </div>\n            </div>\n          )}\n        </div>\n      </BlockUi>\n    </nav>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect } from \"react\";\nimport axios from \"axios\";\nimport useWindowDimensions from \"./WindowDimensions\";\n\nimport BlockUi from \"react-block-ui\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { getNotebookSrc, setNotebookSrc } from \"../websocket/wsSlice\";\n\nimport InnerHTML from \"dangerously-set-html-content\";\nimport { getSelectedNotebook } from \"./Notebooks/notebooksSlice\";\n\ntype MainViewProps = {\n  appView: string;\n  loadingState: string;\n  notebookPath: string;\n  waiting: boolean;\n  errorMsg: string;\n  watchMode: boolean;\n  displayEmbed: boolean;\n  isPro: boolean;\n  username: string;\n  slidesHash: string;\n  columnsWidth: number;\n  isPresentation: boolean;\n};\n\nexport default function MainView({\n  appView,\n  loadingState,\n  notebookPath,\n  waiting,\n  errorMsg,\n  watchMode,\n  displayEmbed,\n  isPro,\n  username,\n  slidesHash,\n  columnsWidth,\n  isPresentation,\n}: MainViewProps) {\n  const { height } = useWindowDimensions();\n\n  const iframeHeight = displayEmbed ? height - 10 : height - 58;\n  const dispatch = useDispatch();\n  let nb = useSelector(getSelectedNotebook);\n  let notebookSrc = useSelector(getNotebookSrc);\n\n  let showCode = false;\n  if (nb !== undefined && nb.params !== undefined) {\n    if (\n      nb.params[\"show-code\"] !== undefined &&\n      nb.params[\"show-code\"] !== null\n    ) {\n      showCode = nb.params[\"show-code\"];\n    }\n  }\n\n  if (notebookSrc !== \"\" && !isPresentation) {\n    notebookSrc = \"<script>init_mathjax();</script>\" + notebookSrc;\n\n    if (!showCode) {\n      const hideCodeStyle = `<style type=\"text/css\">\n      .jp-mod-noOutputs {\n          padding: 0px; \n      }\n      .jp-mod-noInput {\n        padding-top: 0px;\n        padding-bottom: 0px;\n      }\n      </style>`;\n      notebookSrc = hideCodeStyle + notebookSrc;\n    }\n  }\n\n  if (notebookSrc !== \"\" && isPresentation && slidesHash !== \"\") {\n    if (notebookSrc.indexOf(\"Reveal.slide(\") === -1) {\n      const splitted = slidesHash.split(\"/\");\n      let injectCode = \"\";\n      if (splitted.length === 4) {\n        injectCode = `Reveal.slide(${splitted[1]}, ${splitted[2]}, ${splitted[3]});`;\n      } else if (splitted.length === 3) {\n        injectCode = `Reveal.slide(${splitted[1]}, ${splitted[2]});`;\n      } else if (splitted.length === 2) {\n        injectCode = `Reveal.slide(${splitted[1]});`;\n      }\n\n      if (injectCode !== \"\") {\n        notebookSrc = notebookSrc.replace(\n          \"setScrollingSlide);\",\n          `setScrollingSlide); try{ ${injectCode} } catch(error) {}`\n        );\n      }\n    }\n  }\n\n  useEffect(() => {\n    if (notebookPath !== undefined) {\n      axios\n        .get(`${axios.defaults.baseURL}${notebookPath}${slidesHash}`)\n        .then((response) => {\n          let nbSrc = response.data;\n          if (!isPresentation) {\n            nbSrc = nbSrc.replace(/<head>[\\s\\S]*?<\\/head>/, \"\");\n            nbSrc = nbSrc.replace(\"<html>\", \"\");\n            nbSrc = nbSrc.replace(\"</html>\", \"\");\n            nbSrc = nbSrc.replace(\"<body\", \"<div\");\n            nbSrc = nbSrc.replace(\"</body>\", \"</div>\");\n            nbSrc = nbSrc.replace(\"<!DOCTYPE html>\", \"\");\n          }\n          dispatch(setNotebookSrc(nbSrc));\n        });\n    }\n  }, [dispatch, notebookPath, slidesHash, isPresentation]);\n\n  let mainStyle = {\n    paddingTop: \"0px\",\n    paddingRight: \"0px\",\n    paddingLeft: \"0px\",\n    display: appView === \"files\" ? \"none\" : \"block\",\n  };\n\n  return (\n    <main className={`ms-sm-auto col-lg-${columnsWidth}`} style={mainStyle}>\n      <BlockUi tag=\"div\" blocking={waiting}>\n        <div>\n          {loadingState === \"loading\" && !watchMode && (\n            <p>Loading notebook. Please wait ...</p>\n          )}\n          {loadingState === \"error\" && !isPro && (\n            <p style={{ margin: \"20px\" }}>\n              Problem while loading notebook. Please try again later or contact\n              Mercury administrator.\n            </p>\n          )}\n\n          {loadingState === \"error\" && isPro && username === \"\" && (\n            <p style={{ margin: \"20px\" }}>\n              <h5>Please log in to see the notebook</h5>\n              <a href=\"/login\" className=\"btn btn-primary btn-sm \">\n                <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n              </a>\n            </p>\n          )}\n\n          {loadingState === \"error\" && isPro && username !== \"\" && (\n            <p style={{ margin: \"20px\" }}>\n              Problem while loading notebook. Please try again later or contact\n              Mercury administrator.\n            </p>\n          )}\n          {/* {waiting && (\n          <div className=\"alert alert-primary mb-3\" role=\"alert\">\n            Notebook is executed. Default notebook is presented below. New\n            results will be loaded after execution.{\" \"}\n            <i className=\"fa fa-coffee\" aria-hidden=\"true\"></i> Please wait ...\n          </div>\n        )} */}\n          {errorMsg && (\n            <div className=\"alert alert-danger mb-3\" role=\"alert\">\n              <b>Notebook is executed with errors.</b>\n              <p>{errorMsg}</p>\n            </div>\n          )}\n\n          {/* {errorMsg === \"\" &&\n            loadingState !== \"loading\" &&\n            isPresentation && (\n              <iframe\n                width=\"100%\"\n                height={iframeHeight}\n                key={notebookPath}\n                src={`${axios.defaults.baseURL}${notebookPath}${slidesHash}`}\n                title=\"display\"\n                id=\"main-iframe\"\n              ></iframe>\n            )}  */}\n\n          {errorMsg === \"\" &&\n            loadingState !== \"loading\" &&\n            isPresentation &&\n            notebookSrc !== \"\" && (\n              <iframe\n                width=\"100%\"\n                height={iframeHeight}\n                key={notebookPath}\n                srcDoc={notebookSrc}\n                title=\"display\"\n                id=\"main-iframe\"\n                onError={() => {\n                  console.log(\"iframe error\");\n                }}\n              ></iframe>\n            )}\n\n          {notebookSrc !== \"\" && !isPresentation && (\n            <InnerHTML html={notebookSrc} />\n          )}\n        </div>\n      </BlockUi>\n    </main>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchCurrentTask } from \"../tasks/tasksSlice\";\n\nimport {\n  fetchNotebook,\n  getSelectedNotebook,\n  getWatchModeCounter,\n} from \"./Notebooks/notebooksSlice\";\n\ntype Props = {\n  notebookId: number;\n};\n\nfunction WatchMode({ notebookId }: Props) {\n  const dispatch = useDispatch();\n  const notebook = useSelector(getSelectedNotebook);\n  const watchModeCounter = useSelector(getWatchModeCounter);\n\n  useEffect(() => {\n    if (\n      notebook.state === \"WATCH_READY\" ||\n      notebook.state === \"WATCH_WAIT\" ||\n      notebook.state === \"WATCH_ERROR\"\n    ) {\n      setTimeout(() => {\n        dispatch(fetchNotebook(notebookId, true));\n        dispatch(fetchCurrentTask(notebookId));\n      }, 2000);\n    }\n  }, [dispatch, notebook, notebookId, watchModeCounter]);\n\n  return <div></div>;\n}\n\nconst WatchModeComponent = WatchMode;\nexport default WatchModeComponent;\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport axios from \"axios\";\nimport fileDownload from \"js-file-download\";\nimport BlockUi from \"react-block-ui\";\nimport { setView } from \"../views/appSlice\";\n\ntype FilesViewProps = {\n  files: string[];\n  filesState: string;\n  waiting: boolean;\n};\n\nexport default function FilesView({\n  files,\n  filesState,\n  waiting,\n}: FilesViewProps) {\n  const dispatch = useDispatch();\n\n  const handleDownload = (url: string, filename: string) => {\n    axios\n      .get(url, {\n        responseType: \"blob\",\n      })\n      .then((res) => {\n        fileDownload(res.data, filename);\n      });\n  };\n\n  let filesLinks = [];\n\n  for (let f of files) {\n    let fname = f.split(\"/\").pop();\n    if (f && fname) {\n      filesLinks.push(\n        <div key={f}>\n          <i\n            className=\"fa fa-file-text-o\"\n            aria-hidden=\"true\"\n            style={{ paddingRight: \"5px\" }}\n          ></i>{\" \"}\n          <b>{fname}</b>\n          <button\n            style={{ float: \"right\" }}\n            type=\"button\"\n            className=\"btn btn-primary\"\n            onClick={() =>\n              handleDownload(`${axios.defaults.baseURL}${f}`, fname!)\n            }\n          >\n            <i className=\"fa fa-download\" aria-hidden=\"true\"></i> Download\n          </button>\n          <hr />\n        </div>\n      );\n    }\n  }\n\n  return (\n    <main className=\"col-md-9 ms-sm-auto col-lg-9\" style={{ padding: \"20px\" }}>\n      <div className=\"col-8\">\n        <h3 style={{ paddingBottom: \"10px\" }}>\n          <i className=\"fa fa-folder-open-o\" aria-hidden=\"true\"></i> Output Files\n        </h3>\n        <BlockUi tag=\"div\" blocking={waiting}>\n          <div>\n            {filesState === \"loaded\" && filesLinks}\n            {filesState === \"unknown\" && (\n              <p>Please run the notebook to produce output files ...</p>\n            )}\n            {filesState === \"loading\" && <p>Loading files please wait ...</p>}\n            {filesState === \"error\" && (\n              <div className=\"alert alert-danger mb-3\" role=\"alert\">\n                There was an error during loading files. Please try to run the\n                app again or contact the administrator.\n              </div>\n            )}\n          </div>\n        </BlockUi>\n      </div>\n\n      <button\n        className=\"btn btn-secondary btn-sm\"\n        // style={{ background: \"transparent\", border: \"none\", fontSize: \"0.9em\" }}\n        onClick={() => {\n          dispatch(setView(\"app\"));\n        }}\n      >\n        <i className=\"fa fa-arrow-left\" aria-hidden=\"true\"></i> Back to App\n      </button>\n    </main>\n  );\n}\n","import React from \"react\";\n\nexport default function MadeWithDiv() {\n  return (\n    <a href=\"https://runmercury.com\" target=\"_blank\" rel=\"noreferrer\">\n      <div className=\"poweredby\">\n        <div className=\"text-center\">\n          {\" \"}\n          <b style={{ fontSize: \"0.9em\" }}>created with</b>{\" \"}\n        </div>\n        <div>\n          <img\n            alt=\"Mercury\"\n            src={\n              process.env.PUBLIC_URL +\n              process.env.REACT_APP_LOCAL_URL +\n              \"/mercury_black_logo.svg\"\n            }\n            style={{ height: \"27px\" }}\n          />\n        </div>\n      </div>\n    </a>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport axios from \"axios\";\nimport { IWidget } from \"./Widgets/Types\";\nimport { useSelector } from \"react-redux\";\nimport { getWidgetsValues } from \"./Notebooks/notebooksSlice\";\n\ntype Props = {\n  slug: string;\n  widgetsParams: Record<string, IWidget>;  \n  notebookPath: string;\n  columnsWidth: number;\n  taskSessionId: string | undefined;\n};\n\nexport default function RestAPIView({\n  slug,\n  widgetsParams,\n  notebookPath,\n  columnsWidth,\n  taskSessionId,\n}: Props) {\n  const [response, setResponse] = useState(\n    JSON.stringify({ msg: \"Example output\" })\n  );\n  const widgetsValues = useSelector(getWidgetsValues);\n\n  let examplePostData = {} as Record<\n    string,\n    | string\n    | number\n    | null\n    | undefined\n    | boolean\n    | [number, number]\n    | string[]\n    | unknown\n  >;\n  for (let [key, widgetParams] of Object.entries(widgetsParams)) {\n    if (widgetParams.input) {\n      examplePostData[key] = widgetsValues[key];\n    }\n  }\n\n  async function fetchResponse() {\n    try {\n      const { data } = await axios.get(`get/${taskSessionId}`);\n      setResponse(JSON.stringify(data));\n    } catch (error) {}\n  }\n\n  useEffect(() => {\n    if (taskSessionId) {\n      fetchResponse();\n    }\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, [taskSessionId, notebookPath]);\n\n  let sessionId = \"id-with-some-random-string\";\n  if (taskSessionId) {\n    sessionId = taskSessionId;\n  }\n\n  let postRequest = `curl -X POST -H \"Content-Type: application/json\" -d '${JSON.stringify(\n    examplePostData\n  )}' ${axios.defaults.baseURL}/run/${slug}`;\n  return (\n    <div\n      className={`ms-sm-auto col-lg-${columnsWidth}`}\n      style={{\n        border: \"none\",\n        paddingTop: \"0px\",\n        paddingRight: \"0px\",\n        paddingLeft: \"0px\",\n        padding: \"10px\",\n      }}\n    >\n      <h4>Notebook as REST API</h4>\n      <p>\n        This notebook can be executed as REST API. Please see the examples below\n        on how to access the notebook.\n      </p>\n\n      <div className=\"alert alert-secondary\" role=\"alert\">\n        <h5>POST request to execute the notebook</h5>\n        <textarea\n          disabled\n          style={{ width: \"100%\" }}\n          rows={3}\n          value={postRequest}\n        ></textarea>\n        The above request should return a JSON with `id`. The `id` should be\n        used in the GET request to fetch the result.\n        <br />\n        Example response:\n        <pre>{`{\"id\": \"${sessionId}\"}`}</pre>\n      </div>\n      <div className=\"alert alert-secondary\" role=\"alert\">\n        <h5>GET request to get execution result in JSON</h5>\n        <textarea\n          disabled\n          style={{ width: \"100%\" }}\n          rows={1}\n          value={`curl ${axios.defaults.baseURL}/get/${sessionId}`}\n        ></textarea>\n      </div>\n\n      <div className=\"alert alert-primary\" role=\"alert\">\n        <h5>Response</h5>\n        <pre>{response}</pre>\n      </div>\n    </div>\n  );\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { fetchCurrentTask } from \"../tasks/tasksSlice\";\n\nimport { fetchNotebook, getSelectedNotebook } from \"./Notebooks/notebooksSlice\";\n\ntype Props = {\n  notebookId: number;\n};\n\nexport default function AutoRefresh({ notebookId }: Props) {\n  const dispatch = useDispatch();\n  const notebook = useSelector(getSelectedNotebook);\n\n  useEffect(() => {\n    setTimeout(() => {\n      dispatch(fetchNotebook(notebookId, true));\n      dispatch(fetchCurrentTask(notebookId));\n    }, 60000); // every 1 minute\n  }, [dispatch, notebookId, notebook]);\n\n  return <div></div>;\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { toast } from \"react-toastify\";\nimport { getExportingToPDF, getExportToPDFCounter, getExportToPDFJobId, getPDF, stopPDFExport } from \"../tasks/tasksSlice\";\n\nexport default function WaitPDFExport() {\n  const dispatch = useDispatch();\n  const counter = useSelector(getExportToPDFCounter);\n  const jobId = useSelector(getExportToPDFJobId);\n  const exportingPDF = useSelector(getExportingToPDF);\n\n  useEffect(() => {\n    if(jobId === '') {\n      return;\n    } \n    if(!exportingPDF) {\n      return;\n    }\n    // raise error after 2 minutes of waiting ...\n    if (counter < 120) {\n      setTimeout(() => {\n        dispatch(getPDF(jobId));\n      }, 1000); // every 1 second\n    } else {\n      dispatch(stopPDFExport());\n      toast.error(\"Problem with PDF export. Please try again later or ask your admin for help.\", { autoClose: 6000 })\n    }\n  }, [dispatch, counter, jobId, exportingPDF]);\n\n  return <div></div>;\n}\n","import React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport \"./App.css\";\nimport NavBar from \"../components/NavBar\";\nimport SideBar from \"../components/SideBar\";\nimport MainView from \"../components/MainView\";\n\nimport {\n  fetchNotebook,\n  getLoadingStateSelected,\n  getSelectedNotebook,\n  getSlidesHash,\n  // getWatchModeCounter,\n} from \"../components/Notebooks/notebooksSlice\";\nimport {\n  //fetchCurrentTask,\n  //fetchExecutionHistory,\n  getCurrentTask,\n  getExportingToPDF,\n  getHistoricTask,\n  getPreviousTask,\n  //ITask,\n  //setPreviousTask,\n} from \"../tasks/tasksSlice\";\nimport WatchModeComponent from \"../components/WatchMode\";\nimport { isOutputFilesWidget, IWidget } from \"../components/Widgets/Types\";\nimport {\n  fetchWorkerOutputFiles,\n  getOutputFiles,\n  getOutputFilesState,\n  getShowSideBar,\n  getView,\n  setShowSideBar,\n} from \"./appSlice\";\nimport FilesView from \"../components/FilesView\";\nimport { getToken, getUsername } from \"../components/authSlice\";\nimport { getIsPro } from \"../components/versionSlice\";\nimport MadeWithDiv from \"../components/MadeWithDiv\";\nimport RestAPIView from \"../components/RestAPIView\";\nimport AutoRefresh from \"../components/AutoRefresh\";\nimport BlockUi from \"react-block-ui\";\nimport WaitPDFExport from \"../components/WaitPDFExport\";\nimport { getWorkerId, getWorkerState, WorkerState } from \"../websocket/wsSlice\";\n\ntype AppProps = {\n  isSingleApp: boolean;\n  notebookId: number;\n  displayEmbed: boolean;\n};\n\nfunction App({ isSingleApp, notebookId, displayEmbed }: AppProps) {\n  const dispatch = useDispatch();\n  const notebook = useSelector(getSelectedNotebook);\n  const loadingState = useSelector(getLoadingStateSelected);\n  const task = useSelector(getCurrentTask);\n  const historicTask = useSelector(getHistoricTask);\n  const previousTask = useSelector(getPreviousTask);\n  const appView = useSelector(getView);\n  const outputFiles = useSelector(getOutputFiles);\n  const outputFilesState = useSelector(getOutputFilesState);\n  const isPro = useSelector(getIsPro);\n  const username = useSelector(getUsername);\n  const token = useSelector(getToken);\n  const slidesHash = useSelector(getSlidesHash);\n  const showSideBar = useSelector(getShowSideBar);\n  const exportingToPDF = useSelector(getExportingToPDF);\n  const workerId = useSelector(getWorkerId);\n  const workerState = useSelector(getWorkerState);\n\n  // const waitForTask = () => {\n  //   if (task.state && task.state === \"CREATED\") return true;\n  //   if (task.state && task.state === \"RECEIVED\") return true;\n  //   return false;\n  // };\n\n  const pleaseWait = () => {\n    if (notebook?.params?.static_notebook) {\n      return false;\n    }\n    return workerState !== WorkerState.Running;\n  };\n\n  const isWatchMode = () => {\n    return (\n      notebook.state === \"WATCH_READY\" ||\n      notebook.state === \"WATCH_WAIT\" ||\n      notebook.state === \"WATCH_ERROR\"\n    );\n  };\n\n  useEffect(() => {\n    dispatch(fetchNotebook(notebookId));\n    //dispatch(fetchCurrentTask(notebookId));\n    //dispatch(fetchExecutionHistory(notebookId));\n    //dispatch(setPreviousTask({} as ITask));\n  }, [dispatch, notebookId, token]);\n\n  // useEffect(() => {\n  //   if (waitForTask()) {\n  //     setTimeout(() => {\n  //       dispatch(fetchCurrentTask(notebookId));\n  //       dispatch(fetchExecutionHistory(notebookId, false));\n  //     }, 1000);\n  //   }\n  //   // eslint-disable-next-line react-hooks/exhaustive-deps\n  // }, [dispatch, task, notebookId]);\n\n  // useEffect(() => {\n  //   if (isWatchMode()) {\n  //     setTimeout(() => {\n  //       dispatch(fetchNotebook(notebookId));\n  //     }, 2000);\n  //   }\n  //   // eslint-disable-next-line react-hooks/exhaustive-deps\n  // }, [dispatch, notebook, watchModeCounter]);\n\n  // version 1\n  // useEffect(() => {\n  //   if (\n  //     appView === \"files\" &&\n  //     task.id &&\n  //     task.state &&\n  //     task.state === \"DONE\" &&\n  //     task.result &&\n  //     notebook?.params?.version === \"1\"\n  //   ) {\n  //     dispatch(fetchOutputFiles(task.id));\n  //   }\n  // }, [dispatch, appView, task.id, task.state, task.result, notebook]);\n\n  // version 2\n  useEffect(() => {\n    if (\n      appView === \"files\" &&\n      notebook?.params?.version === \"2\" &&\n      workerId !== undefined\n    ) {\n      dispatch(fetchWorkerOutputFiles(workerId));\n    }\n  }, [dispatch, appView, notebook, workerId]);\n\n  let notebookPath = notebook.default_view_path;\n  if (task.state && task.state === \"DONE\" && task.result) {\n    notebookPath = task.result;\n  }\n  let errorMsg = \"\";\n  if (task.state && task.result && task.state === \"ERROR\") {\n    errorMsg = task.result;\n  }\n\n  // set historic task to display if available\n  if (\n    historicTask.state &&\n    historicTask.state === \"DONE\" &&\n    historicTask.result\n  ) {\n    notebookPath = historicTask.result;\n  }\n  if (\n    historicTask.state &&\n    historicTask.result &&\n    historicTask.state === \"ERROR\"\n  ) {\n    errorMsg = historicTask.result;\n  }\n\n  // if we have previous task to show, just show it\n  if (\n    notebookPath === notebook.default_view_path &&\n    previousTask.state &&\n    previousTask.state === \"DONE\" &&\n    previousTask.result\n  ) {\n    notebookPath = previousTask.result;\n  }\n\n  const areOutputFilesAvailable = (\n    widgetsParams: Record<string, IWidget>\n  ): boolean => {\n    if (widgetsParams) {\n      for (let [, widgetParams] of Object.entries(widgetsParams)) {\n        if (isOutputFilesWidget(widgetParams)) {\n          return true;\n        }\n      }\n    }\n    return false;\n  };\n\n  let showRestApi = false;\n  if (notebook.output && notebook.output.toLowerCase().startsWith(\"rest\")) {\n    showRestApi = true;\n  }\n\n  return (\n    <div className=\"App\">\n      {!displayEmbed && <NavBar isPro={isPro} username={username} />}\n      <BlockUi\n        blocking={exportingToPDF}\n        message=\"Exporting to PDF. Please wait ...\"\n      >\n        {exportingToPDF && <WaitPDFExport />}\n        <div className=\"container-fluid\">\n          <div className=\"row\">\n            <WatchModeComponent notebookId={notebookId} />\n\n            {notebook.schedule !== undefined && notebook.schedule !== \"\" && (\n              <AutoRefresh notebookId={notebookId} />\n            )}\n\n            {showSideBar && (\n              <SideBar\n                notebookTitle={notebook.title}\n                notebookId={notebookId}\n                notebookSchedule={notebook.schedule}\n                taskCreatedAt={task.created_at}\n                loadingState={loadingState}\n                waiting={pleaseWait()} // {waitForTask()}\n                widgetsParams={notebook?.params?.params}\n                watchMode={isWatchMode()}\n                notebookPath={notebookPath}\n                displayEmbed={displayEmbed}\n                showFiles={areOutputFilesAvailable(notebook?.params?.params)}\n                isPresentation={\n                  notebook.output !== undefined && notebook.output === \"slides\"\n                }\n                notebookParseErrors={notebook.errors}\n                continuousUpdate={notebook?.params?.continuous_update}\n                staticNotebook={notebook?.params?.static_notebook}\n              />\n            )}\n\n            {!showSideBar && (\n              <div>\n                <button\n                  className=\"btn btn-sm  btn-outline-primary\"\n                  type=\"button\"\n                  style={{\n                    position: \"absolute\",\n                    top: displayEmbed ? \"5px\" : \"50px\",\n                    left: \"5px\",\n                    zIndex: \"100\",\n                  }}\n                  onClick={() => dispatch(setShowSideBar(true))}\n                  data-toggle=\"tooltip\"\n                  data-placement=\"right\"\n                  title=\"Show sidebar\"\n                >\n                  <i className=\"fa fa-chevron-right\" aria-hidden=\"true\" />\n                </button>\n              </div>\n            )}\n\n            {showRestApi && (\n              <RestAPIView\n                slug={notebook.slug}\n                widgetsParams={notebook?.params?.params}\n                notebookPath={notebookPath}\n                columnsWidth={showSideBar ? 9 : 12}\n                taskSessionId={task.session_id}\n              />\n            )}\n\n            <MainView\n              appView={appView}\n              loadingState={loadingState}\n              notebookPath={notebookPath}\n              errorMsg={errorMsg}\n              waiting={pleaseWait()} // {waitForTask()}\n              watchMode={isWatchMode()}\n              displayEmbed={displayEmbed}\n              isPro={isPro}\n              username={username}\n              slidesHash={slidesHash}\n              columnsWidth={showSideBar ? 9 : 12}\n              isPresentation={\n                notebook.output !== undefined && notebook.output === \"slides\"\n              }\n            />\n\n            {appView === \"files\" && (\n              <FilesView\n                files={outputFiles}\n                filesState={outputFilesState}\n                waiting={pleaseWait()} // {waitForTask()}\n              />\n            )}\n          </div>\n        </div>\n      </BlockUi>\n      {displayEmbed && <MadeWithDiv />}\n    </div>\n  );\n}\n\nconst AppView = App;\nexport default AppView;\n","import { useParams, withRouter } from \"react-router-dom\";\nimport AppView from \"./AppView\";\n\nimport WebSocketProvider from \"../websocket/Provider\";\n\nfunction MyApp() {\n  const { notebook_id } = useParams<{ notebook_id: string }>();\n  const notebookId = Number(notebook_id);\n\n  const { embed } = useParams<{ embed: string }>();\n  const displayEmbed = !!(embed && embed === \"embed\");\n\n  return (\n    <WebSocketProvider>\n      <AppView\n        isSingleApp={false}\n        notebookId={notebookId}\n        displayEmbed={displayEmbed}\n      />\n    </WebSocketProvider>\n  );\n}\n\nconst App = withRouter(MyApp);\nexport default App;\n","import React from \"react\";\n\nexport default function Footer() {\n  return (\n    <footer\n      className=\"footer\"\n      style={{\n        position: \"absolute\",\n        bottom: \"0\",\n        width: \"100%\",\n        height: \"40px\",\n        lineHeight: \"40px\",\n        backgroundColor: \"#f5f5f5\",\n        borderTop: \"1px solid #e5e5e5\",\n      }}\n    >\n      <div className=\"container\">\n        <span className=\"text-muted\" style={{ color: \"gray\" }}>\n          Mercury ©{\" \"}\n          <a\n            style={{ textDecoration: \"none\", color: \"gray\" }}\n            href=\"https://mljar.com\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            MLJAR\n          </a>\n        </span>\n        <span className=\"text-muted\" style={{ float: \"right\" }}>\n          \n          <a\n            style={{ textDecoration: \"none\", color: \"gray\" }}\n            href=\"https://github.com/mljar/mercury\"\n            target=\"_blank\"\n            rel=\"noreferrer\"\n          >\n            Mercury\n          </a>\n          {\" \"}\n          <i className=\"fa fa-github\" aria-hidden=\"true\"></i>\n        </span>\n      </div>\n    </footer>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React from \"react\";\nimport LoginButton from \"./LoginButton\";\nimport UserButton from \"./UserButton\";\n\ntype NavBarProps = {\n  isPro: boolean;\n  username: string;\n};\n\nexport default function NavBar({ isPro, username }: NavBarProps) {\n  return (\n    <header\n      className=\"navbar navbar-dark sticky-top bg-dark p-0\"\n    >\n      <div className=\"row\" style={{ width: \"100%\", paddingRight: \"0px\" }}>\n        <div className=\"col-4\"></div>\n        <div className=\"col-4 text-center\">\n          <a href=\"/\">\n            <img\n              alt=\"Mercury\"\n              src={\n                process.env.PUBLIC_URL +\n                process.env.REACT_APP_LOCAL_URL +\n                \"/mercury_logo.svg\"\n              }\n              style={{ height: \"40px\" }}\n            />\n          </a>\n        </div>\n        <div\n          className=\"col-4\"\n          style={{ marginRight: \"0px\", paddingRight: \"0px\" }}\n        >\n          {isPro && username === \"\" && <LoginButton />}\n          {isPro && username !== \"\" && <UserButton username={username} />}\n        </div>\n      </div>\n    </header>\n  );\n}\n","import React from \"react\";\n\ntype ProFeatureProps = {\n  featureName: string;\n};\n\nexport default function ProFeatureAlert({ featureName }: ProFeatureProps) {\n  return (\n    <div style={{ padding: \"40px\" }}>\n      <div className=\"alert alert-primary mb-3\" role=\"alert\">\n        <h5>\n          <i className=\"fa fa-info-circle\" aria-hidden=\"true\"></i> This is a Pro\n          feature{\" \"}\n        </h5>\n        You are using an open-source version of the Mercury framework. The{' '} \n        {featureName} is a Pro feature available only for commercial users.\n        Please consider purchasing the Mercury commercial license. It is\n        perpetual and comes with additional features, dedicated support, and\n        allows white-labeling. You can learn more about available licenses on\n        our{\" \"}\n        <a href=\"https://mljar.com/pricing\" target=\"_blank\" rel=\"noreferrer\">\n          website\n        </a>\n        .\n        <br />\n        <br />\n        <br />\n        <a href=\"/\">\n          <i className=\"fa fa-home\" aria-hidden=\"true\" /> Back to home\n        </a>\n      </div>\n    </div>\n  );\n}\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect, useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport {\n  changePassword,\n  fetchUserInfo,\n  getUserInfo,\n  getUsername,\n} from \"../components/authSlice\";\nimport Footer from \"../components/Footer\";\nimport HomeNavBar from \"../components/HomeNavBar\";\nimport { getFetchingIsPro, getIsPro } from \"../components/versionSlice\";\nimport ProFeatureAlert from \"../components/ProFeatureAlert\";\n\nexport default withRouter(function AccountView() {\n  const dispatch = useDispatch();\n  const [oldPassword, setOldPassword] = useState(\"\");\n  const [newPassword1, setNewPassword1] = useState(\"\");\n  const [newPassword2, setNewPassword2] = useState(\"\");\n  const isPro = useSelector(getIsPro);\n  const fetchingIsPro = useSelector(getFetchingIsPro);\n  const username = useSelector(getUsername);\n  const user = useSelector(getUserInfo);\n\n  document.body.style.backgroundColor = \"white\";\n\n  useEffect(() => {\n    if (isPro) {\n      dispatch(fetchUserInfo());\n    }\n  }, [dispatch, isPro, fetchingIsPro]);\n\n  return (\n    <div className=\"App\">\n      <HomeNavBar isPro={isPro} username={username} />\n\n      {!isPro && !fetchingIsPro && (\n        <ProFeatureAlert featureName={\"account view\"} />\n      )}\n      {isPro && (\n        <div className=\"container\">\n          <div className=\"mx-auto\" style={{ width: \"700px\" }}>\n            <div className=\"row\" style={{ marginTop: \"40px\" }}>\n              <h2>\n                <i className=\"fa fa-user\" aria-hidden=\"true\"></i> Account\n              </h2>\n              <form>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">Username</label>\n                  <input\n                    className=\"form-control\"\n                    value={user.username}\n                    disabled\n                  />\n                </div>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">First name</label>\n                  <input\n                    className=\"form-control\"\n                    value={user.first_name}\n                    disabled\n                  />\n                </div>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">Last name</label>\n                  <input\n                    className=\"form-control\"\n                    value={user.last_name}\n                    disabled\n                  />\n                </div>\n\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">Email address</label>\n                  <input className=\"form-control\" value={user.email} disabled />\n                </div>\n              </form>\n            </div>\n            <hr />\n            <div className=\"row\">\n              <h2>\n                <i className=\"fa fa-key\" aria-hidden=\"true\"></i> Change password\n              </h2>\n              <div>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">Old password</label>\n                  <input\n                    type=\"password\"\n                    className=\"form-control\"\n                    value={oldPassword}\n                    onChange={(e) => setOldPassword(e.target.value)}\n                  />\n                </div>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">New password</label>\n                  <input\n                    type=\"password\"\n                    className=\"form-control\"\n                    value={newPassword1}\n                    onChange={(e) => setNewPassword1(e.target.value)}\n                  />\n                </div>\n                <div className=\"mb-3\">\n                  <label className=\"form-label\">Repeat new password</label>\n                  <input\n                    type=\"password\"\n                    className=\"form-control\"\n                    value={newPassword2}\n                    onChange={(e) => setNewPassword2(e.target.value)}\n                  />\n                </div>\n                <div className=\"mb-3\" style={{paddingBottom: \"50px\"}}>\n                  <button\n                    className=\"btn btn-primary\"\n                    onClick={() =>\n                      dispatch(\n                        changePassword(oldPassword, newPassword1, newPassword2)\n                      )\n                    }\n                    disabled={\n                      oldPassword === \"\" ||\n                      newPassword1 === \"\" ||\n                      newPassword2 === \"\"\n                    }\n                  >\n                    Change password\n                  </button>\n                </div>\n              </div>\n            </div>\n          </div>\n        </div>\n      )}\n      <Footer />\n    </div>\n  );\n});\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useEffect } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport axios from \"axios\";\nimport { withRouter } from \"react-router-dom\";\nimport HomeNavBar from \"../components/HomeNavBar\";\nimport Footer from \"../components/Footer\";\nimport {\n  fetchNotebooks,\n  getLoadingState,\n  getNotebooks,\n} from \"../components/Notebooks/notebooksSlice\";\nimport { fetchWelcome, getIsPro, getWelcome } from \"../components/versionSlice\";\n\nimport ReactMarkdown from \"react-markdown\";\nimport rehypeHighlight from \"rehype-highlight\";\nimport remarkGfm from \"remark-gfm\";\nimport emoji from \"remark-emoji\";\nimport rehypeRaw from \"rehype-raw\";\nimport { getToken, getUsername } from \"../components/authSlice\";\n\nexport default withRouter(function HomeView() {\n  const dispatch = useDispatch();\n  const notebooks = useSelector(getNotebooks);\n  const loadingState = useSelector(getLoadingState);\n  const welcome = useSelector(getWelcome);\n  const isPro = useSelector(getIsPro);\n  const username = useSelector(getUsername);\n  const token = useSelector(getToken);\n\n  useEffect(() => {\n    dispatch(fetchNotebooks());\n    dispatch(fetchWelcome());\n    // fetchNotebooks depends on token\n    // if token is set then private notebooks are returned\n  }, [dispatch, token]);\n\n  const firstLetters = (text: string | null, count: number): string => {\n    if (text !== null && text !== undefined) {\n      return text.slice(0, count) + (text.length > count ? \" ...\" : \"\");\n    }\n    return \"\";\n  };\n\n  const notebookItems = notebooks.map((notebook, index) => {\n    return (\n      <div\n        className=\"col-md-4\"\n        style={{ paddingBottom: \"20px\" }}\n        key={`notebook-${notebook.id}}`}\n      >\n        <div className=\"card\">\n          <div\n            style={{\n              height: \"200px\",\n              width: \"100%\",\n              padding: \"1px\",\n              overflow: \"hidden\",\n            }}\n          >\n            <iframe\n              className=\"thumbnailIframe\"\n              width=\"200%\"\n              height={800}\n              src={`${axios.defaults.baseURL}${notebook.default_view_path}`}\n              title=\"display\"\n              scrolling=\"no\"\n            ></iframe>\n          </div>\n          <a\n            href={`/app/${notebook.id}`}\n            style={{ textDecoration: \"none\", color: \"black\" }}\n            className=\"title-card\"\n          >\n            <div\n              className=\"card-body\"\n              style={{\n                borderTop: \"1px solid rgba(0,0,0,0.1)\",\n                height: \"110px\",\n              }}\n            >\n              <h5 className=\"card-title\">{firstLetters(notebook.title, 40)}</h5>\n\n              <p className=\"card-text\">\n                {firstLetters(notebook.params.description, 100)}\n              </p>\n\n              {/* <a href={`/app/${notebook.id}`} className=\"btn btn-primary\">\n              Open <i className=\"fa fa-arrow-right\" aria-hidden=\"true\"></i>\n            </a> */}\n            </div>\n          </a>\n        </div>\n      </div>\n    );\n  });\n\n  document.body.style.backgroundColor = \"white\";\n\n  return (\n    <div className=\"App\">\n      <HomeNavBar isPro={isPro} username={username} />\n      <div className=\"container\" style={{ paddingBottom: \"50px\" }}>\n        {welcome === \"\" && (\n          <h1 style={{ padding: \"30px\", textAlign: \"center\" }}>Welcome!</h1>\n        )}\n        {welcome !== \"\" && (\n          <div style={{ paddingTop: \"20px\", paddingBottom: \"10px\" }}>\n            <ReactMarkdown\n              rehypePlugins={[remarkGfm, rehypeHighlight, emoji, rehypeRaw]}\n            >\n              {welcome}\n            </ReactMarkdown>\n          </div>\n        )}\n\n        <div className=\"row\">\n          {loadingState === \"loading\" && (\n            <p>Loading notebooks. Please wait ...</p>\n          )}\n\n          {loadingState === \"loaded\" && isPro && notebooks.length === 0 && (\n            <div>\n              <div className=\"alert alert-success\" role=\"alert\">\n                <h5>\n                  <i className=\"fa fa-key\" aria-hidden=\"true\"></i> You are using\n                  Pro version\n                </h5>\n                <p>\n                  There are no public notebooks shared. Please login with your\n                  credentials to check private notebooks.\n                </p>\n\n                <a href=\"/login\" className=\"btn btn-primary btn-sm \">\n                  <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n                </a>\n              </div>\n            </div>\n          )}\n          {loadingState === \"loaded\" && notebooks.length === 0 && (\n            <div>\n              <p>\n                There are no notebooks available. Please add notebook to Mercury\n                server.\n              </p>\n\n              <p>\n                Command to watch notebook development in Mercury (with automatic\n                refresh):\n              </p>\n              <div className=\"alert alert-primary\" role=\"alert\">\n                <pre style={{ margin: \"0px\" }}>\n                  mercury watch {\"<path_to_notebook>\"}\n                </pre>\n              </div>\n\n              <p>Command to add notebook to your Mercury server:</p>\n              <div className=\"alert alert-primary\" role=\"alert\">\n                <pre style={{ margin: \"0px\" }}>\n                  mercury add {\"<path_to_notebook>\"}\n                </pre>\n              </div>\n            </div>\n          )}\n          {loadingState === \"error\" && (\n            <p>\n              Problem while loading notebooks. Please try again later or contact\n              Mercury administrator.\n            </p>\n          )}\n          {notebookItems}\n        </div>\n      </div>\n      <Footer />\n    </div>\n  );\n});\n","/* eslint-disable jsx-a11y/anchor-is-valid */\nimport React, { useState } from \"react\";\nimport { useDispatch, useSelector } from \"react-redux\";\nimport { withRouter } from \"react-router-dom\";\nimport { fetchToken } from \"../components/authSlice\";\nimport Footer from \"../components/Footer\";\nimport HomeNavBar from \"../components/HomeNavBar\";\nimport { getFetchingIsPro, getIsPro } from \"../components/versionSlice\";\nimport { useHistory } from \"react-router-dom\";\nimport ProFeatureAlert from \"../components/ProFeatureAlert\";\n\nexport default withRouter(function LoginView() {\n  let history = useHistory();\n  const dispatch = useDispatch();\n  const [username, setUsername] = useState(\"\");\n  const [password, setPassword] = useState(\"\");\n  const isPro = useSelector(getIsPro);\n  const fetchingIsPro = useSelector(getFetchingIsPro);\n\n  document.body.style.backgroundColor = \"#f5f5f5\";\n\n  return (\n    <div className=\"App\">\n      <HomeNavBar isPro={isPro} username={\"\"} />\n\n      {!isPro && !fetchingIsPro && (\n        <ProFeatureAlert featureName={\"authentication\"} />\n      )}\n      {isPro && (\n        <div className=\"div-signin text-center\">\n          <form\n            className=\"form-signin\"\n            onSubmit={(e) => {\n              e.preventDefault();\n              e.stopPropagation();\n              dispatch(fetchToken(username, password, history));\n            }}\n          >\n            <h3 className=\"h3 mb-3 font-weight-normal\">Please sign in</h3>\n            <label className=\"sr-only\">Username</label>\n            <input\n              type=\"username\"\n              id=\"inputUsername\"\n              className=\"form-control\"\n              placeholder=\"Username\"\n              value={username}\n              onChange={(e) => {\n                setUsername(e.target.value);\n              }}\n              required\n            />\n            <label className=\"sr-only\">Password</label>\n            <input\n              type=\"password\"\n              id=\"inputPassword\"\n              className=\"form-control\"\n              placeholder=\"Password\"\n              value={password}\n              onChange={(e) => {\n                setPassword(e.target.value);\n              }}\n              required\n            />\n            <button\n              className=\"btn btn-lg btn-primary btn-block\"\n              type=\"submit\"\n              style={{ margin: \"5px\" }}\n              disabled={username === \"\" || password === \"\"}\n            >\n              <i className=\"fa fa-sign-in\" aria-hidden=\"true\"></i> Log in\n            </button>\n          </form>\n          <div\n            className=\"mx-auto\"\n            style={{ width: \"400px\", marginTop: \"40px\" }}\n          >\n            <p className=\"text-muted\">\n              No account? Please contact the service administrator to create the\n              account for you.\n            </p>\n          </div>\n        </div>\n      )}\n      <Footer />\n    </div>\n  );\n});\n","/* eslint react/jsx-props-no-spreading: off */\nimport React, { ReactNode, useEffect } from \"react\";\nimport { useDispatch } from \"react-redux\";\nimport { Switch, Route } from \"react-router-dom\";\nimport { setToken, setUsername } from \"./components/authSlice\";\nimport { fetchVersion } from \"./components/versionSlice\";\nimport { getSessionId } from \"./utils\";\nimport { BrowserRouter as Router } from \"react-router-dom\";\nimport MainApp from \"./views/App\";\nimport AccountView from \"./views/AccountView\";\nimport HomeView from \"./views/HomeView\";\nimport LoginView from \"./views/LoginView\";\ntype Props = {\n  children: ReactNode;\n};\n\nfunction App(props: Props) {\n  const { children } = props;\n  return <>{children}</>;\n}\n\nexport default function Routes() {\n  const dispatch = useDispatch();\n\n  useEffect(() => {\n    getSessionId();\n    dispatch(fetchVersion());\n    if (localStorage.getItem(\"token\")) {\n      dispatch(setToken(localStorage.getItem(\"token\")));\n    }\n    if (localStorage.getItem(\"username\")) {\n      dispatch(setUsername(localStorage.getItem(\"username\")));\n    }\n\n    // eslint-disable-next-line react-hooks/exhaustive-deps\n  }, []);\n\n  return (\n    <Router>\n      <App>\n        <Switch>\n          <Route exact path=\"/\" component={HomeView} />\n          <Route\n            exact\n            path=\"/app/:notebook_id/:embed?\"\n            component={MainApp}\n          />\n          <Route exact path=\"/login\" component={LoginView} />\n          <Route exact path=\"/account\" component={AccountView} />\n        </Switch>\n      </App>\n    </Router>\n  );\n}\n","import React from \"react\";\nimport { Provider } from \"react-redux\";\nimport { History } from \"history\";\nimport { Store } from \"./store\";\nimport Routes from \"./Routes\";\n\ntype Props = {\n  store: Store;\n  history: History;\n};\nconst Root = ({ store, history }: Props) => (\n  <Provider store={store}>\n    <Routes />\n  </Provider>\n);\n\nexport default Root;\n","/* eslint-disable import/no-cycle */\nimport { configureStore, getDefaultMiddleware, Action } from '@reduxjs/toolkit';\nimport { createBrowserHistory } from 'history';\n\nimport { ThunkAction } from 'redux-thunk';\nimport createRootReducer from './rootReducer';\n\nexport const history = createBrowserHistory();\nconst rootReducer = createRootReducer(history);\nexport type RootState = ReturnType<typeof rootReducer>;\n\nconst middleware = [...getDefaultMiddleware()]; // , router];\n\nexport const configuredStore = (initialState?: RootState) => {\n  // Create Store\n  const store = configureStore({\n    reducer: rootReducer,\n    middleware,\n    preloadedState: initialState,\n  });\n  return store;\n};\nexport type Store = ReturnType<typeof configuredStore>;\nexport type AppThunk = ThunkAction<void, RootState, unknown, Action<string>>;\n","/* eslint-disable import/no-cycle */\nimport { combineReducers } from 'redux';\nimport { History } from 'history';\nimport notebooksReducer from './components/Notebooks/notebooksSlice';\nimport tasksReducer from './tasks/tasksSlice';\n//import widgetsReducer from './components/Widgets/widgetsSlice';\nimport versionReducer from './components/versionSlice';\nimport appReducer from './views/appSlice';\nimport authReducer from \"./components/authSlice\";\nimport wsReducer from \"./websocket/wsSlice\";\n\nexport default function createRootReducer(history: History) {\n    return combineReducers({\n        notebooks: notebooksReducer,\n        tasks: tasksReducer,\n        // widgets: widgetsReducer,\n        version: versionReducer,\n        app: appReducer,\n        auth: authReducer,\n        ws: wsReducer,\n    });\n}\n","import React from \"react\";\nimport { render } from \"react-dom\";\nimport axios from \"axios\";\nimport Root from \"./Root\";\nimport { history, configuredStore } from \"./store\";\n\nimport { ToastContainer } from \"react-toastify\";\nimport \"react-toastify/dist/ReactToastify.css\";\nimport \"bootstrap/dist/js/bootstrap.min.js\";\nimport \"bootstrap/dist/css/bootstrap.css\";\nimport \"font-awesome/css/font-awesome.min.css\";\nimport \"react-block-ui/style.css\";\nimport \"filepond/dist/filepond.min.css\";\nimport \"filepond-plugin-image-preview/dist/filepond-plugin-image-preview.css\";\nimport \"./index.css\";\n\nconst store = configuredStore();\n\nif (window.location.origin === \"http://localhost:3000\") {\n  axios.defaults.baseURL = \"http://127.0.0.1:8000\";\n} else {\n  axios.defaults.baseURL = window.location.origin;\n}\nif (window.location.origin.startsWith(\"https://hf.space\")) {\n  axios.defaults.baseURL = window.location.href;\n}\n\n// in the case of some special params in the url\naxios.defaults.baseURL = axios.defaults.baseURL.split(\"+\")[0];\naxios.defaults.baseURL = axios.defaults.baseURL.split(\"?\")[0];\naxios.defaults.baseURL = axios.defaults.baseURL.split(\"#\")[0];\n\n\ndocument.addEventListener(\"DOMContentLoaded\", () =>\n  render(\n    <div>\n      <Root store={store} history={history} />\n      <ToastContainer\n        position=\"top-right\"\n        autoClose={3000}\n        hideProgressBar={true}\n        newestOnTop={true}\n        closeOnClick\n        pauseOnHover\n      />\n    </div>,\n    document.getElementById(\"root\")\n  )\n);\n"],"sourceRoot":""}